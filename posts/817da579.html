<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>学习笔记｜MySQL | RyanChouBlog</title>
<noscript>开启Javascript是必要的</noscript>
<link rel="icon" type="image/x-icon" href="/img/avatar.webp">
<link rel="apple-touch-icon" href="/img/avatar.webp">
<meta name="apple-mobile-web-app-title" content="RyanChouBlog">
<link rel="bookmark" href="/img/avatar.webp">
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/img/avatar.webp">
<meta name="description" content="一个记录学习与生活的博客">
<meta name="theme-color" content="#1C1C1F">
<link rel="stylesheet" href="/css/var.css">
<link rel="stylesheet" href="/css/main.css">
<link rel="stylesheet" href="/css/custom.css">



<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.3.0/css/all.min.css">
    

<link rel="stylesheet" href="/lib/snackbar.min.css">


<script src="/lib/qrcode.min.js"></script>





<script>var GLOBALCONFIG = {"root":"/","runtime":"2023-03-01 00:00:00","lazyload":{"enable":false,"error":"/img/acrylic.png"},"hightlight":{"enable":false,"limit":200},"lightbox":true,"randomlinks":false,"lang":{"theme":{"dark":"已切换至深色模式","light":"已切换至浅色模式"},"copy":{"success":"复制成功","error":"复制失败"},"backtop":"返回顶部","time":{"recent":"最近","yesterday":"昨天","berforeyesterday":"前天","daybefore":"天前","runtime":"天"},"sayhello":{"morning":"早上好","noon":"中午好","afternoon":"下午好","night":"晚上好","goodnight":"晚安","iam":"!  我是"},"search":{"empty":"搜索结果为空","hit":"已为您找到 ${query} 条结果","placeholder":"输入关键词快速查找"}},"covercolor":false,"comment":{"enable":false,"twikooUrl":null}};</script><script id="site-config">var PAGECONFIG = {"is_home":false,"is_post":true,"is_page":false,"page":false,"toc":true,"comment":false};</script>
    <meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="RyanChouBlog" type="application/atom+xml">
</head>
    <body id="body">
        
        <div id="console" style="zoom: 1;" class="">
    <div class="close-btn" onclick="acrylic.hideConsole()" href="javascript:void(0);">
        <i class="fas fa-circle-xmark"></i>
    </div>
    
        <div class="console-card-group">
            <div class="console-card-group-left">
                <div class="console-card" id="card-newest-comments" onclick="acrylic.hideConsole()">
                    <div class="card-content">
                        <div class="author-content-item-tips">互动</div>
                        <div class="author-content-item-title">最新评论</div>
                    </div>
                    <div class="aside-list"></div>
                </div>
    
            </div>
            <div class="console-card-group-right">
                <div class="console-card tags" onclick="acrylic.hideConsole()">
                    <div class="card-content">
                        <div class="author-content-item-tips">标签</div>
                        <div class="author-content-item-title">寻找感兴趣的领域</div>
                    </div>
                    <div class="card-tag-cloud">
                        
                            <a href="/tags/Docker/" style="font-size: 0.8rem; color: #d3d3d3">Docker<sup>1</sup></a>
                        
                            <a href="/tags/Git/" style="font-size: 0.8rem; color: #d3d3d3">Git<sup>1</sup></a>
                        
                            <a href="/tags/Gin/" style="font-size: 0.8rem; color: #d3d3d3">Gin<sup>1</sup></a>
                        
                            <a href="/tags/Golang/" style="font-size: 0.8rem; color: #d3d3d3">Golang<sup>3</sup></a>
                        
                            <a href="/tags/Linux/" style="font-size: 0.8rem; color: #d3d3d3">Linux<sup>1</sup></a>
                        
                            <a href="/tags/Gorm/" style="font-size: 0.8rem; color: #d3d3d3">Gorm<sup>1</sup></a>
                        
                            <a href="/tags/MySQL/" style="font-size: 0.8rem; color: #d3d3d3">MySQL<sup>1</sup></a>
                        
                    </div>
                </div>
                <div class="console-card history" onclick="acrylic.hideConsole()">
                    <ul class="card-archive-list">
    
     
        <li class="card-archive-list-item"><a class="card-archive-list-link" onclick="pjax.loadUrl('/archives/2023-06/')" data-pjax-state=""><span
            class="card-archive-list-date">2023-06</span>
            <div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span
                    class="card-archive-list-count-unit">篇</span></div>
            </a>
        </li>
     
        <li class="card-archive-list-item"><a class="card-archive-list-link" onclick="pjax.loadUrl('/archives/2023-05/')" data-pjax-state=""><span
            class="card-archive-list-date">2023-05</span>
            <div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span
                    class="card-archive-list-count-unit">篇</span></div>
            </a>
        </li>
        
</ul>

                </div>
            </div>
        </div>
    
    
    <div class="button-group">
        <div class="console-btn-item"> <a class="darkmode_switchbutton" onclick="acrylic.switchDarkMode()" title="显示模式切换"
                href="javascript:void(0);" rel="external nofollow" data-pjax-state=""><i class="fas fa-moon"
                    style="font-size: 1rem;"></i></a></div>
        
    </div>
    <div class="console-mask" onclick="acrylic.hideConsole()" href="javascript:void(0);" rel="external nofollow"></div>
</div>
        <div id="sidebar" style="zoom: 1;">
    <div id="menu-mask" style="display: none;"></div>
    <div id="sidebar-menus" class>
        <span class="sidebar-menu-item-title">功能</span>
        <div class="sidebar-menu-item">
            <a class="darkmode_switchbutton menu-child" onclick="acrylic.switchDarkMode()" title="显示模式切换"
                href="javascript:void(0);" rel="external nofollow">
                <i class="fas fa-moon" style="font-size: 1rem;"></i>
                <span>显示模式</span>
            </a>
        </div>
        
            <div class="back-menu-list-groups">
    
  </div>
  
        
        <div class="menus_items">
    
        <div class="menus_item">
            
                <a class="site-page" href="javascript:void(0);" rel="external nofollow">
                    <span> 文库</span>
                </a>
                <ul class="menus_item_child">
                    
                        <li>
                            <a class="site-page child" href="/archives/">
                                <i class="fas fa-box-archive"></i>
                                <span> 文章列表</span>
                            </a>
                        </li>
                    
                        <li>
                            <a class="site-page child" href="/categories/">
                                <i class="fas fa-cube"></i>
                                <span> 全部分类</span>
                            </a>
                        </li>
                    
                        <li>
                            <a class="site-page child" href="/tags/">
                                <i class="fas fa-tags"></i>
                                <span> 全部标签</span>
                            </a>
                        </li>
                    
                </ul>
             
        </div>
    
</div>
        <span class="sidebar-menu-item-title">标签</span>
        <div class="card-widget card-tags card-archives card-webinfo card-allinfo">
            <div class="item-headline">
                <i class="fas fa-tags"></i>
                <span>标签</span>
            </div>
            <div class="card-tag-cloud">
                
                    <a href="/tags/Docker/" style="font-size: 1em; color: #d3d3d3">Docker
                        <sup>1</sup>
                    </a>
                
                    <a href="/tags/Git/" style="font-size: 1em; color: #d3d3d3">Git
                        <sup>1</sup>
                    </a>
                
                    <a href="/tags/Gin/" style="font-size: 1em; color: #d3d3d3">Gin
                        <sup>1</sup>
                    </a>
                
                    <a href="/tags/Golang/" style="font-size: 1em; color: #d3d3d3">Golang
                        <sup>3</sup>
                    </a>
                
                    <a href="/tags/Linux/" style="font-size: 1em; color: #d3d3d3">Linux
                        <sup>1</sup>
                    </a>
                
                    <a href="/tags/Gorm/" style="font-size: 1em; color: #d3d3d3">Gorm
                        <sup>1</sup>
                    </a>
                
                    <a href="/tags/MySQL/" style="font-size: 1em; color: #d3d3d3">MySQL
                        <sup>1</sup>
                    </a>
                
            </div>
        </div>
    </div>
</div>    
        
            <div class="post" id="body-wrap">
                <header class="post-bg" id="page-header">
    <nav id="nav" class="show">
    <div id="nav-group">
        <div id="blog_name">
            
                <div class="back-home-button" tabindex="-1">
                    <i class="back-home-button-icon fas fa-grip-vertical"></i>
                    <div class="back-menu-list-groups">
    
  </div>
  
                </div>
            
            <a id="site-name" href="/" title="返回博客主页">
                    
                        <span class="heoicon">Ryan</span>
                    
            </a>
        </div>
        <div id="page-name-mask">
            <div id="page-name">
                <a id="page-name-text" onclick="acrylic.toTop()">学习笔记｜MySQL</a>
            </div>
        </div>
        <div id="menus">
            <div class="menus_items">
    
        <div class="menus_item">
            
                <a class="site-page" href="javascript:void(0);" rel="external nofollow">
                    <span> 文库</span>
                </a>
                <ul class="menus_item_child">
                    
                        <li>
                            <a class="site-page child" href="/archives/">
                                <i class="fas fa-box-archive"></i>
                                <span> 文章列表</span>
                            </a>
                        </li>
                    
                        <li>
                            <a class="site-page child" href="/categories/">
                                <i class="fas fa-cube"></i>
                                <span> 全部分类</span>
                            </a>
                        </li>
                    
                        <li>
                            <a class="site-page child" href="/tags/">
                                <i class="fas fa-tags"></i>
                                <span> 全部标签</span>
                            </a>
                        </li>
                    
                </ul>
             
        </div>
    
</div>
        </div>
        <!-- <div id="nav-left">
            <div id="fps-group">
                <div id="fps">145</div><span class="fpsText">FPS</span>
            </div>
        </div> -->
        <div id="nav-right">
            
    <div class="nav-button only-home" id="travellings_button">
        <a class="site-page"  target="_blank" rel="noopener external nofollow" href="https://www.travellings.cn/go.html" title="开往-友链接力"  width="120">
            <i class="fa-solid fa-train-subway" style="font-size: 1rem;"></i>
        </a>
    </div>


    <div class="nav-button" id="randomPost_button">
        <a class="site-page" onclick="toRandomPost()"
            title="随机前往一个文章">
            <i class="fas fa-shuffle" style="font-size: 1rem;"></i>
        </a>
    </div>



    <div class="nav-button" id="nav-console">
        <a class="console_switchbutton" onclick="acrylic.showConsole()"
        title="显示中控台" href="javascript:void(0);" rel="external nofollow">
        <i class="fas fa-bars-progress" style="font-size: 1rem;"></i>
        </a>
    </div>

<div class="nav-button" id="nav-totop" onclick="acrylic.toTop()">
    <a class="totopbtn">
        <i class="fas fa-arrow-up"></i>
        <span id="percent">0</span>
    </a>
</div>
<div id="toggle-menu">
    <a class="site-page">
        <i class="fas fa-bars fa-fw" style="font-size: 1rem;"></i>
    </a>
</div>
        </div>
    </div>
</nav>
    
        <div class="coverdiv" id="coverdiv">
    <img id="post-cover" class="nolazyload" src="/img/hello.jpg" alt="cover">
</div>
<div id="post-info">
    <div id="post-firstinfo">
        <div class="meta-firstline">
            <a class="post-meta-original" title="该文章为文章，注意版权协议">
                
            </a>
            
            <div class="tag_share">
                <div class="post-meta__tag-list">
                    
                        <a class="post-meta__tags" href="/tags/MySQL/">
                            <span class="tags-punctuation">#</span>
                            <span class="tags-name">MySQL</span>
                        </a>
                    
                </div>
            </div>
        </div>
    </div>
    <h1 class="post-title">学习笔记｜MySQL</h1>
    <div id="post-meta">
        <div class="meta-secondline">
            <span class="post-meta-date" title="发布于">
                <i class="post-meta-icon fa-fw fas fa-calendar"></i>
                <time datetime="2023-06-12T10:23:19+08:00"></time>
            </span>
            
            
                <span class="post-meta-position" title="作者IP归属地为江苏">
                    <i class="fas fa-location-dot post-meta-icon"></i>
                    <span>江苏</span>
                </span>
            
            
            
                
        </div>
    </div>
</div>
<section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg"
    xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
    <defs>
        <path id="gentle-wave"
            d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path>
    </defs>
    <g class="parallax">
        <use href="#gentle-wave" x="48" y="0"></use>
        <use href="#gentle-wave" x="48" y="3"></use>
        <use href="#gentle-wave" x="48" y="5"></use>
        <use href="#gentle-wave" x="48" y="7"></use>
    </g>
</svg>
</section>

        
</header>
                <main class="layout" id="content-inner">
    <div id="post">
        <article class="post-content" id="article-container">
            <h1 id="数据库简介"><a href="#数据库简介" class="headerlink" title="数据库简介"></a>数据库简介</h1><h2 id="数据库管理系统"><a href="#数据库管理系统" class="headerlink" title="数据库管理系统"></a>数据库管理系统</h2><p>数据库管理系统（DBMS）是一种用于管理数据库的软件系统，它提供了创建、读取、更新和删除（CRUD）数据库中数据的方法。DBMS的主要任务是对数据进行有效和安全的管理。</p>
<p>DBMS允许用户定义和创建数据库，定义表和它们的关系，定义表中数据的约束和规则，以及查询和更新数据等。它还提供了一种访问控制机制，以确保只有授权用户才能访问数据库。DBMS还提供了各种性能优化机制，如索引、缓存、查询优化等，以提高数据库的性能。</p>
<p>常见的DBMS包括Oracle、MySQL、Microsoft SQL<br>Server、PostgreSQL、MongoDB等。每个DBMS都有自己的特点和优缺点，用户可以根据实际需求选择适合自己的DBMS。</p>
<h2 id="什么是SQL"><a href="#什么是SQL" class="headerlink" title="什么是SQL"></a>什么是SQL</h2><p>SQL是Structured Query<br>Language（结构化查询语言）的缩写，是一种用于操作关系型数据库的标准化语言。SQL是一种声明式语言，它的主要任务是定义和操作数据库中的数据。</p>
<p>SQL被广泛应用于访问和操作关系型数据库中的数据。通过SQL，用户可以进行各种操作，例如查询数据、插入、更新和删除数据，定义和修改数据库表结构和约束，以及授权和管理用户等。</p>
<p>SQL标准分为几个不同的部分，包括数据定义语言（DDL）、数据操作语言（DML）、数据控制语言（DCL）和数据查询语言（DQL）等。其中，DDL用于创建、修改和删除数据库对象，例如表、视图、索引等；DML用于插入、更新和删除数据；DCL用于授权和管理用户访问数据库的权限；DQL用于查询数据。</p>
<p>不同的关系型数据库管理系统（RDBMS）实现SQL标准的程度不同，有些数据库可能会支持特定的扩展和功能。但是，大多数RDBMS都支持SQL标准，使得用户可以使用相同的语言来操作不同的数据库。</p>
<h2 id="数据库模型"><a href="#数据库模型" class="headerlink" title="数据库模型"></a>数据库模型</h2><p>数据库模型是描述数据之间关系的概念性框架。主要有以下几种：</p>
<ol>
<li>层次模型：数据按照树形结构进行组织，即每个数据记录只有一个父节点，但可以有多个子节点。层次模型的优点是检索速度快，缺点是不灵活。</li>
<li>网状模型：数据以网络结构组织，每个数据记录可以有多个父节点和子节点，它的优点是能够表达复杂的数据关系，但缺点是不易维护。</li>
<li>关系模型：数据按照表格形式组织，每个数据记录是一行，每个数据属性是一列。表格之间通过键值关联。关系模型是目前应用最广泛的数据库模型，因为它的简单性、灵活性和易用性。</li>
<li>面向对象模型：数据被组织为对象，每个对象有其属性和方法。面向对象模型的优点是能够表达现实世界中的对象，缺点是查询语言相对复杂。</li>
<li>XML模型：数据被组织为XML（可扩展标记语言）文档，它的优点是具有很好的可读性和可扩展性，缺点是性能较低。</li>
<li>NoSQL模型：NoSQL是一类非关系型数据库模型，它们采用不同于传统关系型数据库的数据存储和查询方式。NoSQL模型通常用于大数据和分布式系统中，它们的优点是处理海量数据和高并发访问的能力强，缺点是数据一致性较差。</li>
</ol>
<p>MySQL属于关系型数据库管理系统（RDBMS），采用的是关系模型。关系模型是目前应用最广泛的数据库模型，数据按照表格形式组织，每个数据记录是一行，每个数据属性是一列。表格之间通过键值关联。MySQL是一种开源的RDBMS，它是由瑞典MySQL<br>AB公司开发，现在由Oracle公司维护和支持。MySQL支持SQL标准，因此能够与大多数SQL兼容的应用程序集成，是一个非常流行的数据库系统。</p>
<h2 id="如何设计一个数据库"><a href="#如何设计一个数据库" class="headerlink" title="如何设计一个数据库"></a>如何设计一个数据库</h2><p>设计一个数据库需要考虑多个方面，包括以下几个步骤：</p>
<ol>
<li>确定数据库需求：首先要明确数据库要解决的问题，确定需要存储的数据类型和数据量，以及数据库应用程序的功能和性能需求。</li>
<li>设计数据库结构：设计数据库的结构包括确定需要存储的数据实体、数据属性、关系以及数据约束等。这一步需要使用数据库建模工具进行数据建模，例如使用E-R图或UML建模工具，将实体、属性、关系和约束等以图形化的方式表示出来。</li>
<li>选择合适的数据库管理系统：根据应用程序的需求，选择合适的数据库管理系统，例如关系型数据库（如MySQL、Oracle、SQL<br>Server等）、面向对象数据库（如MongoDB、CouchDB等）或键值数据库（如Redis、Memcached等）等。</li>
<li>创建数据库表和字段：根据设计好的数据库结构，创建数据库表和字段。这一步需要确定表名、字段名、数据类型、长度、默认值、约束和索引等。</li>
<li>设计数据库安全和备份策略：设计数据库安全和备份策略包括设计用户和角色、定义权限、实施数据备份和恢复策略等。这一步需要考虑数据保护、数据完整性、数据安全等方面。</li>
<li>编写应用程序：设计好数据库结构之后，需要编写应用程序来与数据库进行交互。在应用程序中，需要实现对数据库的查询、插入、更新、删除等操作，并处理异常情况。</li>
<li>测试和维护：设计好数据库之后，需要对数据库进行测试，包括测试数据的完整性、性能和安全性等。同时还需要进行定期的数据库维护工作，包括备份、优化、数据清理等。</li>
</ol>
<h2 id="数据库性能优化"><a href="#数据库性能优化" class="headerlink" title="数据库性能优化"></a>数据库性能优化</h2><p>数据库性能优化是指通过调整数据库的结构和参数配置，提高数据库的响应速度、吞吐量和并发能力，以满足应用程序的需求。以下是一些常用的数据库性能优化方法：</p>
<ol>
<li>索引优化：索引是提高数据库查询性能的关键，通过对频繁查询的字段创建索引，可以大大缩短查询时间。需要注意的是，过多或者不必要的索引会降低插入、更新、删除等操作的性能，需要权衡优化。</li>
<li>优化查询语句：对于复杂的查询语句，可以考虑分解为多个简单的查询，减少查询时间。同时需要避免在WHERE子句中使用函数或者运算符等操作，会导致索引失效。</li>
<li>数据库参数调优：针对不同的数据库系统，有不同的参数可以调整以优化性能，例如MySQL的缓存、并发和连接池等参数。</li>
<li>表结构优化：优化表的结构，避免使用过多的大字段，不必要的冗余字段，以及过多的关联查询等操作。</li>
<li>分区和分库：对于数据量较大的数据库，可以考虑将数据按照一定规则分成多个分区或者分库，减轻单个节点的负载压力。</li>
<li>缓存优化：使用缓存可以大大减少数据库的访问，提高响应速度和吞吐量。常用的缓存方案包括内存缓存、分布式缓存和CDN等。</li>
<li>定期维护：定期对数据库进行维护，包括备份、优化、数据清理等操作，可以减少数据库的负担，提高性能和可靠性。</li>
</ol>
<p>总之，数据库性能优化需要结合具体的应用场景和数据特点，综合考虑多种优化方案，以达到最优的性能和稳定性。</p>
<h2 id="数据库的备份和恢复"><a href="#数据库的备份和恢复" class="headerlink" title="数据库的备份和恢复"></a>数据库的备份和恢复</h2><p>数据库备份与恢复是数据库管理中非常重要的一环，可以保障数据的安全和完整性。以下是一些常用的数据库备份与恢复方法：</p>
<ol>
<li>完全备份：完全备份是指将整个数据库备份下来，包括数据和日志等信息。完全备份是最基本的备份方式，可以保证数据的完整性，但备份文件通常比较大，且恢复时间比较长。</li>
<li>增量备份：增量备份是指只备份自上次备份以来的更改部分。增量备份可以减少备份文件的大小和备份时间，但恢复过程比较复杂，需要先进行完全备份，然后逐个应用增量备份。</li>
<li>差异备份：差异备份是指备份自上次完全备份以来的所有更改部分，与增量备份相比，差异备份的备份文件比较小，但恢复时间仍然较长。</li>
<li>定期备份：定期备份是指根据业务需求，定期进行数据库备份。备份频率根据数据的变化情况和恢复时间的要求等因素来确定，例如每天、每周或者每月备份等。</li>
<li>恢复操作：恢复操作是指在出现数据库故障时，将备份的数据恢复到数据库中。恢复过程中需要先选择合适的备份文件，然后根据备份类型和恢复策略等因素来选择恢复方式，例如通过备份文件直接恢复，或者通过增量备份和差异备份逐个应用。</li>
</ol>
<p>总之，数据库备份与恢复是数据库管理中非常重要的一环，可以保障数据的安全和完整性。备份需要根据具体业务需求来制定备份策略，同时需要定期进行备份测试，确保备份数据的可靠性和完整性。在出现故障时，需要及时选择合适的恢复方式，以保障业务的连续性和可靠性。</p>
<h1 id="数据库的基本概念"><a href="#数据库的基本概念" class="headerlink" title="数据库的基本概念"></a>数据库的基本概念</h1><h2 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h2><p>数据库是一种用于存储、组织和管理数据的电子系统，可以让用户方便地存储和检索数据。数据库通常由一个或多个数据表组成，每个表都有一些列，每列代表了一个特定的数据类型。在表中，每一行都代表了一条记录，其中每个列都包含了相应的数据值。</p>
<p>数据库可用于各种类型的应用程序，包括商业、科学、医疗、社交媒体等等。它们提供了一种安全、可靠的数据存储方式，可以让多个用户同时访问和处理同一个数据集。用户可以在数据库中进行各种操作，例如添加、修改、删除和查询数据。</p>
<p>现代数据库通常采用关系型数据库管理系统（RDBMS），这种系统使用SQL（Structured<br>Query<br>Language）作为管理和查询数据的标准语言。此外，还有一些非关系型数据库，例如NoSQL数据库，它们不使用SQL语言，但通常具有更好的扩展性和性能。</p>
<h2 id="数据库表"><a href="#数据库表" class="headerlink" title="数据库表"></a>数据库表</h2><p>在关系型数据库中，数据通常被组织成表的形式，表由行和列组成，类似于电子表格。每个表都有一个唯一的名称，每个列都有一个名称和一个数据类型，每行包含一组相关的数据。</p>
<p>表是数据库中最基本的组成部分之一，它可以存储一定类型的数据，并提供对这些数据的快速访问和操作。每个表都具有一个结构，包括表的名称、列的名称、数据类型以及约束条件等。</p>
<p>在表中，每行都代表一个记录或实例，每个记录由一个或多个列组成，它们包含了相关的数据。例如，在一个名为”用户”的表中，每一行可能代表一个用户，每个列可能包含一个用户的姓名、电子邮件地址、电话号码和地址等信息。</p>
<p>表中的列通常具有一定的数据类型，例如整数、浮点数、日期、文本等等。列还可以包含约束条件，例如唯一性约束、主键约束、外键约束等，这些约束条件用于确保数据的完整性和一致性。</p>
<p>表的设计和管理是数据库设计和管理的重要组成部分，包括创建、删除、修改和查询表中的数据等。</p>
<h2 id="数据库记录（行）"><a href="#数据库记录（行）" class="headerlink" title="数据库记录（行）"></a>数据库记录（行）</h2><p>在关系型数据库中，表是由行和列组成的数据结构，每一行表示一条记录或实例，其中每一列包含一个数据元素。每个记录都包含了一组相关的数据，表示某个实体或概念的特定属性。</p>
<p>例如，在一个名为”学生”的表中，每一行可能代表一个学生，每个列可能包含学生的姓名、学号、出生日期、性别、专业等信息。每个记录中的数据是根据列的数据类型来组织的，以确保数据的一致性和可比性。</p>
<p>在表中，每个记录都必须包含一个唯一的标识符，通常称为主键。主键可以是一列或多列的组合，用于标识记录并确保记录的唯一性。</p>
<p>记录的创建、修改和删除是数据库管理的基本操作之一。用户可以通过SQL语句或图形用户界面来实现这些操作。在记录的创建和修改过程中，用户需要确保输入的数据符合列的数据类型、长度和约束条件，以确保数据的完整性和一致性。</p>
<p>在数据库查询中，记录也起着重要的作用，用户可以使用SQL查询语句来检索特定条件下的记录，并对记录进行排序、分组、过滤等操作。查询的结果通常是一个记录集，其中每个记录代表了满足查询条件的一条记录。</p>
<h2 id="数据库列"><a href="#数据库列" class="headerlink" title="数据库列"></a>数据库列</h2><p>在关系型数据库中，表是由行和列组成的数据结构，每个列都代表了表中某一类数据的属性。每个列都有一个名称和一个数据类型，以及一些其他的属性，如默认值、约束条件等。</p>
<p>列是表中最基本的组成部分之一，它们描述了表中的数据结构和属性。在表中，每一列代表一种数据类型，例如整数、浮点数、日期、字符串等等。在列中，每个数据元素都具有相同的数据类型，这有助于确保数据的一致性和可比性。</p>
<p>列还可以包含一些约束条件，例如唯一性约束、主键约束、外键约束等，这些约束条件用于限制数据的输入，以确保数据的完整性和一致性。例如，在一个”用户”表中，用户ID可能是一个整数类型的主键列，用于唯一标识每个用户记录。</p>
<p>在数据库设计和管理中，列的设计是非常重要的，需要考虑到数据类型的选择、数据长度、约束条件以及索引等因素，以确保表的性能和数据质量。</p>
<h2 id="数据库主键"><a href="#数据库主键" class="headerlink" title="数据库主键"></a>数据库主键</h2><p>在关系型数据库中，主键是用于唯一标识表中每个记录的一列或一组列。每个表只能有一个主键，并且主键列的值必须是唯一的、不为空的，并且不能被修改或删除。主键的作用是保证数据的一致性、完整性和可靠性，同时也是表之间建立关系的重要基础。</p>
<p>在实际应用中，主键通常是一个自增长的整数列，用于自动生成唯一的标识符。例如，在一个”学生”表中，可以将学生的ID设置为主键，并使用自增长功能来自动生成每个学生的唯一ID。主键还可以是一个复合键，由多个列的组合构成，用于标识复合唯一性。例如，在一个”订单”表中，可以使用订单编号和订单日期作为复合主键，以确保每个订单的唯一性。</p>
<p>主键的选择和设计对于数据库的性能和数据质量非常重要。主键的类型、长度和约束条件需要根据具体的数据结构和需求进行选择，以确保主键的稳定性和可靠性。在创建和修改表的结构时，必须明确指定主键列，并确保主键的唯一性和完整性。</p>
<h2 id="数据库外键"><a href="#数据库外键" class="headerlink" title="数据库外键"></a>数据库外键</h2><p>在关系型数据库中，外键是用于建立表之间关系的一种机制，它定义了一个表中的列与另一个表中的主键或唯一键之间的关联。通过外键，可以实现表之间的数据完整性和一致性，确保关联的数据在不同表之间的正确性和有效性。</p>
<p>外键通常由两个部分组成：一个是定义在当前表中的列，称为”外键列”或”关联列”，另一个是定义在引用表中的列，称为”主键列”或”引用列”。在建立外键关系时，需要确保外键列的数据类型、长度和约束条件与主键列的定义相匹配，以确保数据的正确性和一致性。</p>
<p>外键关系可以在表的创建时或之后建立，可以使用SQL语句或图形用户界面来实现。在建立外键关系时，需要指定引用表的名称和主键列的名称，以确保外键列与主键列之间的正确关联。如果外键列中的数据与引用表中的主键列中的数据不匹配，或者引用表中的主键列中的数据发生更改或删除，那么相应的外键列中的数据也将被更新或删除。</p>
<p>外键的作用是确保数据的一致性和完整性，可以有效避免数据冗余和重复，并提高数据的查询效率和可维护性。在数据库设计和开发中，外键的选择和建立应该根据具体需求和数据模型进行，并考虑到数据库的性能和安全性。</p>
<h2 id="数据库索引"><a href="#数据库索引" class="headerlink" title="数据库索引"></a>数据库索引</h2><p>在关系型数据库中，索引是一种数据结构，用于加速数据的检索和查询操作。它是一个数据库对象，存储在磁盘上，包含了数据表中一个或多个列的排序信息。通过对索引列进行排序，可以快速定位表中符合条件的记录，从而提高查询效率和性能。</p>
<p>索引通常由一个或多个列组成，可以是唯一索引、非唯一索引、聚集索引或非聚集索引等类型。唯一索引要求索引列的值必须是唯一的，非唯一索引则允许索引列中包含重复的值。聚集索引和非聚集索引的区别在于索引存储的位置和方式不同，前者将数据和索引存储在一起，后者则将数据和索引分开存储。</p>
<p>索引的作用是提高查询效率和性能，减少数据的扫描和过滤操作，从而加快查询的速度。通过合理选择和设计索引，可以有效优化数据库的性能和响应时间。但是，过多的索引也会增加数据库的存储空间和维护成本，因此需要根据具体的业务需求和数据模型进行选择和设计。</p>
<p>在数据库中，可以使用SQL语句或图形界面来创建、修改和删除索引。为了保证索引的效果和稳定性，需要考虑索引列的选择、排序、长度和约束条件等因素，避免索引冗余和重复。同时，需要定期维护和优化索引，以确保索引的有效性和性能。</p>
<h2 id="数据库视图"><a href="#数据库视图" class="headerlink" title="数据库视图"></a>数据库视图</h2><p>在关系型数据库中，视图（View）是一种虚拟的表，它是基于一个或多个基本表的查询结果，以一定的方式呈现出来的结果集。与实际的基本表不同，视图并不实际存储数据，而是从一个或多个表中检索数据的逻辑结果集。</p>
<p>视图的作用是提供一种简化和抽象的数据视图，使用户能够更轻松地查询和操作数据。通过使用视图，可以隐藏实际数据表的结构和细节，简化查询操作，减少数据冗余和重复。同时，视图还可以增强数据的安全性和保密性，通过授权和权限设置，限制用户对数据的访问和操作。</p>
<p>在数据库中，可以使用SQL语句或图形界面来创建、修改和删除视图。为了确保视图的有效性和正确性，需要根据具体的业务需求和数据模型进行选择和设计。视图的设计应该考虑到数据的一致性、完整性和性能等因素，避免视图的冗余和复杂性。同时，需要定期维护和更新视图，以确保视图的有效性和性能。</p>
<h1 id="MySQL简介"><a href="#MySQL简介" class="headerlink" title="MySQL简介"></a>MySQL简介</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>MySQL是一种开源的关系型数据库管理系统（RDBMS），由瑞典MySQL<br>AB公司开发，目前由Oracle公司进行开发和维护。MySQL使用标准的SQL数据语言进行数据的管理和操作，支持多种操作系统平台，包括Linux、Windows和Mac<br>OS等。</p>
<p>MySQL的特点包括：</p>
<ol>
<li>开源、免费：MySQL是一个完全开源的软件，可以免费下载和使用。</li>
<li>稳定、可靠：MySQL是一种经过广泛测试和验证的数据库管理系统，具有良好的稳定性和可靠性。</li>
<li>高性能：MySQL使用多种技术和优化策略，可以提供高效的数据存储和检索功能。</li>
<li>可扩展性：MySQL支持分布式和集群部署，可以根据业务需求进行水平或垂直扩展。</li>
<li>兼容性：MySQL支持多种操作系统和编程语言，可以与其他应用程序无缝集成。</li>
<li>安全性：MySQL支持多种安全功能和加密算法，可以保护数据的安全性和完整性。</li>
</ol>
<p>MySQL广泛应用于Web应用程序、企业应用、嵌入式系统和云计算等领域。目前，MySQL已成为全球使用最广泛的关系型数据库之一，拥有庞大的社区和生态系统，提供丰富的插件和扩展功能，能够满足各种不同的数据管理和处理需求。</p>
<h2 id="MySQL的历史"><a href="#MySQL的历史" class="headerlink" title="MySQL的历史"></a>MySQL的历史</h2><p>MySQL的历史可以追溯到1994年，当时瑞典的Michael Widenius和David<br>Axmark开发了一个名为MySQL的轻量级关系型数据库管理系统，它基于C语言开发，采用了BSD许可证，可以免费使用和修改。</p>
<p>1995年，Michael Widenius和David Axmark与Allan Larsson共同成立了MySQL<br>AB公司，开始商业化推广MySQL，并提供了商业版本的服务和支持。</p>
<p>在接下来的几年中，MySQL逐渐成为最流行的开源数据库之一，受到了广泛的关注和应用。2000年，MySQL<br>AB发布了第一个完整的MySQL版本，增加了许多新的特性和功能，包括事务处理、多版本并发控制、存储过程、触发器等。</p>
<p>2008年，MySQL AB被Sun<br>Microsystems收购，成为Sun的子公司。在Sun的支持下，MySQL继续发展和壮大，增加了更多的特性和功能，并逐渐成为企业级应用程序的标准数据库。</p>
<p>2010年，Sun Microsystems被Oracle<br>Corporation收购，MySQL成为Oracle的一部分。在Oracle的领导下，MySQL继续推出了新的版本，增加了更多的功能和改进，包括InnoDB存储引擎的改进、分区表、复制、性能优化等。</p>
<p>目前，MySQL已成为全球使用最广泛的关系型数据库之一，拥有庞大的用户群体和生态系统，包括各种工具、插件和扩展功能，能够满足各种不同的数据管理和处理需求。</p>
<h2 id="MariaDB"><a href="#MariaDB" class="headerlink" title="MariaDB"></a>MariaDB</h2><p>MariaDB是一个由MySQL的创始人Michael<br>Widenius领导的团队开发的开源关系型数据库管理系统。MariaDB最初于2009年发布，旨在创建一个完全兼容MySQL的数据库系统，同时提供更好的性能、更多的功能和更好的稳定性。</p>
<p>MariaDB基于MySQL的代码库，并且完全兼容MySQL，因此可以轻松地将MySQL应用程序迁移到MariaDB。不过，MariaDB也提供了许多MySQL不具备的功能，例如更好的性能优化、更好的事务支持、更好的安全性、更好的扩展性、更好的存储引擎支持等。</p>
<p>MariaDB是开源软件，可以免费下载和使用。它也有商业版本，提供额外的功能和支持。MariaDB在开源社区和企业中都很受欢迎，许多知名的公司和组织使用MariaDB作为其关键业务系统的数据库。</p>
<h2 id="什么是数据库引擎-mysql引擎有哪些"><a href="#什么是数据库引擎-mysql引擎有哪些" class="headerlink" title="什么是数据库引擎 mysql引擎有哪些"></a>什么是数据库引擎 mysql引擎有哪些</h2><p>数据库引擎是数据库管理系统中的一个核心组件，用于处理数据的存储、检索和修改。不同的数据库引擎具有不同的存储和查询机制，可以影响数据库的性能、可靠性和功能。</p>
<p>MySQL提供了多种存储引擎，不同的存储引擎具有不同的特点和适用场景，如下所示：</p>
<ol>
<li>MyISAM：这是MySQL最古老的存储引擎之一，提供了高速的读取和写入速度，适合用于读多写少的应用程序。不过，它不支持事务处理和行级锁定，也不支持外键约束。</li>
<li>InnoDB：这是MySQL目前最流行的存储引擎之一，提供了高性能和高可靠性，支持事务处理和行级锁定，还支持外键约束和其他高级特性。它适合用于处理大型的、高并发的应用程序。</li>
<li>Memory：这个存储引擎将数据存储在内存中，提供了极快的读取和写入速度，但是数据只能存储在内存中，一旦服务器关闭或者重启，数据将会丢失。</li>
<li>CSV：这个存储引擎将数据存储为CSV（逗号分隔值）格式，适合用于存储大量的数据文件，但是它不支持事务处理和行级锁定，也不支持索引。</li>
<li>Archive：这个存储引擎适合用于存储归档数据，它使用压缩算法来减小数据文件的大小，但是它不支持更新和删除操作，只支持插入操作。</li>
<li>Blackhole：这个存储引擎将所有的写入操作都忽略掉，但是它仍然可以执行读取操作，适合用于数据的复制和同步。</li>
</ol>
<p>除了上述存储引擎，MySQL还提供了其他一些存储引擎，如NDB<br>Cluster、Federated、Merge等。每个存储引擎都有自己的特点和适用场景，开发人员可以根据自己的需求选择最适合的存储引擎。</p>
<h2 id="MySQL的架构"><a href="#MySQL的架构" class="headerlink" title="MySQL的架构"></a>MySQL的架构</h2><p>MySQL的架构可以分为以下三层：</p>
<ol>
<li>连接层（Connection<br>Layer）：MySQL的连接层负责接收客户端的连接请求，并验证客户端的身份。如果客户端验证通过，则连接层将会将请求转发给下一层的处理器。连接层还负责处理连接请求的一些参数，如字符集、认证方式、加密方式等。</li>
<li>处理器层（Processing<br>Layer）：MySQL的处理器层负责处理所有的SQL语句和事务请求。当处理器层接收到SQL语句时，它会对语句进行解析、优化和执行。处理器层还负责管理所有的数据库对象，如表、索引、视图等。</li>
<li>存储引擎层（Storage Engine<br>Layer）：MySQL的存储引擎层负责管理数据的存储和检索。存储引擎层将数据存储在磁盘或内存中，并且负责数据的读取、写入和索引。MySQL提供了多种存储引擎，每种存储引擎都有自己的特点和适用场景。</li>
</ol>
<p>MySQL的三层架构使得它具有很高的可扩展性和灵活性，可以根据不同的应用场景选择不同的存储引擎，从而达到最佳的性能和可靠性。</p>
<h2 id="mysql客户端和服务器"><a href="#mysql客户端和服务器" class="headerlink" title="mysql客户端和服务器"></a>mysql客户端和服务器</h2><p>MySQL客户端和服务器是MySQL架构中的两个重要组件，它们之间通过网络连接进行通信，完成数据库操作。</p>
<p>MySQL服务器是一个运行在后台的进程，用于接收客户端的连接请求，处理SQL语句和事务请求，管理数据的存储和检索。MySQL服务器的主要功能是提供安全可靠的数据库服务，为多个客户端提供并发访问的支持。</p>
<p>MySQL客户端是连接到MySQL服务器的一个应用程序，用于向MySQL服务器发送SQL语句、事务请求等操作，并接收返回的结果。MySQL客户端可以通过命令行工具、GUI工具、API等方式进行访问。</p>
<p>MySQL客户端和服务器之间的通信基于TCP&#x2F;IP协议，MySQL服务器默认监听端口为3306。客户端通过TCP&#x2F;IP协议连接到MySQL服务器后，需要进行身份验证和授权，然后才能对数据库进行操作。MySQL支持多种身份验证和授权方式，如基于用户名&#x2F;密码的身份验证、基于IP地址的访问控制等。</p>
<p>MySQL客户端和服务器的分离架构使得MySQL具有很高的可扩展性和灵活性，可以根据不同的应用场景灵活配置和调整服务器的参数和选项，从而达到最佳的性能和可靠性。</p>
<h1 id="windows下安装MySQL"><a href="#windows下安装MySQL" class="headerlink" title="windows下安装MySQL"></a>windows下安装MySQL</h1><h2 id="MySQL的两个版本"><a href="#MySQL的两个版本" class="headerlink" title="MySQL的两个版本"></a>MySQL的两个版本</h2><p>MySQL是一个开源的关系型数据库管理系统，有许多版本发布，其中比较常见的两个版本是MySQL<br>Community Edition和MySQL Enterprise Edition。</p>
<p>MySQL Community<br>Edition是免费的开源版本，提供了一些基本的数据库管理功能，包括数据存储、查询、备份和恢复等。该版本拥有较强的社区支持，有大量的开源开发者和爱好者为其开发各种插件和扩展，可以根据需要灵活地定制功能。</p>
<p>MySQL Enterprise<br>Edition则是一款商业版本，拥有更多的高级功能和服务，包括高级安全性、性能优化、数据分析、监控和自动化等。同时，它还提供了更加稳定和可靠的支持，包括24小时技术支持、紧急修复、升级和专业咨询等服务。</p>
<p>总体而言，MySQL Community Edition适合于一般的中小型应用开发，而MySQL<br>Enterprise Edition则更适合于需要高可用性和大规模部署的企业级应用。</p>
<h2 id="windows下面安装MySQL"><a href="#windows下面安装MySQL" class="headerlink" title="windows下面安装MySQL"></a>windows下面安装MySQL</h2><p>以下是在Windows操作系统上安装MySQL Community Edition的基本步骤：</p>
<ol>
<li><p>下载MySQL Community Edition安装程序<br>前往MySQL官方网站（<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/mysql/%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%89%88%E6%9C%AC%E7%9A%84MySQL%E5%AE%89%E8%A3%85%E7%A8%8B%E5%BA%8F%E3%80%82%E9%80%89%E6%8B%A9Windows">https://dev.mysql.com/downloads/mysql/）下载对应操作系统版本的MySQL安装程序。选择Windows</a><br>(x86, 32-bit), Windows (x86, 64-bit), Windows (x86, 32-bit), MSI<br>Installer或者Windows (x86, 64-bit), MSI Installer<br>适用于您的操作系统版本。同时也需要选择适用于您操作系统版本的MySQL<br>Community Edition。</p>
</li>
<li><p>运行安装程序 打开下载好的MySQL安装程序，并按照提示进行安装。</p>
</li>
<li><p>安装过程中的配置<br>在安装过程中，您需要选择要安装的MySQL版本和组件。如果您需要安装MySQL<br>Workbench等附加组件，则需要勾选相应的选项。接着您需要选择MySQL安装的位置和配置文件，建议采用默认选项。</p>
</li>
<li><p>设置root密码<br>在安装过程中，您需要设置root用户的密码。请务必设置强密码并妥善保存。</p>
</li>
<li><p>完成安装 在安装过程完成后，您可以打开MySQL Command Line<br>Client，测试MySQL是否安装成功。在命令行中输入以下命令，如果能成功登录，则表示MySQL已经安装成功：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>然后输入root用户的密码，就可以开始使用MySQL了。</p>
</li>
</ol>
<blockquote>
<p>注意：在安装MySQL之前，需要确保您的计算机上没有安装其他的MySQL版本，否则可能会导致安装失败。另外，如果您的计算机上已经安装了防火墙，请确保MySQL可以通过防火墙进行访问。</p>
</blockquote>
<h2 id="安装目录分析"><a href="#安装目录分析" class="headerlink" title="安装目录分析"></a>安装目录分析</h2><p>在Windows下安装MySQL时，通常会选择一个目录进行安装。该目录中包含MySQL数据库管理系统的所有文件和子目录。下面是MySQL<br>Windows安装目录的一些常见文件和子目录：</p>
<ol>
<li><code>bin</code><br>目录：该目录包含MySQL的二进制可执行文件。这些文件是MySQL服务器和客户端程序的核心部分，例如<br><code>mysql.exe</code>，<code>mysqld.exe</code> 等。</li>
<li><code>data</code><br>目录：该目录是MySQL服务器存储所有数据的默认位置。在这个目录中，可以找到所有的数据库和表数据文件，以及日志文件。</li>
<li><code>docs</code><br>目录：该目录包含MySQL的文档文件，包括用户手册，安装指南和开发文档等。</li>
<li><code>include</code> 目录：该目录包含用于编译MySQL客户端和服务器的头文件。</li>
<li><code>lib</code> 目录：该目录包含MySQL的库文件，例如动态链接库和静态链接库。</li>
<li><code>share</code> 目录：该目录包含共享文件，例如错误消息、字符集和语言文件等。</li>
<li><code>support-files</code> 目录：该目录包含MySQL的配置文件示例，例如<br><code>my-default.ini</code>， <code>my-huge.ini</code> 等。</li>
<li><code>my.ini</code><br>文件：这是MySQL的配置文件，包含了MySQL服务器的配置信息，例如端口号、字符集和数据存储路径等。</li>
</ol>
<blockquote>
<p>需要注意的是，这些文件和子目录的名称和结构可能会因不同版本的MySQL而有所不同。</p>
</blockquote>
<h1 id="Linux下安装MySQL"><a href="#Linux下安装MySQL" class="headerlink" title="Linux下安装MySQL"></a>Linux下安装MySQL</h1><p>以下是在CentOS操作系统上安装MySQL Community Edition的基本步骤：</p>
<ol>
<li><p>更新软件包列表 在终端中输入以下命令，更新软件包列表：</p>
<pre><code>yum update
</code></pre>
</li>
<li><p>安装MySQL 在终端中输入以下命令，安装MySQL：</p>
<pre><code>yum install mysql-server
</code></pre>
<p>安装过程中，您需要设置root用户的密码。请务必设置强密码并妥善保存。</p>
</li>
<li><p>配置MySQL<br>在安装过程中，MySQL服务器会自动启动。您可以在终端中输入以下命令来检查MySQL是否正在运行：</p>
<pre><code>systemctl status mysqld
</code></pre>
<p>如果MySQL没有启动，您可以使用以下命令手动启动MySQL：</p>
<pre><code>systemctl start mysqld
</code></pre>
</li>
<li><p>安全配置MySQL<br>您可以使用以下命令启动MySQL安全配置向导，该向导将帮助您设置MySQL的安全性：</p>
<pre><code>mysql_secure_installation
</code></pre>
<p>在向导中，您可以选择禁用匿名用户、禁用root用户的远程登录、删除测试数据库和刷新权限表等选项。</p>
</li>
<li><p>完成安装 在安装过程完成后，您可以在终端中输入以下命令，使用MySQL：</p>
<pre><code>mysql -u root -p
</code></pre>
<p>然后输入root用户的密码，就可以开始使用MySQL了。</p>
</li>
</ol>
<blockquote>
<p>注意：如果您的CentOS版本不同，安装MySQL的步骤可能会有所不同。另外，如果您的计算机上已经安装了防火墙，请确保MySQL可以通过防火墙进行访问。</p>
</blockquote>
<h1 id="在MacOS下面安装MySQL"><a href="#在MacOS下面安装MySQL" class="headerlink" title="在MacOS下面安装MySQL"></a>在MacOS下面安装MySQL</h1><p>以下是在MacOS操作系统上安装MySQL Community Edition的基本步骤：</p>
<ol>
<li><p>下载MySQL<br>访问MySQL官网（<a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/mysql/%EF%BC%89%E4%B8%8B%E8%BD%BD%E9%80%82%E7%94%A8%E4%BA%8EMacOS%E7%9A%84MySQL">https://dev.mysql.com/downloads/mysql/）下载适用于MacOS的MySQL</a><br>Community Edition。</p>
</li>
<li><p>安装MySQL<br>下载完毕后，打开下载的DMG文件，并将MySQL安装到MacOS中。将MySQL的应用程序文件夹拖动到MacOS的应用程序文件夹中。</p>
</li>
<li><p>启动MySQL 打开终端并输入以下命令来启动MySQL：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mysql/support-files/mysql.server start</span><br></pre></td></tr></table></figure>

<p>如果您希望MySQL在MacOS启动时自动启动，可以使用以下命令将MySQL添加到MacOS的系统启动项中：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mysql/support-files/mysql.server start</span><br><span class="line">sudo mkdir -p /Library/LaunchDaemons</span><br><span class="line">sudo cp /usr/local/mysql/support-files/mysql.server /Library/LaunchDaemons/</span><br><span class="line">sudo chown root:wheel /Library/LaunchDaemons/mysql.server</span><br><span class="line">sudo launchctl load -w /Library/LaunchDaemons/mysql.server</span><br></pre></td></tr></table></figure>
</li>
<li><p>安全配置MySQL<br>您可以使用以下命令启动MySQL安全配置向导，该向导将帮助您设置MySQL的安全性：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo /usr/local/mysql/bin/mysql_secure_installation</span><br></pre></td></tr></table></figure>

<p>在向导中，您可以选择禁用匿名用户、禁用root用户的远程登录、删除测试数据库和刷新权限表等选项。</p>
</li>
<li><p>完成安装 在安装过程完成后，您可以在终端中输入以下命令，使用MySQL：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>然后输入root用户的密码，就可以开始使用MySQL了。</p>
</li>
</ol>
<blockquote>
<p>注意：如果您的MacOS版本不同，安装MySQL的步骤可能会有所不同。另外，如果您的计算机上已经安装了防火墙，请确保MySQL可以通过防火墙进行访问。</p>
</blockquote>
<h1 id="MySQL配置文件分析"><a href="#MySQL配置文件分析" class="headerlink" title="MySQL配置文件分析"></a>MySQL配置文件分析</h1><h2 id="MySQL配置文件"><a href="#MySQL配置文件" class="headerlink" title="MySQL配置文件"></a>MySQL配置文件</h2><h3 id="Centos文件路径"><a href="#Centos文件路径" class="headerlink" title="Centos文件路径"></a>Centos文件路径</h3><p>在 CentOS 系统中，MySQL 的默认配置文件是 <code>/etc/my.cnf</code> 或者<br><code>/etc/mysql/my.cnf</code>，具体的文件路径取决于 MySQL<br>的安装方式和操作系统的版本。</p>
<p>如果存在多个 MySQL 实例或者使用了第三方 MySQL<br>安装包，则可能会存在多个配置文件。可以通过以下命令查找 MySQL<br>配置文件的位置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo find / -name &quot;my.cnf&quot;</span><br></pre></td></tr></table></figure>

<p>该命令将在系统中查找所有名称为 <code>my.cnf</code> 的文件，并显示它们的路径。如果<br>MySQL 的默认配置文件存在，那么可以在输出中找到它的路径。</p>
<p>需要注意的是，如果没有找到 MySQL 的默认配置文件，则可以通过创建一个新的<br><code>my.cnf</code> 文件来手动配置 MySQL 的参数和选项。在 CentOS<br>中，该文件通常放置在 <code>/etc/</code> 目录下。在创建和修改 <code>my.cnf</code><br>文件时，需要注意文件权限和所有权，以确保 MySQL 可以读取和修改该文件。</p>
<h3 id="windows文件路径"><a href="#windows文件路径" class="headerlink" title="windows文件路径"></a>windows文件路径</h3><p>在 Windows 操作系统中，MySQL 的默认配置文件名为 <code>my.ini</code> 或者<br><code>my.cnf</code>，其存放位置取决于 MySQL 的安装方式和版本。在通常情况下，MySQL<br>安装程序会将默认配置文件存储在安装目录下的 <code>bin</code> 目录中。</p>
<p>具体来说，如果您使用的是 MySQL 官方的 MSI<br>安装程序，则默认的配置文件路径通常为：</p>
<pre><code>C:\Program Files\MySQL\MySQL Server X.Y\my.ini
</code></pre>
<p>其中，<code>X.Y</code> 表示 MySQL 版本号。如果您使用的是 ZIP<br>或者二进制包进行安装，则默认的配置文件存放在解压缩目录的 <code>support-files</code><br>子目录下。</p>
<p>注意，如果在安装 MySQL<br>时选择了不同的安装目录，那么默认配置文件的位置也会相应地发生变化。</p>
<p>另外，在 Windows 中，MySQL 还可以通过 <code>--defaults-file</code><br>命令行选项来指定使用的配置文件。例如：</p>
<pre><code>C:\Program Files\MySQL\MySQL Server X.Y\bin\mysqld --defaults-file=C:\mycustom\my.ini
</code></pre>
<p>以上命令将启动 MySQL，并使用 <code>C:\mycustom\my.ini</code> 文件作为配置文件。</p>
<h2 id="重要选项分析"><a href="#重要选项分析" class="headerlink" title="重要选项分析"></a>重要选项分析</h2><p>MySQL 的配置文件包含了 MySQL 服务器的所有配置信息，MySQL<br>在启动的时候会读取该配置文件来初始化服务器的各种参数和选项。下面是 MySQL<br>的配置文件的一些常见选项和参数：</p>
<ol>
<li><code>[mysqld]</code>：这个部分包含了 MySQL<br>服务器的配置信息，其中包括常见的配置项，例如 <code>port</code>，<code>datadir</code> 等。</li>
<li><code>port</code>：该选项指定了 MySQL 服务器监听的端口号，默认值是 3306。</li>
<li><code>datadir</code>：该选项指定了 MySQL 服务器的数据文件的存储路径，默认值是<br><code>/var/lib/mysql</code>。</li>
<li><code>bind-address</code>：该选项指定了 MySQL 服务器监听的 IP 地址，默认值是<br><code>0.0.0.0</code>，表示监听所有的 IP 地址。</li>
<li><code>socket</code>：该选项指定了 MySQL 服务器使用的 Unix<br>套接字文件的路径，默认值是 <code>/var/run/mysqld/mysqld.sock</code>。</li>
<li><code>log-error</code>：该选项指定了 MySQL<br>服务器的错误日志文件的路径和文件名，默认值是<br><code>/var/log/mysql/error.log</code>。</li>
<li><code>pid-file</code>：该选项指定了 MySQL 服务器的 PID<br>文件的路径和文件名，默认值是 <code>/var/run/mysqld/mysqld.pid</code>。</li>
<li><code>[client]</code>：这个部分包含了 MySQL<br>客户端的配置信息，其中包括常见的配置项，例如 <code>user</code>，<code>password</code> 等。</li>
<li><code>user</code>：该选项指定了 MySQL<br>客户端连接数据库时使用的用户名，默认值是当前登录用户的用户名。</li>
<li><code>password</code>：该选项指定了 MySQL<br>客户端连接数据库时使用的密码，默认值是空。</li>
</ol>
<p>需要注意的是，MySQL<br>的配置文件可以在安装时指定，也可以在运行时通过命令行选项来指定。并且，MySQL<br>的配置文件的路径和名称可能因不同的操作系统和 MySQL 版本而有所不同。</p>
<h1 id="MySQL数据库的基本操作"><a href="#MySQL数据库的基本操作" class="headerlink" title="MySQL数据库的基本操作"></a>MySQL数据库的基本操作</h1><p>以下是常用的 SQL 语句来创建、删除、修改和打开数据库：</p>
<ol>
<li>创建数据库</li>
</ol>
<p>创建一个名为 <code>mydatabase</code> 的数据库：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE mydatabase;</span><br></pre></td></tr></table></figure>

<ol>
<li>删除数据库</li>
</ol>
<p>删除名为 <code>mydatabase</code> 的数据库：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE mydatabase;</span><br></pre></td></tr></table></figure>

<ol>
<li>修改数据库</li>
</ol>
<p>修改名为 <code>mydatabase</code> 的数据库的字符集为 <code>utf8mb4</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> DATABASE mydatabase <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4;</span><br></pre></td></tr></table></figure>

<ol>
<li>打开数据库</li>
</ol>
<p>在 MySQL 中，使用 <code>USE</code> 语句来打开数据库。例如，要使用名为 <code>mydatabase</code><br>的数据库，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">USE mydatabase;</span><br></pre></td></tr></table></figure>

<p>在执行该命令后，所有后续的 SQL 语句都将在 <code>mydatabase</code> 数据库中执行。</p>
<blockquote>
<p>需要注意的是，如果要创建、删除、修改或打开数据库，需要有足够的权限才能执行这些操作。在<br>MySQL 中，通常使用授权命令（例如<br><code>GRANT</code>）来授予或撤销用户对数据库的权限。另外，还需要使用适当的 SQL<br>客户端（例如 <code>mysql</code> 命令行工具或者 MySQL Workbench）来执行这些 SQL<br>语句。</p>
</blockquote>
<h1 id="MySQL创建表"><a href="#MySQL创建表" class="headerlink" title="MySQL创建表"></a>MySQL创建表</h1><h2 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h2><p>以下是一个基本的 MySQL 创建表的 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name (</span><br><span class="line">    column1 datatype constraints,</span><br><span class="line">    column2 datatype constraints,</span><br><span class="line">    column3 datatype constraints,</span><br><span class="line">    ...</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (<span class="keyword">one</span> <span class="keyword">or</span> more columns)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的 SQL 语句中，<code>table_name</code> 是要创建的表的名称，<code>column1</code>,<br><code>column2</code>, <code>column3</code> 等是表中的列名，<code>datatype</code><br>是该列的数据类型，<code>constraints</code> 是该列的约束条件（例如 NOT<br>NULL、UNIQUE、DEFAULT 等）。</p>
<p><code>PRIMARY KEY</code><br>是必需的，并且至少应指定一个列作为主键。主键用于唯一地标识表中的每个记录，因此它必须是唯一的并且不能为<br>NULL。</p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>以下是一个更具体的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">    password <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    created_at <span class="type">TIMESTAMP</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们创建了一个名为 <code>users</code> 的表，该表包含五个列：</p>
<ul>
<li><code>id</code>：整数类型的主键列，具有自动递增属性。</li>
<li><code>name</code>：长度为50个字符的字符串类型的列，不能为 NULL。</li>
<li><code>email</code>：长度为255个字符的字符串类型的列，不能为<br>NULL，且必须是唯一的。</li>
<li><code>password</code>：长度为255个字符的字符串类型的列，不能为 NULL。</li>
<li><code>created_at</code>：时间戳类型的列，使用 <code>CURRENT_TIMESTAMP</code> 作为默认值。</li>
</ul>
<blockquote>
<p>需要注意的是，数据类型和约束条件取决于具体的需求，可以根据需要进行修改。</p>
</blockquote>
<h1 id="MySQL插入数据"><a href="#MySQL插入数据" class="headerlink" title="MySQL插入数据"></a>MySQL插入数据</h1><h2 id="语法-1"><a href="#语法-1" class="headerlink" title="语法"></a>语法</h2><p>向 MySQL 数据库中插入数据可以使用 <code>INSERT INTO</code> 语句。下面是一个示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table_name (column1, column2, column3, ...)</span><br><span class="line"><span class="keyword">VALUES</span> (value1, value2, value3, ...);</span><br></pre></td></tr></table></figure>

<p>其中，<code>table_name</code> 是要插入数据的表名，<code>column1</code>, <code>column2</code>, <code>column3</code><br>等是表中的列名，<code>value1</code>, <code>value2</code>, <code>value3</code><br>等是要插入的值。需要注意的是，列名和对应的值必须匹配。</p>
<h2 id="实例-1"><a href="#实例-1" class="headerlink" title="实例"></a>实例</h2><h3 id="插入单条"><a href="#插入单条" class="headerlink" title="插入单条"></a>插入单条</h3><p>以下是一个示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name, email, password)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;tom&#x27;</span>, <span class="string">&#x27;tom@qq.com&#x27;</span>, <span class="string">&#x27;password123&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们向 <code>users</code> 表中插入了一条记录，包含 <code>name</code>, <code>email</code><br>和 <code>password</code><br>三个字段的值。需要注意的是，如果某个字段允许为空，则可以将其值设置为<br><code>NULL</code>。如果某个字段是自动递增的，则不需要在插入数据时指定该字段的值，MySQL<br>会自动分配。</p>
<h3 id="插入多条记录"><a href="#插入多条记录" class="headerlink" title="插入多条记录"></a>插入多条记录</h3><p>如果要同时插入多条记录，可以在 <code>VALUES</code><br>后面添加多个值组，用逗号分隔。例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name, email, password)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;tom&#x27;</span>, <span class="string">&#x27;tom@qq.com&#x27;</span>, <span class="string">&#x27;password123&#x27;</span>),</span><br><span class="line">       (<span class="string">&#x27;kite&#x27;</span>, <span class="string">&#x27;kite@qq.com&#x27;</span>, <span class="string">&#x27;password456&#x27;</span>),</span><br><span class="line">       (<span class="string">&#x27;rose&#x27;</span>, <span class="string">&#x27;rose@qq.com&#x27;</span>, <span class="string">&#x27;password789&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>以上 SQL 语句将向 <code>users</code> 表中插入三条记录。</p>
<blockquote>
<p>需要注意的是，向 MySQL<br>数据库中插入数据需要有足够的权限才能执行该操作。同时，也需要注意数据的合法性和完整性，以避免数据不一致或丢失的问题。</p>
</blockquote>
<h1 id="MySQL删除数据"><a href="#MySQL删除数据" class="headerlink" title="MySQL删除数据"></a>MySQL删除数据</h1><p>MySQL 中使用 <code>DELETE</code> 语句来删除数据。<code>DELETE</code><br>语句用于从表中删除数据，可以指定删除的行和条件。</p>
<h2 id="语法-2"><a href="#语法-2" class="headerlink" title="语法"></a>语法</h2><p>下面是一个基本的 <code>DELETE</code> 语句的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure>

<p>其中，<code>table_name</code> 是要删除数据的表名，<code>condition</code><br>是删除数据的条件。需要注意的是，如果没有指定条件，将会删除表中所有的数据。</p>
<h2 id="实例-2"><a href="#实例-2" class="headerlink" title="实例"></a>实例</h2><p>以下是一个示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们从 <code>users</code> 表中删除了 <code>id</code> 列的值为 <code>1</code> 的行。</p>
<blockquote>
<p>需要注意的是，删除操作是不可恢复的，所以在执行 <code>DELETE</code><br>语句之前一定要三思而后行。同时，也需要注意数据库中的关联关系和完整性约束，以避免数据不一致或丢失的问题。如果需要删除整个表，可以使用<br><code>DROP TABLE</code> 语句，但同样需要谨慎操作。</p>
</blockquote>
<h1 id="MySQL修改数据"><a href="#MySQL修改数据" class="headerlink" title="MySQL修改数据"></a>MySQL修改数据</h1><p>MySQL 中使用 <code>UPDATE</code> 语句来修改数据。<code>UPDATE</code><br>语句用于更新表中的数据，可以指定要更新的列和更新的条件。</p>
<h2 id="语法-3"><a href="#语法-3" class="headerlink" title="语法"></a>语法</h2><p>下面是一个基本的 <code>UPDATE</code> 语句的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> table_name</span><br><span class="line"><span class="keyword">SET</span> column1 <span class="operator">=</span> value1, column2 <span class="operator">=</span> value2, ...</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure>

<p>其中，<code>table_name</code> 是要更新数据的表名，<code>column1</code>, <code>column2</code>, …<br>是要更新的列名，<code>value1</code>, <code>value2</code>, … 是要更新的值，<code>condition</code><br>是更新数据的条件。</p>
<h2 id="实例-3"><a href="#实例-3" class="headerlink" title="实例"></a>实例</h2><p>以下是一个示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> users</span><br><span class="line"><span class="keyword">SET</span> email <span class="operator">=</span> <span class="string">&#x27;new-email@example.com&#x27;</span>, status <span class="operator">=</span> <span class="string">&#x27;active&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们将 <code>users</code> 表中 <code>id</code> 列的值为 <code>1</code> 的行的 <code>email</code><br>列更新为 <code>new-email@example.com</code>，<code>status</code> 列更新为 <code>active</code>。</p>
<blockquote>
<p>需要注意的是，修改操作可能会影响到其他的数据和约束，需要谨慎操作。同时，也需要注意数据类型的匹配和长度限制，以避免数据被截断或溢出。</p>
</blockquote>
<h1 id="MySQL基本查询"><a href="#MySQL基本查询" class="headerlink" title="MySQL基本查询"></a>MySQL基本查询</h1><p>MySQL 中使用 <code>SELECT</code> 语句来查询数据。<code>SELECT</code><br>语句用于从表中检索数据，可以指定要检索的列、过滤条件、排序方式等。</p>
<h2 id="语法-4"><a href="#语法-4" class="headerlink" title="语法"></a>语法</h2><p>下面是一个基本的 <code>SELECT</code> 语句的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> column1, column2, ...</span><br><span class="line"><span class="keyword">FROM</span> table_name</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">condition</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> column1 [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], column2 [<span class="keyword">ASC</span><span class="operator">|</span><span class="keyword">DESC</span>], ...;</span><br></pre></td></tr></table></figure>

<p>其中，<code>column1</code>, <code>column2</code>, … 是要检索的列名，可以使用通配符 <code>*</code><br>检索所有列。<code>table_name</code> 是要从中检索数据的表名。<code>condition</code><br>是查询条件，用于过滤数据，可以使用 <code>AND</code>、<code>OR</code>、<code>IN</code>、<code>BETWEEN</code><br>等操作符进行组合。<code>ORDER BY</code><br>子句用于指定检索结果的排序方式，可以按一个或多个列进行升序或降序排序。</p>
<h2 id="实例-4"><a href="#实例-4" class="headerlink" title="实例"></a>实例</h2><p>以下是一个示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, email</span><br><span class="line"><span class="keyword">FROM</span> users</span><br><span class="line"><span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%example.com&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> name <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们从 <code>users</code> 表中检索了 <code>name</code> 和 <code>email</code><br>两个列的数据，并按照 <code>name</code><br>列的升序方式排序。同时，我们指定了一个过滤条件，用于筛选出 <code>email</code> 列以<br><code>example.com</code> 结尾的记录。</p>
<blockquote>
<p>需要注意的是，查询结果可能会包含多条记录，需要使用适当的方式来处理这些数据，例如循环遍历或使用聚合函数。同时，也需要注意<br>SQL 注入等安全问题，确保输入的查询条件是安全的。</p>
</blockquote>
<h1 id="MySQL可视化客户端"><a href="#MySQL可视化客户端" class="headerlink" title="MySQL可视化客户端"></a>MySQL可视化客户端</h1><h2 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h2><p>MySQL 可视化客户端是一个图形化界面的工具，可以帮助用户更方便地管理和操作<br>MySQL 数据库。以下是一些常见的 MySQL 可视化客户端：</p>
<ol>
<li>MySQL Workbench：这是官方提供的 MySQL<br>数据库管理工具，支持数据建模、SQL<br>编辑和调试、数据备份和恢复等功能。MySQL Workbench 是跨平台的，可以在<br>Windows、Linux 和 macOS 等操作系统上使用。</li>
<li>Navicat for MySQL：这是一款商业的 MySQL<br>客户端，支持多种操作系统，并提供了丰富的功能，包括数据导入和导出、可视化查询构建器、数据同步、备份和恢复等。</li>
<li>HeidiSQL：这是一款免费的开源 MySQL 客户端，支持 Windows<br>平台。它提供了多种功能，包括数据导入和导出、SQL<br>编辑和执行、数据库对象管理等。</li>
<li>DBeaver：这是一款免费的开源数据库工具，支持多种数据库，包括<br>MySQL、PostgreSQL、SQLite 等。DBeaver<br>提供了丰富的功能，包括数据导入和导出、SQL 编辑和执行、数据可视化等。</li>
<li>phpMyAdmin：这是一款基于 Web 的 MySQL<br>客户端，可以通过浏览器访问。它提供了丰富的功能，包括数据导入和导出、SQL<br>编辑和执行、数据库对象管理等。phpMyAdmin 是免费的，可以在大多数 Web<br>服务器上使用。</li>
<li>SQLyog：是一款商业的 MySQL<br>可视化客户端，它提供了丰富的功能，包括数据管理、SQL<br>编辑和执行、数据同步、备份和恢复等。</li>
<li>DataGrid：（数据网格）是一种用于显示表格数据的控件，可以在网页中显示数据，并提供了许多有用的功能，如排序、筛选、分页等</li>
</ol>
<p>这些 MySQL<br>可视化客户端都有其优缺点，用户可以根据自己的需求和使用习惯选择适合自己的工具。</p>
<h2 id="DBeaver客户端的使用"><a href="#DBeaver客户端的使用" class="headerlink" title="DBeaver客户端的使用"></a>DBeaver客户端的使用</h2><p>DBeaver <code>/diː&#39;beɪvə(r)/</code><br>是一款免费的开源数据库管理工具，支持多种数据库（MySQL、PostgreSQL、Oracle、SQL<br>Server 等）的连接和管理，可以在 Windows、macOS、Linux<br>等平台上使用。以下是 DBeaver 的基本使用方法：</p>
<ol>
<li>下载并安装 DBeaver 客户端：可以从 DBeaver<br>的官方网站（<a target="_blank" rel="noopener" href="https://dbeaver.io/download/%EF%BC%89%E4%B8%8B%E8%BD%BD%E5%AF%B9%E5%BA%94%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%AE%89%E8%A3%85%E5%8C%85%EF%BC%8C%E5%B9%B6%E6%8C%89%E7%85%A7%E6%8F%90%E7%A4%BA%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85%E3%80%82">https://dbeaver.io/download/）下载对应平台的安装包，并按照提示进行安装。</a></li>
<li>新建数据库连接：启动 DBeaver<br>后，点击”新建连接”按钮，选择要连接的数据库类型（如<br>MySQL），输入连接信息（如主机名、端口、用户名、密码等），并测试连接是否成功。</li>
<li>执行 SQL 查询：在连接成功后，可以在 DBeaver 中打开 SQL 编辑器，输入<br>SQL 查询语句（如 SELECT、INSERT、UPDATE、DELETE<br>等），并执行查询，查看结果。</li>
<li>管理数据库对象：在 DBeaver<br>中，可以管理数据库中的各种对象，如表、视图、存储过程等。可以查看对象的结构、编辑对象的属性、复制对象等。</li>
<li>导入导出数据：在 DBeaver 中，可以将数据导出为 CSV、Excel、SQL<br>等格式，也可以将数据从文件或数据库中导入。</li>
<li>高级功能：DBeaver<br>还提供了一些高级功能，如数据比较、数据同步、查询优化器、安全管理等，可以根据需要使用。</li>
</ol>
<p>DBeaver<br>是一款功能强大的数据库管理工具，可以帮助开发者和管理员轻松地连接和管理多种数据库，提高工作效率和生产力。</p>
<h2 id="SQLyog客户端的使用"><a href="#SQLyog客户端的使用" class="headerlink" title="SQLyog客户端的使用"></a>SQLyog客户端的使用</h2><p>SQLyog是一个流行的MySQL管理工具，它支持Windows操作系统，以下是SQLyog在Windows下的下载和安装步骤：</p>
<ol>
<li>访问SQLyog官网（<a target="_blank" rel="noopener" href="https://www.webyog.com/product/sqlyog%EF%BC%89%E3%80%82">https://www.webyog.com/product/sqlyog）。</a></li>
<li>单击”下载”按钮以下载安装程序。</li>
<li>运行下载的安装程序。</li>
<li>点击”下一步”按钮，阅读许可协议，然后勾选同意协议。</li>
<li>选择要安装的组件，可以选择”SQLyog Community Edition”或”SQLyog<br>Ultimate”。</li>
<li>指定安装位置并点击”下一步”按钮。</li>
<li>选择开始菜单文件夹并单击”下一步”。</li>
<li>选择桌面图标选项并单击”下一步”。</li>
<li>点击”安装”按钮，等待安装完成。</li>
<li>点击”完成”按钮，启动SQLyog。</li>
</ol>
<p>安装完成后，您可以通过双击SQLyog桌面图标来启动它。</p>
<h1 id="SQL语句的分类"><a href="#SQL语句的分类" class="headerlink" title="SQL语句的分类"></a>SQL语句的分类</h1><h2 id="SQL简介"><a href="#SQL简介" class="headerlink" title="SQL简介"></a>SQL简介</h2><p>SQL（Structured Query<br>Language，结构化查询语言）是一种用于关系数据库管理系统的标准化查询语言，主要用于数据库中数据的增删改查、表的创建与删除、表之间的关联和约束等方面。</p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>根据 SQL 语句的作用和用途，可以将 SQL 分为以下几类：</p>
<ol>
<li>数据定义语言（Data Definition<br>Language，DDL）：用于创建、修改和删除数据库、表、视图、索引、触发器等数据库对象。常用的<br>DDL 语句包括：CREATE、ALTER 和 DROP 等。</li>
<li>数据操作语言（Data Manipulation<br>Language，DML）：用于向数据库中的表中添加、修改或删除数据。常用的<br>DML 语句包括：SELECT、INSERT、UPDATE 和 DELETE 等。</li>
<li>数据查询语言（Data Query<br>Language，DQL）：用于查询数据库中的数据，一般用于从一个或多个表中获取特定的数据集。DQL<br>语句中最常用的就是 SELECT 语句，它可以通过 WHERE 子句和 JOIN<br>操作等方式查询出符合条件的数据。</li>
<li>数据控制语言（Data Control<br>Language，DCL）：用于管理数据库用户和权限，可以对数据库用户进行授权或限制其访问权限。常用的<br>DCL 语句包括：GRANT 和 REVOKE 等。</li>
<li>事务控制语言（Transaction Control<br>Language，TCL）：用于管理数据库中的事务，包括事务的开始、提交和回滚等操作。常用的<br>TCL 语句包括：COMMIT、ROLLBACK 和 SAVEPOINT 等。</li>
<li>数据库管理语言（Database Administration<br>Language，DAL）：用于管理数据库的结构和组件，包括备份和恢复数据库、数据压缩和加密、数据库复制等。常用的<br>DAL 语句包括：BACKUP、RESTORE 和 DBCC 等。</li>
</ol>
<h1 id="MySQL的DDL"><a href="#MySQL的DDL" class="headerlink" title="MySQL的DDL"></a>MySQL的DDL</h1><p>MySQL 的 DDL（Data Definition<br>Language）是用于定义数据库、表、列、索引等数据库对象的语言。DDL<br>语句可以实现数据库的创建、修改和删除等操作，具体包括以下语句：</p>
<ol>
<li>创建数据库</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE database_name;</span><br></pre></td></tr></table></figure>

<ol>
<li>删除数据库</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> DATABASE database_name;</span><br></pre></td></tr></table></figure>

<ol>
<li>创建表</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> table_name (</span><br><span class="line">   column1 datatype,</span><br><span class="line">   column2 datatype,</span><br><span class="line">   column3 datatype,</span><br><span class="line">   .....</span><br><span class="line">   columnN datatype,</span><br><span class="line">   <span class="keyword">PRIMARY</span> KEY (<span class="keyword">one</span> <span class="keyword">or</span> more columns)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ol>
<li>修改表</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ADD</span> column_name datatype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> column_name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name MODIFY column_name datatype;</span><br></pre></td></tr></table></figure>

<ol>
<li>删除表</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> table_name;</span><br></pre></td></tr></table></figure>

<ol>
<li>创建索引</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX index_name <span class="keyword">ON</span> table_name (column_name);</span><br></pre></td></tr></table></figure>

<ol>
<li>删除索引</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> INDEX index_name <span class="keyword">ON</span> table_name;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>这些 DDL 语句可以通过 MySQL 命令行客户端或图形化客户端（如 MySQL<br>Workbench）等工具执行。在执行 DDL<br>语句时，需要注意语法的正确性，避免错误操作导致数据库结构的损坏。同时，DDL<br>操作具有较高的权限，应该谨慎使用。</p>
</blockquote>
<h1 id="MySQL的数据类型"><a href="#MySQL的数据类型" class="headerlink" title="MySQL的数据类型"></a>MySQL的数据类型</h1><p>MySQL<br>支持多种数据类型，包括数值型、字符串型、日期时间型、二进制型等。以下是<br>MySQL 常见的数据类型：</p>
<ol>
<li>数值型</li>
</ol>
<ul>
<li>TINYINT</li>
<li>SMALLINT</li>
<li>MEDIUMINT</li>
<li>INT</li>
<li>BIGINT</li>
<li>FLOAT</li>
<li>DOUBLE</li>
<li>DECIMAL</li>
</ul>
<ol>
<li>字符串型</li>
</ol>
<ul>
<li>CHAR</li>
<li>VARCHAR</li>
<li>TINYTEXT</li>
<li>TEXT</li>
<li>MEDIUMTEXT</li>
<li>LONGTEXT</li>
<li>ENUM</li>
<li>SET</li>
</ul>
<ol>
<li>日期时间型</li>
</ol>
<ul>
<li>DATE</li>
<li>TIME</li>
<li>YEAR</li>
<li>DATETIME</li>
<li>TIMESTAMP</li>
</ul>
<ol>
<li>二进制型</li>
</ol>
<ul>
<li>BINARY</li>
<li>VARBINARY</li>
<li>TINYBLOB</li>
<li>BLOB</li>
<li>MEDIUMBLOB</li>
<li>LONGBLOB</li>
</ul>
<p>数据类型的选择应该根据存储的数据类型和范围来确定。例如，对于存储性别的字段，可以使用<br>ENUM<br>类型，因为该字段的取值范围较小，只有男、女两个取值。对于存储长文本的字段，应该使用<br>LONGTEXT 类型，而不是 TEXT 类型，以支持更大的文本内容。</p>
<h2 id="实例-5"><a href="#实例-5" class="headerlink" title="实例"></a>实例</h2><p>以下是一个创建 MySQL 表的示例，包含了常见的数据类型：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employees` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` tinyint(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `hire_date` <span class="type">date</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `photo` <span class="type">blob</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4;</span><br></pre></td></tr></table></figure>

<p>在这个表中，我们定义了以下字段：</p>
<ul>
<li><code>id</code>: 整数型，主键，自动增长</li>
<li><code>name</code>: 字符串型，最大长度为 50</li>
<li><code>age</code>: 整数型，最大长度为 4</li>
<li><code>email</code>: 字符串型，最大长度为 100</li>
<li><code>salary</code>: 十进制型，总长度为 10，小数部分长度为 2</li>
<li><code>hire_date</code>: 日期型</li>
<li><code>photo</code>: 二进制型，用于存储员工照片</li>
</ul>
<blockquote>
<p>这只是一个示例，根据实际需求，数据类型和字段定义可以有所不同。在创建表时，需要注意表的命名、字段名的命名、数据类型的选择等，以便确保表结构的规范性和易于维护性。</p>
</blockquote>
<h1 id="MySQL-DML"><a href="#MySQL-DML" class="headerlink" title="MySQL DML"></a>MySQL DML</h1><p>DML 是 MySQL 中的一种语言，用于操作表中的数据，包括<br>SELECT、INSERT、UPDATE 和 DELETE 四种操作。以下是 DML 的一些示例：</p>
<ol>
<li>SELECT</li>
</ol>
<p>SELECT 语句用于从表中检索数据。可以使用 WHERE 子句指定条件，也可以使用<br>ORDER BY 子句排序结果。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>INSERT</li>
</ol>
<p>INSERT<br>语句用于向表中插入新数据。需要指定表名和要插入的数据。如果要插入多行数据，可以使用<br>VALUES 关键字。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, age, email, salary, hire_date) <span class="keyword">VALUES</span> (<span class="string">&#x27;Tom&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;tom@example.com&#x27;</span>, <span class="number">5000.00</span>, <span class="string">&#x27;2022-02-18&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ol>
<li>UPDATE</li>
</ol>
<p>UPDATE 语句用于更新表中的数据。需要指定表名、要更新的字段和新的值，以及<br>WHERE 子句指定更新的条件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> employees <span class="keyword">SET</span> salary <span class="operator">=</span> <span class="number">6000.00</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>DELETE</li>
</ol>
<p>DELETE 语句用于从表中删除数据。需要指定表名和 WHERE<br>子句指定要删除的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">&lt;</span> <span class="number">25</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>在使用 DML 语句时，需要小心使用 WHERE<br>子句和其他限制条件，以免意外删除或修改数据。另外，需要注意语句的性能和执行效率，避免对数据库造成不必要的负担。</p>
</blockquote>
<h1 id="MySQL-DQL"><a href="#MySQL-DQL" class="headerlink" title="MySQL DQL"></a>MySQL DQL</h1><p>DQL（Data Query Language）是 MySQL<br>中的一种语言，用于从表中检索数据。其中最常见的是 SELECT 语句，以下是<br>SELECT 语句的一些示例：</p>
<p><strong>准备数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  salary <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, email, age, salary)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>, <span class="number">28</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>, <span class="number">35</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Bob Johnson&#x27;</span>, <span class="string">&#x27;bob.johnson@example.com&#x27;</span>, <span class="number">42</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Mary Williams&#x27;</span>, <span class="string">&#x27;mary.williams@example.com&#x27;</span>, <span class="number">23</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;David Brown&#x27;</span>, <span class="string">&#x27;david.brown@example.com&#x27;</span>, <span class="number">31</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Sarah Davis&#x27;</span>, <span class="string">&#x27;sarah.davis@example.com&#x27;</span>, <span class="number">46</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Paul Wilson&#x27;</span>, <span class="string">&#x27;paul.wilson@example.com&#x27;</span>, <span class="number">29</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Lisa Jackson&#x27;</span>, <span class="string">&#x27;lisa.jackson@example.com&#x27;</span>, <span class="number">38</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Michael Lee&#x27;</span>, <span class="string">&#x27;michael.lee@example.com&#x27;</span>, <span class="number">27</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jennifer Perez&#x27;</span>, <span class="string">&#x27;jennifer.perez@example.com&#x27;</span>, <span class="number">33</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;James Garcia&#x27;</span>, <span class="string">&#x27;james.garcia@example.com&#x27;</span>, <span class="number">44</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Elizabeth Rodriguez&#x27;</span>, <span class="string">&#x27;elizabeth.rodriguez@example.com&#x27;</span>, <span class="number">25</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Charles Hernandez&#x27;</span>, <span class="string">&#x27;charles.hernandez@example.com&#x27;</span>, <span class="number">39</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jessica King&#x27;</span>, <span class="string">&#x27;jessica.king@example.com&#x27;</span>, <span class="number">30</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Anthony Wright&#x27;</span>, <span class="string">&#x27;anthony.wright@example.com&#x27;</span>, <span class="number">36</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Melissa Scott&#x27;</span>, <span class="string">&#x27;melissa.scott@example.com&#x27;</span>, <span class="number">41</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Kevin Green&#x27;</span>, <span class="string">&#x27;kevin.green@example.com&#x27;</span>, <span class="number">26</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Amanda Baker&#x27;</span>, <span class="string">&#x27;amanda.baker@example.com&#x27;</span>, <span class="number">37</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Richard Adams&#x27;</span>, <span class="string">&#x27;richard.adams@example.com&#x27;</span>, <span class="number">32</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Christina Carter&#x27;</span>, <span class="string">&#x27;christina.carter@example.com&#x27;</span>, <span class="number">43</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Daniel Lewis&#x27;</span>, <span class="string">&#x27;daniel.lewis@example.com&#x27;</span>, <span class="number">34</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>));</span><br></pre></td></tr></table></figure>

<ol>
<li>SELECT 所有列</li>
</ol>
<p>SELECT * 语句用于检索表中的所有列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ol>
<li>SELECT 指定列</li>
</ol>
<p>可以使用 SELECT 语句选择表中的指定列。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age, email <span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<ol>
<li>使用 WHERE 子句</li>
</ol>
<p>WHERE 子句用于过滤检索结果。可以根据多个条件过滤数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age, email <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">AND</span> salary <span class="operator">&gt;</span> <span class="number">5000.00</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>使用 ORDER BY 子句</li>
</ol>
<p>ORDER BY 子句用于按指定列对结果进行排序，可以按升序或降序排序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age, email, salary <span class="keyword">FROM</span> employees <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>使用 LIMIT 子句</li>
</ol>
<p>LIMIT 子句用于限制检索结果的数量。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age, email, salary <span class="keyword">FROM</span> employees <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> LIMIT <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>DQL 还有许多其他功能，例如使用 GROUP BY 和 HAVING 子句进行分组、使用<br>JOIN 子句连接多个表等等。在使用 DQL<br>语句时，需要注意语句的性能和效率，避免对数据库造成不必要的负担。</p>
<h1 id="MySQL条件查询where子句"><a href="#MySQL条件查询where子句" class="headerlink" title="MySQL条件查询where子句"></a>MySQL条件查询where子句</h1><p>在 MySQL 中，WHERE 子句用于从表中选择满足条件的数据。以下是一些示例：</p>
<p><strong>准备数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  salary <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, email, age, salary)</span><br><span class="line"><span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>, <span class="number">28</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>, <span class="number">35</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Bob Johnson&#x27;</span>, <span class="string">&#x27;bob.johnson@example.com&#x27;</span>, <span class="number">42</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Mary Williams&#x27;</span>, <span class="string">&#x27;mary.williams@example.com&#x27;</span>, <span class="number">23</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;David Brown&#x27;</span>, <span class="string">&#x27;david.brown@example.com&#x27;</span>, <span class="number">31</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Sarah Davis&#x27;</span>, <span class="string">&#x27;sarah.davis@example.com&#x27;</span>, <span class="number">46</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Paul Wilson&#x27;</span>, <span class="string">&#x27;paul.wilson@example.com&#x27;</span>, <span class="number">29</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Lisa Jackson&#x27;</span>, <span class="string">&#x27;lisa.jackson@example.com&#x27;</span>, <span class="number">38</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Michael Lee&#x27;</span>, <span class="string">&#x27;michael.lee@example.com&#x27;</span>, <span class="number">27</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jennifer Perez&#x27;</span>, <span class="string">&#x27;jennifer.perez@example.com&#x27;</span>, <span class="number">33</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;James Garcia&#x27;</span>, <span class="string">&#x27;james.garcia@example.com&#x27;</span>, <span class="number">44</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Elizabeth Rodriguez&#x27;</span>, <span class="string">&#x27;elizabeth.rodriguez@example.com&#x27;</span>, <span class="number">25</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Charles Hernandez&#x27;</span>, <span class="string">&#x27;charles.hernandez@example.com&#x27;</span>, <span class="number">39</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Jessica King&#x27;</span>, <span class="string">&#x27;jessica.king@example.com&#x27;</span>, <span class="number">30</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Anthony Wright&#x27;</span>, <span class="string">&#x27;anthony.wright@example.com&#x27;</span>, <span class="number">36</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Melissa Scott&#x27;</span>, <span class="string">&#x27;melissa.scott@example.com&#x27;</span>, <span class="number">41</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Kevin Green&#x27;</span>, <span class="string">&#x27;kevin.green@example.com&#x27;</span>, <span class="number">26</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Amanda Baker&#x27;</span>, <span class="string">&#x27;amanda.baker@example.com&#x27;</span>, <span class="number">37</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Richard Adams&#x27;</span>, <span class="string">&#x27;richard.adams@example.com&#x27;</span>, <span class="number">32</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Christina Carter&#x27;</span>, <span class="string">&#x27;christina.carter@example.com&#x27;</span>, <span class="number">43</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>)),</span><br><span class="line">  (<span class="string">&#x27;Daniel Lewis&#x27;</span>, <span class="string">&#x27;daniel.lewis@example.com&#x27;</span>, <span class="number">34</span>, <span class="built_in">FLOOR</span>(RAND() <span class="operator">*</span> <span class="number">10000</span>));</span><br></pre></td></tr></table></figure>

<ol>
<li>基本用法</li>
</ol>
<p>WHERE 子句可以与 SELECT 语句一起使用，以便从表中检索指定条件的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有薪水高于 5000 的员工的信息。</p>
<ol>
<li>AND 和 OR 运算符</li>
</ol>
<p>WHERE 子句可以使用 AND 和 OR 运算符来检索满足多个条件的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">AND</span> salary <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="operator">&gt;</span> <span class="number">30</span> <span class="keyword">OR</span> salary <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有年龄大于 30 岁且薪水高于 5000<br>的员工的信息，或者返回所有年龄大于 30 岁或薪水高于 5000 的员工的信息。</p>
<ol>
<li>IN 运算符</li>
</ol>
<p>IN 运算符用于从表中检索符合指定值列表的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> age <span class="keyword">IN</span> (<span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>);</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有年龄为 25、30 或 35 的员工的信息。</p>
<ol>
<li>BETWEEN 运算符</li>
</ol>
<p>BETWEEN 运算符用于从表中检索在指定范围内的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> <span class="number">5000</span> <span class="keyword">AND</span> <span class="number">8000</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有薪水在 5000 到 8000 之间的员工的信息。</p>
<ol>
<li>LIKE 运算符</li>
</ol>
<p>LIKE 运算符用于从表中检索与指定模式匹配的数据。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;Tom%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有名字以 “Tom” 开头的员工的信息。</p>
<blockquote>
<p>WHERE 子句还有许多其他功能，例如使用 IS NULL 和 IS NOT NULL<br>来检索空值和非空值，使用通配符进行模糊匹配等等。在使用 WHERE<br>子句时，需要注意语句的性能和效率，避免对数据库造成不必要的负担。</p>
</blockquote>
<h1 id="MySQL查询like"><a href="#MySQL查询like" class="headerlink" title="MySQL查询like"></a>MySQL查询like</h1><p>在 MySQL 中，LIKE<br>运算符用于模糊查询满足指定模式的数据，通常用于字符串类型的字段。</p>
<p>LIKE 运算符可以与通配符一起使用，通配符用于指定要匹配的模式。MySQL<br>中常用的通配符有两种：</p>
<ol>
<li>百分号（%）：表示任意字符，包括 0 个字符。</li>
<li>下划线（_）：表示任意单个字符。</li>
</ol>
<p>以下是一些示例：</p>
<ol>
<li>匹配以指定字符开头的字符串</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;Tom%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有名字以 “Tom” 开头的员工的信息。</p>
<ol>
<li>匹配以指定字符结尾的字符串</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%son&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有名字以 “son” 结尾的员工的信息。</p>
<ol>
<li>匹配包含指定字符的字符串</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%Tom%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有名字中包含 “Tom” 的员工的信息。</p>
<ol>
<li>匹配指定长度的字符串</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;___&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上示例将返回所有名字长度为 3 的员工的信息。</p>
<blockquote>
<p>需要注意的是，使用 LIKE<br>运算符进行模糊查询可能会影响查询性能，特别是在处理大量数据时。因此，在使用<br>LIKE 运算符时，应尽量减少使用通配符，以提高查询效率。</p>
</blockquote>
<h2 id="实例-6"><a href="#实例-6" class="headerlink" title="实例"></a>实例</h2><p>以下是创建一个包含一些员工姓名的示例表<br><code>employees</code>，并向其中插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name) <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;Tom Smith&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Peter Johnson&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;John Doe&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Alice Thompson&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Sara Williams&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Mark Brown&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Bob Lee&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>现在我们可以使用 <code>LIKE</code> 运算符来查询表中的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询以 &quot;Tom&quot; 开头的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;Tom%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询名字中包含 &quot;Williams&quot; 的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%Williams%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询名字以 &quot;son&quot; 结尾的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;%son&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询名字长度为 8 的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;________&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>以上查询将分别返回满足条件的数据。需要注意的是，使用通配符的查询可能会导致性能问题，因此应尽量避免过度使用通配符。</p>
<h1 id="MySQL聚合函数"><a href="#MySQL聚合函数" class="headerlink" title="MySQL聚合函数"></a>MySQL聚合函数</h1><pre><code>CREATE TABLE employees (
  id INT PRIMARY KEY AUTO_INCREMENT,
  name VARCHAR(50) NOT NULL,
  email VARCHAR(50) NOT NULL,
  age INT NOT NULL,
  salary INT NOT NULL
);

INSERT INTO employees (name, email, age, salary)
VALUES
  (&#39;John Smith&#39;, &#39;john.smith@example.com&#39;, 28, FLOOR(RAND() * 10000)),
  (&#39;Jane Doe&#39;, &#39;jane.doe@example.com&#39;, 35, FLOOR(RAND() * 10000)),
  (&#39;Bob Johnson&#39;, &#39;bob.johnson@example.com&#39;, 42, FLOOR(RAND() * 10000)),
  (&#39;Mary Williams&#39;, &#39;mary.williams@example.com&#39;, 23, FLOOR(RAND() * 10000)),
  (&#39;David Brown&#39;, &#39;david.brown@example.com&#39;, 31, FLOOR(RAND() * 10000)),
  (&#39;Sarah Davis&#39;, &#39;sarah.davis@example.com&#39;, 46, FLOOR(RAND() * 10000)),
  (&#39;Paul Wilson&#39;, &#39;paul.wilson@example.com&#39;, 29, FLOOR(RAND() * 10000)),
  (&#39;Lisa Jackson&#39;, &#39;lisa.jackson@example.com&#39;, 38, FLOOR(RAND() * 10000)),
  (&#39;Michael Lee&#39;, &#39;michael.lee@example.com&#39;, 27, FLOOR(RAND() * 10000)),
  (&#39;Jennifer Perez&#39;, &#39;jennifer.perez@example.com&#39;, 33, FLOOR(RAND() * 10000)),
  (&#39;James Garcia&#39;, &#39;james.garcia@example.com&#39;, 44, FLOOR(RAND() * 10000)),
  (&#39;Elizabeth Rodriguez&#39;, &#39;elizabeth.rodriguez@example.com&#39;, 25, FLOOR(RAND() * 10000)),
  (&#39;Charles Hernandez&#39;, &#39;charles.hernandez@example.com&#39;, 39, FLOOR(RAND() * 10000)),
  (&#39;Jessica King&#39;, &#39;jessica.king@example.com&#39;, 30, FLOOR(RAND() * 10000)),
  (&#39;Anthony Wright&#39;, &#39;anthony.wright@example.com&#39;, 36, FLOOR(RAND() * 10000)),
  (&#39;Melissa Scott&#39;, &#39;melissa.scott@example.com&#39;, 41, FLOOR(RAND() * 10000)),
  (&#39;Kevin Green&#39;, &#39;kevin.green@example.com&#39;, 26, FLOOR(RAND() * 10000)),
  (&#39;Amanda Baker&#39;, &#39;amanda.baker@example.com&#39;, 37, FLOOR(RAND() * 10000)),
  (&#39;Richard Adams&#39;, &#39;richard.adams@example.com&#39;, 32, FLOOR(RAND() * 10000)),
  (&#39;Christina Carter&#39;, &#39;christina.carter@example.com&#39;, 43, FLOOR(RAND() * 10000)),
  (&#39;Daniel Lewis&#39;, &#39;daniel.lewis@example.com&#39;, 34, FLOOR(RAND() * 10000));
</code></pre>
<p>在 MySQL<br>中，聚合函数用于在查询中对一组数据进行计算并返回单个结果。下面是 MySQL<br>支持的一些常见聚合函数：</p>
<ul>
<li><code>COUNT()</code>：计算行数或非空值的数量。</li>
<li><code>SUM()</code>：计算数值列的总和。</li>
<li><code>AVG()</code>：计算数值列的平均值。</li>
<li><code>MAX()</code>：返回数值列中的最大值。</li>
<li><code>MIN()</code>：返回数值列中的最小值。</li>
</ul>
<p>下面是一些使用聚合函数的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 计算 employees 表中员工的总数</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算 employees 表中薪水的总和</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 计算 employees 表中薪水的平均值</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 找到 employees 表中薪水最高的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> employees);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 找到 employees 表中薪水最低的员工</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> employees);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要注意的是，聚合函数通常是与 <code>GROUP BY</code><br>子句一起使用的，以对每个分组计算结果。例如，以下查询将返回每个部门的员工数量：</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department, <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees <span class="keyword">GROUP</span> <span class="keyword">BY</span> department;</span><br></pre></td></tr></table></figure>

<h1 id="MySQL分组查询"><a href="#MySQL分组查询" class="headerlink" title="MySQL分组查询"></a>MySQL分组查询</h1><p>在 MySQL 中，<code>GROUP BY</code><br>子句用于将结果集按照一个或多个列进行分组，并对每个分组应用一个聚合函数，从而计算每个分组的汇总信息。</p>
<p>以下是一个使用 <code>GROUP BY</code> 的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department, <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees <span class="keyword">GROUP</span> <span class="keyword">BY</span> department;</span><br></pre></td></tr></table></figure>

<p>该查询将返回每个部门的平均工资。<code>GROUP BY</code> 子句按照 <code>department</code><br>列进行分组，然后对每个分组使用 <code>AVG()</code> 聚合函数计算平均工资。</p>
<blockquote>
<p>需要注意的是，<code>GROUP BY</code> 子句必须出现在 <code>SELECT</code><br>语句中的聚合函数之后，而且查询中不能使用未在 <code>GROUP BY</code><br>子句或聚合函数中的列。如果需要对分组进行过滤，可以使用 <code>HAVING</code> 子句。</p>
</blockquote>
<p>以下是一个带有 <code>HAVING</code> 子句的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department, <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees <span class="keyword">GROUP</span> <span class="keyword">BY</span> department <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary) <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>该查询将返回平均工资大于 5000 的部门，<code>HAVING</code> 子句使用了 <code>AVG()</code><br>聚合函数。</p>
<h2 id="实例-7"><a href="#实例-7" class="headerlink" title="实例"></a>实例</h2><p>以下是一个创建员工表的示例 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  department <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  salary <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以使用以下 SQL 语句向员工表中插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">5000.00</span>),</span><br><span class="line">  (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">6000.00</span>),</span><br><span class="line">  (<span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">4500.00</span>),</span><br><span class="line">  (<span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">5500.00</span>),</span><br><span class="line">  (<span class="string">&#x27;Eve&#x27;</span>, <span class="string">&#x27;Engineering&#x27;</span>, <span class="number">7000.00</span>),</span><br><span class="line">  (<span class="string">&#x27;Frank&#x27;</span>, <span class="string">&#x27;Engineering&#x27;</span>, <span class="number">8000.00</span>);</span><br></pre></td></tr></table></figure>

<p>这样就有了一些示例数据，可以用来测试分组查询。例如，我们可以使用以下 SQL<br>语句计算每个部门的平均工资：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> department, <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees <span class="keyword">GROUP</span> <span class="keyword">BY</span> department;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department, <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees <span class="keyword">GROUP</span> <span class="keyword">BY</span> department <span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary) <span class="operator">&gt;</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>运行该查询后，将会得到以下结果：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">+</span><span class="comment">-------------+-------------+</span></span><br><span class="line"><span class="operator">|</span> department  <span class="operator">|</span> <span class="built_in">AVG</span>(salary) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+-------------+</span></span><br><span class="line"><span class="operator">|</span> Engineering <span class="operator">|</span> <span class="number">7500.000000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Marketing   <span class="operator">|</span> <span class="number">5500.000000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> Sales       <span class="operator">|</span> <span class="number">5000.000000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+-------------+</span></span><br></pre></td></tr></table></figure>

<h1 id="MySQL子查询"><a href="#MySQL子查询" class="headerlink" title="MySQL子查询"></a>MySQL子查询</h1><p>MySQL 子查询是指一个 SQL 语句中嵌入另一个 SQL 语句，这个嵌入的 SQL<br>语句称为子查询，它用来为主查询提供数据。</p>
<p>子查询可以嵌套到 SELECT、FROM、WHERE<br>等子句中，以便从嵌套的子查询中获取数据，然后将其传递给主查询。</p>
<p>下面是一个使用子查询的示例，它使用子查询查找工资高于平均工资的员工：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> (<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees);</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，子查询 <code>(SELECT AVG(salary) FROM employees)</code><br>返回了员工表中所有员工的平均工资，主查询则选择了工资高于平均工资的员工，并返回了这些员工的姓名和工资。</p>
<p>子查询可以使用各种运算符和函数，例如 EXISTS、IN、ANY、ALL、MAX、MIN<br>等等，以及联合查询、交叉查询等高级查询技术，可以极大地扩展 SQL<br>查询的功能和灵活性。</p>
<h2 id="实例-8"><a href="#实例-8" class="headerlink" title="实例"></a>实例</h2><p>我们可以使用以下语句来创建一个示例表 <code>students</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  age <span class="type">INT</span>,</span><br><span class="line">  grade <span class="type">VARCHAR</span>(<span class="number">10</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, name, age, grade)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Alice&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;A&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;B&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;C&#x27;</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;David&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;A&#x27;</span>),</span><br><span class="line">       (<span class="number">5</span>, <span class="string">&#x27;Ella&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;B&#x27;</span>),</span><br><span class="line">       (<span class="number">6</span>, <span class="string">&#x27;Frank&#x27;</span>, <span class="number">20</span>, <span class="string">&#x27;C&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>这个表包含了学生的<br>ID、姓名、年龄和等级信息。我们可以使用子查询来查找年龄最大的学生：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name, age</span><br><span class="line"><span class="keyword">FROM</span> students</span><br><span class="line"><span class="keyword">WHERE</span> age <span class="operator">=</span> (<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(age) <span class="keyword">FROM</span> students);</span><br></pre></td></tr></table></figure>

<p>这个查询会返回年龄最大的学生的姓名和年龄。子查询<br><code>(SELECT MAX(age) FROM students)</code> 返回了 <code>students</code><br>表中所有学生的最大年龄，主查询则选择了年龄等于这个最大值的学生，并返回了这些学生的姓名和年龄。</p>
<h1 id="MySQL联合查询"><a href="#MySQL联合查询" class="headerlink" title="MySQL联合查询"></a>MySQL联合查询</h1><p>MySQL 中的联合查询是指将多个 <code>SELECT</code><br>查询语句的结果组合在一起，形成一个新的结果集。联合查询通常用于需要合并多个数据源的情况，或者需要从不同的表中检索相关数据的情况。</p>
<p>联合查询使用 <code>UNION</code> 关键字连接多个 <code>SELECT</code> 查询语句。联合查询要求每个<br><code>SELECT</code><br>查询语句返回相同数量和类型的列，列的顺序也必须相同。例如，假设有两个表<br><code>table1</code> 和 <code>table2</code>，它们包含相同数量和类型的列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1, col2, col3 <span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> col1, col2, col3 <span class="keyword">FROM</span> table2;</span><br></pre></td></tr></table></figure>

<p>这个联合查询会将 <code>table1</code> 和 <code>table2</code><br>的查询结果合并在一起，生成一个新的结果集。如果 <code>table1</code> 和 <code>table2</code><br>中有相同的行，联合查询会自动去除重复的行。如果需要包括所有行（包括重复的行），可以使用<br><code>UNION ALL</code> 关键字。</p>
<p>需要注意的是，联合查询的每个 <code>SELECT</code> 查询语句可以包含任意的 <code>SELECT</code><br>子句、<code>WHERE</code> 子句、<code>GROUP BY</code> 子句、<code>HAVING</code> 子句和 <code>ORDER BY</code><br>子句。例如，可以在联合查询中使用以下语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col1, col2 <span class="keyword">FROM</span> table1 <span class="keyword">WHERE</span> col3 <span class="operator">&gt;</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> col1, col2 <span class="keyword">FROM</span> table2 <span class="keyword">WHERE</span> col3 <span class="operator">&gt;</span> <span class="number">10</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col1 <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<p>这个联合查询会先从 <code>table1</code> 和 <code>table2</code> 中选择所有 <code>col3</code> 大于 10<br>的行，然后将它们合并在一起，并按照 <code>col1</code> 的升序排列结果集。</p>
<h2 id="实例-9"><a href="#实例-9" class="headerlink" title="实例"></a>实例</h2><p>假设有两个表 <code>employees</code> 和 <code>customers</code>，它们包含以下数据：</p>
<p>employees 表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    emp_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    department <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    salary <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (emp_id, first_name, last_name, department, salary) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">5000</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="string">&#x27;HR&#x27;</span>, <span class="number">6000</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Lee&#x27;</span>, <span class="string">&#x27;IT&#x27;</span>, <span class="number">5500</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="string">&#x27;Johnson&#x27;</span>, <span class="string">&#x27;Finance&#x27;</span>, <span class="number">7000</span>);</span><br></pre></td></tr></table></figure>

<p>customers 表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    cust_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (cust_id, first_name, last_name, email, phone) </span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Cooper&#x27;</span>, <span class="string">&#x27;alice.cooper@example.com&#x27;</span>, <span class="string">&#x27;555-123-4567&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Dylan&#x27;</span>, <span class="string">&#x27;bob.dylan@example.com&#x27;</span>, <span class="string">&#x27;555-234-5678&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Parker&#x27;</span>, <span class="string">&#x27;charlie.parker@example.com&#x27;</span>, <span class="string">&#x27;555-345-6789&#x27;</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;Dave&#x27;</span>, <span class="string">&#x27;Matthews&#x27;</span>, <span class="string">&#x27;dave.matthews@example.com&#x27;</span>, <span class="string">&#x27;555-456-7890&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>可以使用联合查询将这两个表中的数据合并在一起。例如，可以使用以下 SQL<br>语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> emp_id, first_name, last_name, department, salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> cust_id, first_name, last_name, <span class="keyword">NULL</span> <span class="keyword">AS</span> department, <span class="keyword">NULL</span> <span class="keyword">AS</span> salary</span><br><span class="line"><span class="keyword">FROM</span> customers;</span><br></pre></td></tr></table></figure>

<p>这个联合查询将 <code>employees</code> 和 <code>customers</code><br>表的查询结果合并在一起，生成一个新的结果集。如果 <code>employees</code> 和<br><code>customers</code><br>中有相同的行，联合查询会自动去除重复的行。如果需要包括所有行（包括重复的行），可以使用<br><code>UNION ALL</code> 关键字。</p>
<p>在上述查询中，<code>customers</code> 表没有部门和薪水信息，因此使用 <code>NULL</code><br>值填充这两列。结果集如下：</p>
<p>  emp_id   first_name   last_name   department   salary</p>
<hr>
<p>  1        John         Doe         Sales        5000<br>  2        Jane         Smith       HR           6000<br>  3        David        Lee         IT           5500<br>  4        Mary         Johnson     Finance      7000<br>  1        Alice        Cooper      NULL         NULL<br>  2        Bob          Dylan       NULL         NULL<br>  3        Charlie      Parker      NULL         NULL<br>  4        Dave         Matthews    NULL         NULL</p>
<h1 id="MySQL连接查询-左连接"><a href="#MySQL连接查询-左连接" class="headerlink" title="MySQL连接查询-左连接"></a>MySQL连接查询-左连接</h1><h2 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h2><p>在MySQL中，连接查询（join）是一种通过将两个或多个表中的行组合在一起的查询方式。连接查询可以帮助我们从多个表中获取数据，使我们能够更有效地组织和分析数据。</p>
<p>MySQL支持不同类型的连接查询，包括内连接（inner join）、左连接（left<br>join）、右连接（right join）和全外连接（full outer<br>join）。这些不同的连接方式会返回不同的数据集，可以根据需求选择不同的连接方式。</p>
<h2 id="左连接查询"><a href="#左连接查询" class="headerlink" title="左连接查询"></a>左连接查询</h2><p>在MySQL中，左连接（left<br>join）是一种查询两个或多个表的方式，它返回左边表中的所有行，并且返回右边表中与左边表中的行匹配的行。如果右表中没有与左表中的行匹配的行，则返回NULL值。</p>
<p>下面是一个使用左连接的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，表1是左表，表2是右表。它会返回表1中的所有行，即使没有与表2中的行匹配的行。如果表2中没有与表1中的行匹配的行，则返回NULL值。</p>
<p>请注意，左连接可以用来查找一个表中的所有行，即使在另一个表中没有匹配的行。这对于查找不完整的数据非常有用，或者需要获取所有的数据而不是仅仅匹配的数据。</p>
<h2 id="实例-10"><a href="#实例-10" class="headerlink" title="实例"></a>实例</h2><p>为了验证MySQL的左连接查询，我们需要先准备一些数据，并创建两个表。假设我们有两个表，一个是顾客表（customers），另一个是订单表（orders）。我们可以使用以下的SQL语句创建这两个表，并初始化一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    customer_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    quantity <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (customer_id, name, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Bob Johnson&#x27;</span>, <span class="string">&#x27;bob.johnson@example.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, product_name, quantity)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>

<hr>
<p>  customer_id   name      email</p>
<hr>
<p>  1             John      <a href="mailto:&#x6a;&#x6f;&#x68;&#x6e;&#46;&#x73;&#x6d;&#105;&#116;&#104;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#99;&#x6f;&#x6d;">&#x6a;&#x6f;&#x68;&#x6e;&#46;&#x73;&#x6d;&#105;&#116;&#104;&#64;&#x65;&#120;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#99;&#x6f;&#x6d;</a><br>                Smith     </p>
<p>  2             Jane Doe  <a href="mailto:&#x6a;&#x61;&#x6e;&#101;&#x2e;&#100;&#111;&#101;&#x40;&#x65;&#x78;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#x6d;">&#x6a;&#x61;&#x6e;&#101;&#x2e;&#100;&#111;&#101;&#x40;&#x65;&#x78;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#x6d;</a></p>
<h2 id="3-Bob-x62-x6f-x62-x2e-x6a-111-104-110-115-111-110-x40-101-x78-x61-109-x70-x6c-101-46-x63-x6f-109-Johnson"><a href="#3-Bob-x62-x6f-x62-x2e-x6a-111-104-110-115-111-110-x40-101-x78-x61-109-x70-x6c-101-46-x63-x6f-109-Johnson" class="headerlink" title="  3             Bob       &#x62;&#x6f;&#x62;&#x2e;&#x6a;&#111;&#104;&#110;&#115;&#111;&#110;&#x40;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#101;&#46;&#x63;&#x6f;&#109;                Johnson   "></a>  3             Bob       <a href="mailto:&#x62;&#x6f;&#x62;&#x2e;&#x6a;&#111;&#104;&#110;&#115;&#111;&#110;&#x40;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#101;&#46;&#x63;&#x6f;&#109;">&#x62;&#x6f;&#x62;&#x2e;&#x6a;&#111;&#104;&#110;&#115;&#111;&#110;&#x40;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#101;&#46;&#x63;&#x6f;&#109;</a><br>                Johnson   </h2><p>  order_id   customer_id   product_name   quantity</p>
<hr>
<p>  1          1             Product A      2<br>  2          2             Product B      1<br>  3          1             Product C      4</p>
<p>以上SQL语句创建了两个表，并插入了一些示例数据。现在我们可以使用左连接查询来查找每个客户及其订单，即使客户没有订单也可以显示出来。以下是使用左连接的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> customers.name, orders.product_name, orders.quantity</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> orders</span><br><span class="line"><span class="keyword">ON</span> customers.customer_id <span class="operator">=</span> orders.customer_id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了LEFT<br>JOIN来将两个表连接起来。左表是customers表，右表是orders表。我们在ON子句中使用了customer_id列作为连接条件。这个查询会返回所有客户的信息，即使他们没有订单，也会显示出来。如果客户没有订单，orders表中的字段将会是NULL值。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的左连接查询了。</p>
<h1 id="MySQL连接查询-右连接"><a href="#MySQL连接查询-右连接" class="headerlink" title="MySQL连接查询-右连接"></a>MySQL连接查询-右连接</h1><p>在MySQL中，右连接（right<br>join）是一种连接查询，它返回右边表中的所有行，并且返回左边表中与右边表中的行匹配的行。如果左表中没有与右表中的行匹配的行，则返回NULL值。</p>
<p>以下是一个使用右连接的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，表1是左表，表2是右表。它会返回表2中的所有行，即使没有与表1中的行匹配的行。如果表1中没有与表2中的行匹配的行，则返回NULL值。</p>
<p>需要注意的是，虽然使用右连接和左连接可以返回不同的结果集，但是它们是等价的。也就是说，使用右连接可以得到与左连接相同的结果集，只要交换左表和右表的位置，并把连接条件从ON子句中移到WHERE子句中。</p>
<p>下面是一个使用WHERE子句实现右连接的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table2</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> table1</span><br><span class="line"><span class="keyword">ON</span> table2.id <span class="operator">=</span> table1.id</span><br><span class="line"><span class="keyword">WHERE</span> table1.id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们首先使用右连接将表2和表1连接起来，然后将连接条件从ON子句中移到WHERE子句中，并将条件反转。最后，我们使用IS<br>NULL操作符来筛选出在左表中没有匹配的行，即返回右表中所有没有匹配行的结果。这个查询将返回与左连接相同的结果集。</p>
<h2 id="实例-11"><a href="#实例-11" class="headerlink" title="实例"></a>实例</h2><p>为了验证MySQL的右连接查询，我们需要先准备一些数据，并创建两个表。假设我们有两个表，一个是订单表（orders），另一个是客户表（customers）。我们可以使用以下的SQL语句创建这两个表，并初始化一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    quantity <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    customer_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, product_name, quantity)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">4</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="number">3</span>, <span class="string">&#x27;Product D&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (customer_id, name, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;Mike Johnson&#x27;</span>, <span class="string">&#x27;mike.johnson@example.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<hr>
<p>  customer_id   name       email</p>
<hr>
<p>  1             John Smith <a href="mailto:&#106;&#x6f;&#x68;&#110;&#x2e;&#115;&#x6d;&#x69;&#116;&#104;&#64;&#101;&#120;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#99;&#x6f;&#109;">&#106;&#x6f;&#x68;&#110;&#x2e;&#115;&#x6d;&#x69;&#116;&#104;&#64;&#101;&#120;&#x61;&#109;&#112;&#108;&#x65;&#x2e;&#99;&#x6f;&#109;</a></p>
<p>  2             Jane Doe   <a href="mailto:&#106;&#x61;&#x6e;&#101;&#x2e;&#x64;&#x6f;&#x65;&#64;&#101;&#120;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#99;&#111;&#109;">&#106;&#x61;&#x6e;&#101;&#x2e;&#x64;&#x6f;&#x65;&#64;&#101;&#120;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#99;&#111;&#109;</a></p>
<h2 id="4-Mike-x6d-x69-107-101-46-x6a-x6f-x68-x6e-115-x6f-x6e-64-101-x78-x61-109-x70-x6c-x65-46-x63-x6f-109-Johnson"><a href="#4-Mike-x6d-x69-107-101-46-x6a-x6f-x68-x6e-115-x6f-x6e-64-101-x78-x61-109-x70-x6c-x65-46-x63-x6f-109-Johnson" class="headerlink" title="  4             Mike       &#x6d;&#x69;&#107;&#101;&#46;&#x6a;&#x6f;&#x68;&#x6e;&#115;&#x6f;&#x6e;&#64;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#x65;&#46;&#x63;&#x6f;&#109;                Johnson    "></a>  4             Mike       <a href="mailto:&#x6d;&#x69;&#107;&#101;&#46;&#x6a;&#x6f;&#x68;&#x6e;&#115;&#x6f;&#x6e;&#64;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#x65;&#46;&#x63;&#x6f;&#109;">&#x6d;&#x69;&#107;&#101;&#46;&#x6a;&#x6f;&#x68;&#x6e;&#115;&#x6f;&#x6e;&#64;&#101;&#x78;&#x61;&#109;&#x70;&#x6c;&#x65;&#46;&#x63;&#x6f;&#109;</a><br>                Johnson    </h2><p>  order_id   customer_id   product_name   quantity</p>
<hr>
<p>  1          1             Product A      2<br>  2          2             Product B      1<br>  3          1             Product C      4<br>  4          3             Product D      3</p>
<p>以上SQL语句创建了两个表，并插入了一些示例数据。现在我们可以使用右连接查询来查找每个客户及其订单，即使没有订单也可以显示出来。以下是使用右连接的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span></span><br><span class="line">    orders.product_name,</span><br><span class="line">    orders.quantity,</span><br><span class="line">    customers.name</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">    customers</span><br><span class="line"><span class="keyword">right</span> <span class="keyword">join</span> orders</span><br><span class="line"><span class="keyword">on</span></span><br><span class="line">    orders.customer_id <span class="operator">=</span> customers.customer_id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了RIGHT<br>JOIN来将两个表连接起来。右表是customers表，左表是orders表。我们在ON子句中使用<code>customer_id</code>列作为连接条件。这个查询会返回所有客户的信息，即使他们没有订单，也会显示出来。如果客户没有订单，orders表中的字段将会是NULL值。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的右连接查询了。</p>
<h1 id="MySQL连接查询-全连接"><a href="#MySQL连接查询-全连接" class="headerlink" title="MySQL连接查询-全连接"></a>MySQL连接查询-全连接</h1><p>在MySQL中，全连接（full<br>join）是一种连接查询，它返回左右两个表中所有的行，如果两个表中的行没有匹配，则返回NULL值。</p>
<p>MySQL中并没有提供FULL JOIN关键字，但是我们可以使用LEFT<br>JOIN和UNION操作符来实现FULL JOIN。具体地，我们可以使用LEFT<br>JOIN将左表和右表连接起来，并使用UNION操作符将右表中不在左表中的行连接起来，得到所有行。以下是使用LEFT<br>JOIN和UNION实现FULL JOIN的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id</span><br><span class="line"><span class="keyword">WHERE</span> table1.id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们首先使用LEFT<br>JOIN将表1和表2连接起来，并得到匹配的行。然后，我们使用UNION操作符将表2中不在表1中的行连接起来。最后，我们使用RIGHT<br>JOIN将表2和表1连接起来，并得到表1中不在表2中的行，并使用WHERE子句将这些行筛选出来。这个查询会返回所有行，包括两个表中的所有行。如果两个表中的行没有匹配，则会返回NULL值。</p>
<p>需要注意的是，由于FULL JOIN并不是MySQL原生支持的，这种实现FULL<br>JOIN的方法可能不是最高效的，因此在处理大数据量的查询时，可能需要采用其他的方法来实现FULL<br>JOIN。</p>
<h2 id="实例-12"><a href="#实例-12" class="headerlink" title="实例"></a>实例</h2><p>为了验证MySQL的全连接查询，我们需要先准备一些数据，并创建两个表。假设我们有两个表，一个是订单表（orders），另一个是客户表（customers）。我们可以使用以下的SQL语句创建这两个表，并初始化一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    quantity <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    customer_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, product_name, quantity)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">4</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="number">3</span>, <span class="string">&#x27;Product D&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (customer_id, name, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;Mike Johnson&#x27;</span>, <span class="string">&#x27;mike.johnson@example.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了两个表，并插入了一些示例数据。现在我们可以使用全连接查询来查找每个客户及其订单，即使没有订单也可以显示出来。以下是使用全连接的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> customers.name, orders.product_name, orders.quantity</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> customers</span><br><span class="line"><span class="keyword">ON</span> orders.customer_id <span class="operator">=</span> customers.customer_id</span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> customers.name, orders.product_name, orders.quantity</span><br><span class="line"><span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> customers</span><br><span class="line"><span class="keyword">ON</span> orders.customer_id <span class="operator">=</span> customers.customer_id</span><br><span class="line"><span class="keyword">WHERE</span> orders.customer_id <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了LEFT JOIN和RIGHT<br>JOIN，以实现全连接。我们在ON子句中使用customer_id列作为连接条件。这个查询会返回所有客户的信息，即使他们没有订单，也会显示出来。如果客户没有订单，orders表中的字段将会是NULL值。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的全连接查询了。</p>
<h1 id="MySQL连接查询-内连接"><a href="#MySQL连接查询-内连接" class="headerlink" title="MySQL连接查询-内连接"></a>MySQL连接查询-内连接</h1><p>在MySQL中，内连接（inner<br>join）是一种连接查询，它只返回左右两个表中匹配的行。内连接可以使用JOIN关键字或INNER<br>JOIN关键字实现。以下是使用JOIN关键字实现内连接的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用JOIN关键字将表1和表2连接起来，并使用ON子句指定连接条件。这个查询会返回两个表中匹配的行，如果两个表中的行没有匹配，则不会返回。</p>
<p>我们还可以使用INNER JOIN关键字来实现内连接。以下是使用INNER<br>JOIN关键字实现内连接的示例查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> table1</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> table2</span><br><span class="line"><span class="keyword">ON</span> table1.id <span class="operator">=</span> table2.id;</span><br></pre></td></tr></table></figure>

<p>这个查询和使用JOIN关键字实现内连接的查询效果是一样的，只不过使用了INNER<br>JOIN关键字而已。</p>
<p>需要注意的是，内连接只返回匹配的行，而不返回没有匹配的行。如果你需要返回所有行，包括没有匹配的行，可以考虑使用外连接（outer<br>join），包括左外连接（left join）、右外连接（right join）和全连接（full<br>join）等。</p>
<h2 id="实例-13"><a href="#实例-13" class="headerlink" title="实例"></a>实例</h2><p>为了验证MySQL的内连接查询，我们需要先准备一些数据，并创建两个表。假设我们有两个表，一个是订单表（orders），另一个是客户表（customers）。我们可以使用以下的SQL语句创建这两个表，并初始化一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    quantity <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    customer_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, product_name, quantity)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">2</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">4</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="number">3</span>, <span class="string">&#x27;Product D&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (customer_id, name, email)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John Smith&#x27;</span>, <span class="string">&#x27;john.smith@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane Doe&#x27;</span>, <span class="string">&#x27;jane.doe@example.com&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Mike Johnson&#x27;</span>, <span class="string">&#x27;mike.johnson@example.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了两个表，并插入了一些示例数据。现在我们可以使用内连接查询来查找客户及其订单。以下是使用内连接的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> customers.name, orders.product_name, orders.quantity</span><br><span class="line"><span class="keyword">FROM</span> customers</span><br><span class="line"><span class="keyword">JOIN</span> orders</span><br><span class="line"><span class="keyword">ON</span> customers.customer_id <span class="operator">=</span> orders.customer_id;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用JOIN关键字和ON子句指定了连接条件。这个查询会返回所有匹配的行，也就是每个客户和他们的订单信息。如果一个客户没有订单，他不会被包含在结果集中。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的内连接查询了。</p>
<h1 id="MySQL函数"><a href="#MySQL函数" class="headerlink" title="MySQL函数"></a>MySQL函数</h1><p>MySQL函数可以分为以下几类：</p>
<ol>
<li>聚合函数：聚合函数对一组值进行计算，并返回单个值作为结果。这些函数包括COUNT、SUM、AVG、MAX和MIN等。</li>
<li>数学函数：数学函数对数字值进行计算，例如ABS、CEIL、FLOOR、ROUND和TRUNCATE等。</li>
<li>字符串函数：字符串函数对字符串进行操作，例如CONCAT、SUBSTR、LENGTH、LOWER和UPPER等。</li>
<li>日期和时间函数：日期和时间函数对日期和时间值进行计算和操作，例如NOW、DATE、YEAR、MONTH、DAY、HOUR、MINUTE和SECOND等。</li>
<li>逻辑函数：逻辑函数用于执行逻辑运算，例如AND、OR和NOT等。</li>
<li>条件函数：条件函数用于根据指定的条件返回不同的结果，例如IF、CASE和COALESCE等。</li>
<li>加密函数：加密函数用于对数据进行加密和解密，例如MD5、SHA1和AES_ENCRYPT等。</li>
<li>其他函数：其他函数包括流程控制函数、系统函数和用户自定义函数等。</li>
</ol>
<p>这些函数可以在MySQL中方便地进行调用和使用，可以使数据库操作更加高效和便捷。</p>
<h2 id="聚合函数实例"><a href="#聚合函数实例" class="headerlink" title="聚合函数实例"></a>聚合函数实例</h2><p>为了验证MySQL的聚合函数，我们需要准备一些数据，并创建一个表。以下是一个示例表orders，用于存储订单信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    quantity <span class="type">INT</span>,</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, product_name, quantity, price)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">2</span>, <span class="number">10.99</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">1</span>, <span class="number">5.99</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="number">1</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">4</span>, <span class="number">12.99</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="number">3</span>, <span class="string">&#x27;Product D&#x27;</span>, <span class="number">3</span>, <span class="number">7.50</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为orders的表，并插入了一些示例数据。现在我们可以使用聚合函数来计算订单信息的总数、平均价格、最高价格和最低价格。以下是使用聚合函数的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">AS</span> total_orders,</span><br><span class="line">       <span class="built_in">AVG</span>(price) <span class="keyword">AS</span> avg_price,</span><br><span class="line">       <span class="built_in">MAX</span>(price) <span class="keyword">AS</span> max_price,</span><br><span class="line">       <span class="built_in">MIN</span>(price) <span class="keyword">AS</span> min_price</span><br><span class="line"><span class="keyword">FROM</span> orders;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了聚合函数COUNT、AVG、MAX和MIN来计算总订单数、平均价格、最高价格和最低价格。使用AS关键字给计算结果取了别名，可以使查询结果更加易读和直观。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的聚合函数了。</p>
<h2 id="字符串函数实例"><a href="#字符串函数实例" class="headerlink" title="字符串函数实例"></a>字符串函数实例</h2><p>为了验证MySQL的字符串函数，我们需要准备一些数据，并创建一个表。以下是一个示例表students，用于存储学生信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">    student_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (student_id, first_name, last_name, email, phone)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;johndoe@example.com&#x27;</span>, <span class="string">&#x27;555-1234&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="string">&#x27;janesmith@example.com&#x27;</span>, <span class="string">&#x27;555-5678&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Johnson&#x27;</span>, <span class="string">&#x27;bjohnson@example.com&#x27;</span>, <span class="string">&#x27;555-9012&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为students的表，并插入了一些示例数据。现在我们可以使用字符串函数来操作学生信息的姓名、电子邮件和电话号码。以下是使用字符串函数的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> CONCAT(first_name, <span class="string">&#x27; &#x27;</span>, last_name) <span class="keyword">AS</span> full_name,</span><br><span class="line">       <span class="built_in">UPPER</span>(email) <span class="keyword">AS</span> upper_email,</span><br><span class="line">       SUBSTR(phone, <span class="number">1</span>, <span class="number">3</span>) <span class="keyword">AS</span> phone_prefix</span><br><span class="line"><span class="keyword">FROM</span> students;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了字符串函数CONCAT、UPPER和SUBSTR来操作学生信息的姓名、电子邮件和电话号码。使用AS关键字给计算结果取了别名，可以使查询结果更加易读和直观。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的字符串函数了。</p>
<h2 id="日期时间函数实例"><a href="#日期时间函数实例" class="headerlink" title="日期时间函数实例"></a>日期时间函数实例</h2><p>为了验证MySQL的日期时间函数，我们需要准备一些数据，并创建一个表。以下是一个示例表employees，用于存储员工信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    employee_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    hire_date <span class="type">DATE</span>,</span><br><span class="line">    salary <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (employee_id, first_name, last_name, hire_date, salary)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;2020-01-01&#x27;</span>, <span class="number">50000.00</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="string">&#x27;2019-05-15&#x27;</span>, <span class="number">60000.00</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Johnson&#x27;</span>, <span class="string">&#x27;2018-03-01&#x27;</span>, <span class="number">70000.00</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为employees的表，并插入了一些示例数据。现在我们可以使用日期时间函数来操作员工信息的入职日期和工资。以下是使用日期时间函数的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(hire_date, <span class="string">&#x27;%Y-%m-%d&#x27;</span>) <span class="keyword">AS</span> formatted_date,</span><br><span class="line">       <span class="keyword">YEAR</span>(hire_date) <span class="keyword">AS</span> hire_year,</span><br><span class="line">       <span class="keyword">MONTH</span>(hire_date) <span class="keyword">AS</span> hire_month,</span><br><span class="line">       <span class="keyword">DAY</span>(hire_date) <span class="keyword">AS</span> hire_day,</span><br><span class="line">       salary <span class="operator">*</span> <span class="number">12</span> <span class="keyword">AS</span> annual_salary</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了日期时间函数DATE_FORMAT、YEAR、MONTH和DAY来操作员工信息的入职日期和工资。使用AS关键字给计算结果取了别名，可以使查询结果更加易读和直观。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的日期时间函数了。</p>
<h2 id="逻辑函数实例"><a href="#逻辑函数实例" class="headerlink" title="逻辑函数实例"></a>逻辑函数实例</h2><p>为了验证MySQL的逻辑函数，我们需要准备一些数据，并创建一个表。以下是一个示例表products，用于存储产品信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> products (</span><br><span class="line">    product_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    product_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    unit_price <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>),</span><br><span class="line">    in_stock <span class="type">BOOLEAN</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> products (product_id, product_name, unit_price, in_stock)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Product A&#x27;</span>, <span class="number">10.00</span>, <span class="literal">TRUE</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Product B&#x27;</span>, <span class="number">20.00</span>, <span class="literal">FALSE</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Product C&#x27;</span>, <span class="number">30.00</span>, <span class="literal">TRUE</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;Product D&#x27;</span>, <span class="number">40.00</span>, <span class="literal">FALSE</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为products的表，并插入了一些示例数据。现在我们可以使用逻辑函数来操作产品信息的库存状态。以下是使用逻辑函数的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> product_name,</span><br><span class="line">       IF(in_stock, <span class="string">&#x27;In stock&#x27;</span>, <span class="string">&#x27;Out of stock&#x27;</span>) <span class="keyword">AS</span> stock_status</span><br><span class="line"><span class="keyword">FROM</span> products;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了逻辑函数IF来操作产品信息的库存状态。使用AS关键字给计算结果取了别名，可以使查询结果更加易读和直观。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的逻辑函数了。</p>
<h2 id="条件函数实例"><a href="#条件函数实例" class="headerlink" title="条件函数实例"></a>条件函数实例</h2><p>为了验证MySQL的条件函数，我们需要准备一些数据，并创建一个表。以下是一个示例表students，用于存储学生信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">    student_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    gender <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    age <span class="type">INT</span>,</span><br><span class="line">    score <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (student_id, first_name, last_name, gender, age, score)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="number">18</span>, <span class="number">80.00</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>, <span class="number">19</span>, <span class="number">85.00</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Johnson&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="number">20</span>, <span class="number">90.00</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为students的表，并插入了一些示例数据。现在我们可以使用条件函数来操作学生信息的成绩情况。以下是使用条件函数的查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> first_name,</span><br><span class="line">       last_name,</span><br><span class="line">       <span class="keyword">CASE</span></span><br><span class="line">           <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">90</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">           <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">80</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">           <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">70</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">           <span class="keyword">ELSE</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">       <span class="keyword">END</span> <span class="keyword">AS</span> grade</span><br><span class="line"><span class="keyword">FROM</span> students;</span><br></pre></td></tr></table></figure>

<p>在这个查询中，我们使用了条件函数CASE来操作学生信息的成绩情况。使用AS关键字给计算结果取了别名，可以使查询结果更加易读和直观。</p>
<p>这样，我们就可以使用以上的数据和查询语句来验证MySQL的条件函数了。</p>
<h1 id="MySQL-DCL"><a href="#MySQL-DCL" class="headerlink" title="MySQL DCL"></a>MySQL DCL</h1><p>在MySQL中，DCL代表”数据控制语言”，用于控制和管理用户访问数据库的权限。DCL命令包括以下几个关键字：</p>
<ol>
<li>GRANT：用于向用户或用户组授予访问数据库的特定权限。</li>
<li>REVOKE：用于从用户或用户组中撤销访问数据库的特定权限。</li>
<li>DENY：用于拒绝用户或用户组访问数据库的特定权限。</li>
</ol>
<p>这些关键字可以用于控制用户访问数据库的权限，以确保数据库的安全性和完整性。以下是一些常用的DCL命令：</p>
<ol>
<li>GRANT SELECT ON database.* TO user@localhost;<br>&#x2F;&#x2F;授予用户在database数据库中查询数据的权限</li>
<li>REVOKE INSERT ON database.* FROM user@localhost;<br>&#x2F;&#x2F;从用户中撤销在database数据库中插入数据的权限</li>
<li>DENY DROP ON database.* TO user@localhost;<br>&#x2F;&#x2F;拒绝用户在database数据库中删除数据表的权限</li>
</ol>
<p>请注意，这些命令需要具有适当的特权和权限才能使用。只有具有管理员权限的用户才能授予、撤销和拒绝其他用户的访问权限。</p>
<h2 id="实例-14"><a href="#实例-14" class="headerlink" title="实例"></a>实例</h2><p>为了验证MySQL的DCL命令，我们需要准备一些数据并创建一个具有特定权限的用户。以下是一个示例数据库students，用于存储学生信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE students;</span><br><span class="line"></span><br><span class="line">USE students;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">    first_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    last_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    gender <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    age <span class="type">INT</span>,</span><br><span class="line">    score <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (first_name, last_name, gender, age, score)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="number">18</span>, <span class="number">80.00</span>),</span><br><span class="line">       (<span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;Smith&#x27;</span>, <span class="string">&#x27;Female&#x27;</span>, <span class="number">19</span>, <span class="number">85.00</span>),</span><br><span class="line">       (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Johnson&#x27;</span>, <span class="string">&#x27;Male&#x27;</span>, <span class="number">20</span>, <span class="number">90.00</span>);</span><br></pre></td></tr></table></figure>

<p>以上SQL语句创建了一个名为students的数据库和一个名为student的表，并插入了一些示例数据。现在我们需要创建一个新用户，并授予该用户对students数据库的查询权限。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;testuser&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;testpass&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> students.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;testuser&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们使用了CREATE<br>USER命令创建了一个名为testuser的新用户，并使用GRANT命令授予该用户对students数据库的查询权限。</p>
<p>现在我们可以尝试使用新创建的用户testuser连接到MySQL，并查询students数据库中的数据。以下是使用testuser用户进行查询的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql <span class="operator">-</span>u testuser <span class="operator">-</span>p</span><br></pre></td></tr></table></figure>

<p>在提示符中输入密码testpass，然后使用以下命令查询student表中的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> students.student;</span><br></pre></td></tr></table></figure>

<p>如果一切正常，testuser应该可以成功连接到MySQL，并查询students数据库中的数据。这个示例演示了如何使用DCL命令控制用户访问数据库的权限，以确保数据库的安全性和完整性。</p>
<h1 id="MySQL用户管理"><a href="#MySQL用户管理" class="headerlink" title="MySQL用户管理"></a>MySQL用户管理</h1><p>在MySQL中，可以使用以下命令来管理用户：</p>
<ol>
<li>创建用户</li>
</ol>
<p>要创建新用户，可以使用CREATE USER语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上述语句将创建一个名为username的用户，该用户只能从本地主机（localhost）登录，并设置了密码为password。您可以使用CREATE<br>USER创建任意数量的用户。</p>
<ol>
<li>删除用户</li>
</ol>
<p>要删除现有用户，可以使用DROP USER语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上述语句将从MySQL服务器中删除名为username的用户。</p>
<ol>
<li>授予权限</li>
</ol>
<p>要授予用户对特定数据库或表的访问权限，可以使用GRANT语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> permission <span class="keyword">ON</span> database.table <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上述语句将授予名为username的用户在数据库database中的table表上执行permission操作的权限。可以使用GRANT授予不同的权限，如SELECT、INSERT、UPDATE和DELETE等。</p>
<ol>
<li>撤销权限</li>
</ol>
<p>要从用户中撤销访问权限，可以使用REVOKE语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> permission <span class="keyword">ON</span> database.table <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上述语句将从名为username的用户中撤销在database数据库的table表上执行permission操作的权限。</p>
<ol>
<li>修改用户密码</li>
</ol>
<p>要更改现有用户的密码，可以使用SET PASSWORD语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;newpassword&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上述语句将更改名为username的用户的密码为newpassword。</p>
<ol>
<li>查看现有用户</li>
</ol>
<p>要查看MySQL服务器上的现有用户，可以使用SELECT语句从mysql.user表中检索用户信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">user</span>, host <span class="keyword">FROM</span> mysql.user;</span><br></pre></td></tr></table></figure>

<p>上述语句将返回MySQL服务器上所有用户的用户名和主机名。</p>
<p>总之，使用上述命令可以管理和控制MySQL用户的访问权限，并确保数据库的安全性和完整性。</p>
<h2 id="角色、用户、权限管理"><a href="#角色、用户、权限管理" class="headerlink" title="角色、用户、权限管理"></a>角色、用户、权限管理</h2><p>MySQL权限管理是控制MySQL用户对数据库、表、列等对象的访问权限的过程。MySQL提供了多种权限管理方法来保护数据库中的数据。</p>
<ol>
<li>角色管理</li>
</ol>
<p>MySQL<br>8.0引入了角色管理功能，通过角色来管理用户的权限。角色是一组权限的集合，可以将多个用户赋予同一个角色，简化了权限管理的复杂度。可以通过以下命令来创建和管理角色：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建角色</span></span><br><span class="line"><span class="keyword">CREATE</span> ROLE role_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除角色</span></span><br><span class="line"><span class="keyword">DROP</span> ROLE role_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 给角色授权</span></span><br><span class="line"><span class="keyword">GRANT</span> privilege <span class="keyword">ON</span> object <span class="keyword">TO</span> role_name;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 收回角色授权</span></span><br><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> object <span class="keyword">FROM</span> role_name;</span><br></pre></td></tr></table></figure>

<ol>
<li>用户管理</li>
</ol>
<p>MySQL允许创建多个用户，每个用户都有自己的用户名和密码。可以使用以下命令来创建和管理用户：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建用户</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 修改用户密码</span></span><br><span class="line"><span class="keyword">SET</span> PASSWORD <span class="keyword">FOR</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;newpassword&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除用户</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予权限</span></span><br><span class="line"><span class="keyword">GRANT</span> privilege <span class="keyword">ON</span> object <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 收回权限</span></span><br><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> object <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>数据库和表权限管理</li>
</ol>
<p>在MySQL中，可以将权限授予到数据库或表级别。以下是在数据库和表级别授予权限的命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 授予用户对数据库的访问权限</span></span><br><span class="line"><span class="keyword">GRANT</span> privilege <span class="keyword">ON</span> database_name.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 授予用户对表的访问权限</span></span><br><span class="line"><span class="keyword">GRANT</span> privilege <span class="keyword">ON</span> database_name.table_name <span class="keyword">TO</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 收回用户对数据库的访问权限</span></span><br><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> database_name.<span class="operator">*</span> <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 收回用户对表的访问权限</span></span><br><span class="line"><span class="keyword">REVOKE</span> privilege <span class="keyword">ON</span> database_name.table_name <span class="keyword">FROM</span> <span class="string">&#x27;username&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>数据访问控制</li>
</ol>
<p>MySQL提供了多种数据访问控制机制，如视图、存储过程、触发器、事件等，可以通过这些机制来控制对数据的访问。例如，可以使用视图来隐藏敏感数据，使用存储过程来限制对数据的修改。</p>
<p>总之，MySQL提供了多种权限管理和数据访问控制机制，以保护数据库中的数据。管理员可以根据实际需求来选择适合自己的权限管理方法和数据访问控制机制。</p>
<h2 id="实例演示"><a href="#实例演示" class="headerlink" title="实例演示"></a>实例演示</h2><p>为了演示MySQL权限管理的功能，我们需要先创建一些测试数据，以及相应的用户和角色。以下是一个示例数据，包括两个表：users和orders。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE testdb;</span><br><span class="line"></span><br><span class="line">USE testdb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  email <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name, email) <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;alice@example.com&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;bob@example.com&#x27;</span>),</span><br><span class="line">  (<span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;charlie@example.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  user_id <span class="type">INT</span>,</span><br><span class="line">  product <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  price <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (user_id, product, price) <span class="keyword">VALUES</span></span><br><span class="line">  (<span class="number">1</span>, <span class="string">&#x27;iPhone&#x27;</span>, <span class="number">999.99</span>),</span><br><span class="line">  (<span class="number">1</span>, <span class="string">&#x27;iPad&#x27;</span>, <span class="number">499.99</span>),</span><br><span class="line">  (<span class="number">2</span>, <span class="string">&#x27;MacBook&#x27;</span>, <span class="number">1499.99</span>),</span><br><span class="line">  (<span class="number">3</span>, <span class="string">&#x27;Apple Watch&#x27;</span>, <span class="number">199.99</span>);</span><br></pre></td></tr></table></figure>

<p>接下来，我们创建一些用户和角色，并给它们授予不同的权限。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建用户</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;alice&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;bob&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;charlie&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建角色</span></span><br><span class="line"><span class="keyword">CREATE</span> ROLE sales;</span><br><span class="line"><span class="keyword">CREATE</span> ROLE finance;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 给角色授权</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span> <span class="keyword">ON</span> testdb.users <span class="keyword">TO</span> sales;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">INSERT</span> <span class="keyword">ON</span> testdb.orders <span class="keyword">TO</span> sales;</span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">UPDATE</span>, <span class="keyword">DELETE</span> <span class="keyword">ON</span> testdb.orders <span class="keyword">TO</span> finance;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 给用户授权</span></span><br><span class="line"><span class="keyword">GRANT</span> sales <span class="keyword">TO</span> <span class="string">&#x27;alice&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> sales <span class="keyword">TO</span> <span class="string">&#x27;bob&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> finance <span class="keyword">TO</span> <span class="string">&#x27;charlie&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上面的代码创建了三个用户和两个角色。其中，alice和bob都属于sales角色，而charlie属于finance角色。此外，sales角色被授予了对users表的SELECT权限，以及对orders表的SELECT和INSERT权限；finance角色被授予了对orders表的SELECT、UPDATE和DELETE权限。最后，我们将角色分别授予给了对应的用户。</p>
<p>现在，我们可以测试不同用户和角色对数据的访问权限了。例如，我们可以用alice的账户查询orders表中的数据，只能看到自己的订单，而不能修改或删除数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">USE testdb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> user_id <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- 可以查询自己的订单</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (user_id, product, price) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;iMac&#x27;</span>, <span class="number">1999.99</span>); <span class="comment">-- 可以插入自己的订单</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> orders <span class="keyword">SET</span> price <span class="operator">=</span> <span class="number">899.99</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- 无法修改其他用户的订单</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>; <span class="comment">-- 无法删除其他用户的订单</span></span><br></pre></td></tr></table></figure>

<p>另外，我们还可以使用finance角色来修改和删除订单表中的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE testdb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders; <span class="comment">-- 可以查询所有订单</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> orders <span class="keyword">SET</span> price <span class="operator">=</span> price <span class="operator">*</span> <span class="number">0.9</span> <span class="keyword">WHERE</span> product <span class="operator">=</span> <span class="string">&#x27;iPhone&#x27;</span>; <span class="comment">-- 可以修改订单价格</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> price <span class="operator">&gt;</span> <span class="number">1000</span>; <span class="comment">-- 可以删除价格高于1000的订单</span></span><br></pre></td></tr></table></figure>

<h1 id="MySQL约束"><a href="#MySQL约束" class="headerlink" title="MySQL约束"></a>MySQL约束</h1><p>MySQL中的约束是用来限制表中数据的有效性和完整性的规则。它们确保了数据的正确性和一致性，并帮助保持数据库中的数据质量。MySQL支持以下类型的约束：</p>
<ol>
<li>主键约束（PRIMARY KEY）：用于确保表中的每行都具有唯一的标识符。</li>
<li>外键约束（FOREIGN KEY）：用于确保表之间的关系的完整性。</li>
<li>唯一约束（UNIQUE）：用于确保表中的某一列或一组列的值是唯一的。</li>
<li>检查约束（CHECK）：用于确保表中的数据符合指定的条件。</li>
</ol>
<p>下面是一些MySQL约束的示例：</p>
<ol>
<li>创建一个带有主键约束的表：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    age <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ol>
<li>创建一个带有外键约束的表：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    order_date <span class="type">DATE</span>,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (customer_id) <span class="keyword">REFERENCES</span> customers(id)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ol>
<li>创建一个带有唯一约束的表：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ol>
<li>创建一个带有检查约束的表：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> products (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">    quantity <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CHECK</span> (price <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;=</span> <span class="number">0</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>这些约束可以在表创建时定义，也可以在表创建后使用ALTER<br>TABLE语句进行修改。</p>
<h2 id="实例-15"><a href="#实例-15" class="headerlink" title="实例"></a>实例</h2><p>以下是一些MySQL约束的验证数据示例：</p>
<ol>
<li>验证主键约束：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    age <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, name, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, name, age) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="number">22</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, name, age) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="number">19</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (id, name, age) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="number">21</span>); <span class="comment">-- 这行会导致主键冲突错误</span></span><br></pre></td></tr></table></figure>

<ol>
<li>验证外键约束：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customers (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    customer_id <span class="type">INT</span>,</span><br><span class="line">    order_date <span class="type">DATE</span>,</span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY (customer_id) <span class="keyword">REFERENCES</span> customers(id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (id, name) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> customers (id, name) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (id, customer_id, order_date) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1</span>, <span class="string">&#x27;2022-01-01&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (id, customer_id, order_date) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="number">3</span>, <span class="string">&#x27;2022-02-01&#x27;</span>); <span class="comment">-- 这行会导致外键约束错误</span></span><br></pre></td></tr></table></figure>

<ol>
<li>验证唯一约束：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    phone <span class="type">VARCHAR</span>(<span class="number">15</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (id, name, email, phone) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;john@example.com&#x27;</span>, <span class="string">&#x27;123-456-7890&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (id, name, email, phone) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Jane&#x27;</span>, <span class="string">&#x27;jane@example.com&#x27;</span>, <span class="string">&#x27;234-567-8901&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (id, name, email, phone) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;john@example.com&#x27;</span>, <span class="string">&#x27;345-678-9012&#x27;</span>); <span class="comment">-- 这行会导致唯一约束错误</span></span><br></pre></td></tr></table></figure>

<ol>
<li>验证检查约束：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> products (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    price <span class="type">DECIMAL</span>(<span class="number">10</span>, <span class="number">2</span>),</span><br><span class="line">    quantity <span class="type">INT</span>,</span><br><span class="line">    <span class="keyword">CHECK</span> (price <span class="operator">&gt;</span> <span class="number">0</span>),</span><br><span class="line">    <span class="keyword">CHECK</span> (quantity <span class="operator">&gt;=</span> <span class="number">0</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> products (id, name, price, quantity) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Product 1&#x27;</span>, <span class="number">10.99</span>, <span class="number">100</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> products (id, name, price, quantity) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Product 2&#x27;</span>, <span class="number">-5.99</span>, <span class="number">50</span>); <span class="comment">-- 这行会导致检查约束错误</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> products (id, name, price, quantity) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Product 3&#x27;</span>, <span class="number">19.99</span>, <span class="number">-10</span>);</span><br></pre></td></tr></table></figure>

<h1 id="MySQL-NULL-和-NOT-NULL-约束"><a href="#MySQL-NULL-和-NOT-NULL-约束" class="headerlink" title="MySQL NULL 和 NOT NULL 约束"></a>MySQL NULL 和 NOT NULL 约束</h1><p>在 MySQL 中，可以使用 NULL 和 NOT NULL 约束来定义列中是否允许插入 NULL<br>值。NULL 值指的是缺少值或不适用的值，因此它与空字符串或空格不同。</p>
<p>当在表中定义一个列时，可以使用以下语法定义该列是否允许为 NULL：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">column_name data_type <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br></pre></td></tr></table></figure>

<p>如果没有指定 NULL 或 NOT NULL 约束，则该列默认允许为 NULL。</p>
<p>以下是一个例子，创建一个包含允许为 NULL 和不允许为 NULL 的列的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NULL</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，id 和 age 列被定义为 NOT NULL，这意味着它们不能为<br>NULL。而 name 列被定义为允许为 NULL。</p>
<p>在插入数据时，可以指定 NULL 值来填充允许为 NULL 的列：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="keyword">NULL</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p>当尝试将 NULL 值插入不允许为 NULL 的列时，将会收到错误消息。</p>
<h1 id="MySQL-Default关键字"><a href="#MySQL-Default关键字" class="headerlink" title="MySQL Default关键字"></a>MySQL Default关键字</h1><p>在 MySQL 中，DEFAULT<br>关键字用于指定当插入一条记录时，如果没有为某个列指定值，该列应使用的默认值。如果未指定默认值，则该列将默认为<br>NULL。</p>
<p>default 默认值</p>
<p>以下是一个例子，创建一个包含默认值的列的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;Anonymous&#x27;</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，name 列被定义为具有默认值<br>‘Anonymous’。当在插入数据时未为该列指定值时，将使用默认值<br>‘Anonymous’。下面是一个例子：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，未为 name 列指定值，因此将使用默认值 ‘Anonymous’。</p>
<p>如果需要更改默认值，可以使用 ALTER TABLE<br>语句来更改列的默认值，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_table <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> name <span class="keyword">SET</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;Unknown&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，将更改 name 列的默认值为<br>‘Unknown’。如果要删除默认值，可以使用以下语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> test_table <span class="keyword">ALTER</span> <span class="keyword">COLUMN</span> name <span class="keyword">DROP</span> <span class="keyword">DEFAULT</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的例子中，将删除 name 列的默认值。</p>
<h1 id="MySQL数据库设计"><a href="#MySQL数据库设计" class="headerlink" title="MySQL数据库设计"></a>MySQL数据库设计</h1><h2 id="数据库设计"><a href="#数据库设计" class="headerlink" title="数据库设计"></a>数据库设计</h2><p>数据库设计是指在实现数据库应用程序之前，对数据库的结构和逻辑进行规划和设计的过程。数据库设计涉及到从业务需求中识别出数据实体、属性、关系和约束，以及设计适当的表结构、视图、索引、触发器、存储过程和其他数据库对象。好的数据库设计能够提高数据访问的效率和数据的安全性，并能更好地支持业务需求。</p>
<p>下面是一些数据库设计的最佳实践：</p>
<ol>
<li>识别和建模实体：从业务需求中识别出需要存储的实体，定义实体的属性，建立实体之间的关系。</li>
<li>规范化表结构：将数据分解为多个表，避免数据冗余和数据更新异常，提高数据的一致性和完整性。</li>
<li>设计适当的数据类型：选择适当的数据类型和长度，避免浪费存储空间和查询性能。</li>
<li>设计主键和外键：为每个表定义主键，确保每条记录的唯一性，定义外键建立表之间的关系。</li>
<li>设计索引：为经常被查询的列创建索引，加快查询性能。</li>
<li>设计视图：为常用的查询创建视图，提高查询的重用性和可读性。</li>
<li>设计存储过程和触发器：将业务逻辑封装在存储过程和触发器中，提高数据的安全性和完整性。</li>
<li>设计备份和恢复策略：定期备份数据库，并测试备份和恢复策略，确保数据的安全性和可靠性。</li>
</ol>
<p>以上是一些数据库设计的最佳实践，但具体的设计应该根据具体的业务需求和数据特点来确定。</p>
<h2 id="设计工具"><a href="#设计工具" class="headerlink" title="设计工具"></a>设计工具</h2><p>数据库设计工具是一种帮助数据库开发人员进行数据库设计和管理的软件。这些工具提供了一个图形化界面来建模、维护和管理数据库。以下是几种常用的数据库设计工具：</p>
<ol>
<li>MySQL<br>Workbench：MySQL官方提供的免费数据库设计工具，可用于设计和管理MySQL数据库。</li>
<li>Oracle SQL<br>Developer：Oracle公司提供的免费数据库设计工具，支持多种数据库，包括Oracle、MySQL、Microsoft<br>SQL Server等。</li>
<li>ER&#x2F;Studio：ER&#x2F;Studio是一款商业数据库设计工具，提供全面的数据建模和管理功能，支持多种数据库。</li>
<li>Navicat：Navicat是一款商业数据库管理工具，支持多种数据库，包括MySQL、Oracle、Microsoft<br>SQL Server、PostgreSQL等。</li>
<li>Toad for Oracle：Toad for<br>Oracle是一款商业数据库管理工具，主要用于管理和维护Oracle数据库。</li>
</ol>
<p>以上是几种常用的数据库设计工具，每种工具都有其优点和缺点，具体使用应根据项目需求和个人喜好进行选择。</p>
<h2 id="ER图"><a href="#ER图" class="headerlink" title="ER图"></a>ER图</h2><p>ER图（Entity-Relationship<br>Diagram）实体关系图，是一种用于表示实体之间关系的图形化工具。ER图通常用于数据库设计过程中，可以帮助开发人员建立清晰的数据模型，并描述实体之间的关系。</p>
<p>在ER图中，实体通常用矩形表示，属性用椭圆形表示，关系用菱形表示。实体和属性之间用直线连接，表示实体和属性之间的关系；实体和关系之间用直线连接，表示实体和关系之间的关系；关系和属性之间也用直线连接，表示关系和属性之间的关系。</p>
<p>ER图常用于设计关系型数据库，用于描述数据库的结构和约束。通过ER图，开发人员可以更好地理解数据库中的实体和关系，提高数据库的可维护性和扩展性。</p>
<p>ER图可以手动绘制，也可以使用数据库设计工具来绘制。在设计ER图时，需要遵循一些基本原则，例如实体之间的关系应该是可靠的，具有明确的定义和规则。</p>
<h1 id="MySQL数据库三范式"><a href="#MySQL数据库三范式" class="headerlink" title="MySQL数据库三范式"></a>MySQL数据库三范式</h1><p>数据库设计三范式（Normalization）是指对关系数据库的设计进行规范化，以减少数据冗余、提高数据一致性、避免数据异常等问题，保证数据的有效性和完整性。三范式是一个逐步拆分数据表的过程，其目的是消除重复数据，并使得数据表内的每个属性都只与主键直接相关。</p>
<p>三范式的具体定义如下：</p>
<ol>
<li>第一范式（1NF）：数据表中的每个属性都是原子性的，即不可再分割。如果数据表中某个属性可以分为更小的子属性，就需要拆分成一个新的数据表。</li>
<li>第二范式（2NF）：数据表中的非主键属性都必须完全依赖于主键，而不是依赖于主键的一部分。如果一个数据表中有多个主键，非主键属性必须与所有主键相关，而不能只与其中一部分主键相关。</li>
<li>第三范式（3NF）：数据表中的非主键属性不依赖于其他非主键属性。如果有两个非主键属性之间存在依赖关系，需要将其拆分成两个数据表。</li>
</ol>
<p>设计一个符合三范式的数据库模型可以避免冗余和不一致性数据，并能提高数据操作的效率和可靠性。但是，过度的规范化可能会导致数据库结构复杂，难以维护和查询。在设计数据库时，应该根据具体的应用场景和数据需求，权衡规范化和性能的关系，以获得最佳的设计方案。</p>
<h2 id="实例-16"><a href="#实例-16" class="headerlink" title="实例"></a>实例</h2><p>为了初始化数据并验证数据库的三范式，我们可以考虑以下示例数据：</p>
<p>假设我们要创建一个数据库来管理公司的员工信息。我们可以创建一个包含以下表的关系型数据库：</p>
<p><strong>员工表（Employee）</strong></p>
<p>  员工编号   姓名   部门编号   职位</p>
<hr>
<p>  1          张三   101        经理<br>  2          李四   102        经理<br>  3          王五   102        员工</p>
<p><strong>部门表（Department）</strong></p>
<p>  部门编号   部门名称   部门经理编号</p>
<hr>
<p>  101        销售部     1<br>  102        研发部     2</p>
<p><strong>验证第一范式（1NF）</strong></p>
<p>在第一范式中，每个表中的每个字段都应该是原子的，不可再分的。上述表格中，每个字段都是原子的，因此符合第一范式。</p>
<p><strong>验证第二范式（2NF）</strong></p>
<p>在第二范式中，每个表中的非主键字段都应该完全依赖于主键。上述表格中，员工表中的部门编号和部门表中的部门编号都是主键，而职位字段只依赖于员工表中的部门编号，因此符合第二范式。</p>
<p><strong>验证第三范式（3NF）</strong></p>
<p>在第三范式中，每个表中的非主键字段都不应该依赖于其他非主键字段。上述表格中，员工表中的部门编号和部门表中的部门编号都是主键，而部门名称和部门经理编号只依赖于部门编号，因此符合第三范式。</p>
<p>因此，我们可以验证出这个关系型数据库符合第一、第二、第三范式。</p>
<h1 id="MySQL事务简介"><a href="#MySQL事务简介" class="headerlink" title="MySQL事务简介"></a>MySQL事务简介</h1><p>MySQL事务是一系列数据库操作的集合，这些操作被视为一个单独的工作单元，要么全部成功完成，要么全部失败回滚。</p>
<p>在MySQL中，可以使用以下语句来开始和结束一个事务：</p>
<ol>
<li>开始事务：START TRANSACTION 或 BEGIN</li>
<li>提交事务：COMMIT</li>
<li>回滚事务：ROLLBACK</li>
</ol>
<p>当一个事务开始时，所有的SQL语句都将被保存在缓冲区中，而不是立即执行。只有当COMMIT语句被执行时，MySQL才会将缓冲区中的SQL语句提交到数据库中。如果在事务执行期间出现错误或者ROLLBACK语句被执行，所有在缓冲区中的SQL语句都会被撤销，数据库状态会回滚到事务开始前的状态。</p>
<p>使用事务可以确保数据库的一致性和完整性。如果一个事务中的任何一条SQL语句执行失败或者事务被回滚，那么数据库的状态就不会被破坏。这使得MySQL事务在高并发和复杂业务场景下非常有用，可以有效地保证数据的正确性和可靠性。</p>
<h2 id="实例演示-1"><a href="#实例演示-1" class="headerlink" title="实例演示"></a>实例演示</h2><h3 id="提交事务"><a href="#提交事务" class="headerlink" title="提交事务"></a>提交事务</h3><p>创建student表的SQL语句示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  age <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>提交事务</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, name, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;John&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, name, age) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="number">22</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, name, age) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">21</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>在这个例子中，我们使用了START<br>TRANSACTION语句来开启一个事务，然后执行了三个INSERT语句来往student表中插入三个学生的信息。最后，我们使用COMMIT语句来提交这个事务。</p>
<p>如果在执行这个事务的过程中，任何一个INSERT语句执行失败（比如插入了一个重复的学生ID），那么整个事务将会被回滚，student表的数据将会回到事务开始之前的状态。</p>
<p>这样，使用事务来管理数据库操作，可以确保数据的一致性和完整性，避免了数据操作过程中的错误和异常情况。</p>
<h3 id="回滚事务"><a href="#回滚事务" class="headerlink" title="回滚事务"></a>回滚事务</h3><p>这个示例将尝试向student表中插入一个重复的学生ID，导致事务执行失败并回滚。</p>
<p>首先，我们可以通过以下语句检查student表的内容：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<p>这应该会返回我们之前插入的三个学生记录。</p>
<p>现在，我们尝试执行以下SQL语句来往student表中插入一个重复的学生ID：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, name, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;David&#x27;</span>, <span class="number">19</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> student (id, name, age) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;Lisa&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>在这个例子中，我们故意将第一个学生的ID设置为1，这是我们之前插入的学生的ID。因此，第一个INSERT语句会失败，整个事务也会因为第一个操作失败而回滚。</p>
<p>执行完上述SQL语句后，我们可以再次执行以下SELECT语句来检查student表的内容：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student;</span><br></pre></td></tr></table></figure>

<p>这应该返回之前插入的三个学生记录，而新插入的学生记录并没有被添加到表中。</p>
<p>这个例子说明了MySQL事务的回滚功能：当事务中的任何一条SQL语句执行失败时，整个事务都会被回滚，确保数据库的一致性和完整性。</p>
<h1 id="MySQL事务的特性"><a href="#MySQL事务的特性" class="headerlink" title="MySQL事务的特性"></a>MySQL事务的特性</h1><h2 id="数据库事务的特性"><a href="#数据库事务的特性" class="headerlink" title="数据库事务的特性"></a>数据库事务的特性</h2><p>数据库事务具有以下四个特性，通常被称为ACID特性：</p>
<ol>
<li>原子性（Atomicity）：一个事务中的所有操作要么全部完成，要么全部不完成，事务的执行是一个不可分割的原子操作。</li>
<li>一致性（Consistency）：事务执行之前和之后，数据库的完整性约束没有被破坏。也就是说，一个事务执行之前和之后，数据库中的数据必须保持一致，如果事务执行失败，则数据必须回滚到执行事务前的状态。</li>
<li>隔离性（Isolation）：事务的执行不会被其他事务干扰，事务的执行结果与其他事务是隔离的。每个事务都应该认为它是唯一在数据库上运行的事务，并且在其他事务对其影响之前完成。</li>
<li>持久性（Durability）：一旦事务被提交，它的结果就应该是永久的。即使在系统故障的情况下，数据也不应该被丢失。</li>
</ol>
<p>这些特性确保了事务的可靠性和数据的完整性，是保证数据库操作正确性和可靠性的重要保障。事务可以保证一组操作全部执行或全部回滚，避免了数据操作中的异常和错误，确保了数据的正确性和一致性。</p>
<h2 id="实例演示-2"><a href="#实例演示-2" class="headerlink" title="实例演示"></a>实例演示</h2><p>下面通过一个银行转账项目演示，事务的特性：</p>
<p>下面是创建 <code>accounts</code> 表的 SQL：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> accounts (</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  balance <span class="type">DECIMAL</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>我们可以插入一些数据来测试：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> accounts (name, balance) <span class="keyword">VALUES</span> (<span class="string">&#x27;A&#x27;</span>, <span class="number">1000.00</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> accounts (name, balance) <span class="keyword">VALUES</span> (<span class="string">&#x27;B&#x27;</span>, <span class="number">500.00</span>);</span><br></pre></td></tr></table></figure>

<p>假设我们有两个银行账户，账户A和账户B。我们希望从账户A向账户B转移100元。这个过程需要进行以下三个操作：</p>
<ol>
<li>检查账户A的余额是否足够。</li>
<li>从账户A中扣除100元。</li>
<li>将100元存入账户B中。</li>
</ol>
<p>我们可以使用MySQL事务来确保这三个操作的原子性，以便在出现故障时能够回滚并确保数据的完整性。</p>
<p>下面是一个示例代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> balance <span class="keyword">FROM</span> accounts <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;A&#x27;</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;B&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>在这个示例中，我们首先使用SELECT语句锁定账户A的余额，以确保其他事务不能同时读取或修改这个值。然后，我们执行两个UPDATE语句来减少账户A的余额并增加账户B的余额。最后，我们使用COMMIT语句提交事务并释放锁。</p>
<p>如果在事务执行过程中发生任何错误，如余额不足或数据库错误，事务会自动回滚并撤销对数据库的任何更改。这确保了银行转账的操作是原子的，即要么成功转移100元，要么不进行转移。</p>
<p>通过使用MySQL事务，我们可以确保在复杂的数据库操作中保持数据的完整性和一致性。</p>
<h1 id="MySQL事务的隔离级别"><a href="#MySQL事务的隔离级别" class="headerlink" title="MySQL事务的隔离级别"></a>MySQL事务的隔离级别</h1><p>MySQL<br>支持四种事务隔离级别，每种隔离级别的事务并发控制方式不同，如下所述：</p>
<ol>
<li>READ<br>UNCOMMITTED（未提交读）：最低的隔离级别，允许事务读取未提交的数据，可能会导致脏读、不可重复读和幻象读的问题。</li>
<li>READ<br>COMMITTED（提交读）：允许事务读取已提交的数据，可以避免脏读的问题，但仍可能会出现不可重复读和幻象读的问题。</li>
<li>REPEATABLE<br>READ（可重复读）：保证在同一事务中多次读取同一数据时返回相同的结果，可以避免不可重复读的问题，但仍可能会出现幻象读的问题。</li>
<li>SERIALIZABLE（串行化）：最高的隔离级别，通过强制事务串行执行来避免并发问题，可以避免脏读、不可重复读和幻象读的问题，但会降低并发性能。</li>
</ol>
<p>可以使用以下语句来设置事务隔离级别：</p>
<pre><code>SET TRANSACTION ISOLATION LEVEL &lt;isolation level&gt;;
</code></pre>
<p>其中，<code>&lt;isolation level&gt;</code> 可以是<br><code>READ UNCOMMITTED</code>、<code>READ COMMITTED</code>、<code>REPEATABLE READ</code> 或<br><code>SERIALIZABLE</code> 中的任意一个。</p>
<blockquote>
<p>需要注意的是，设置事务隔离级别会影响数据库的性能和并发控制效果，应根据具体的应用场景选择适当的隔离级别。</p>
</blockquote>
<h2 id="实例演示-3"><a href="#实例演示-3" class="headerlink" title="实例演示"></a>实例演示</h2><p>假设有一个银行转账的场景，银行账户信息保存在 <code>account</code><br>表中，包括账户编号（<code>id</code>）和账户余额（<code>balance</code>）两个字段。现在有两个客户端<br>A 和 B，分别要从账户 1 向账户 2 转账 100 元和 200 元。</p>
<p>以下是一个示例的 SQL 代码，创建 <code>account</code> 表并插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> account (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  balance <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> account (id, balance) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1000</span>), (<span class="number">2</span>, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>现在，我们在两个客户端中分别开启一个事务，并设置不同的隔离级别。在客户端<br>A 中，设置隔离级别为 <code>READ COMMITTED</code>，在客户端 B 中，设置隔离级别为<br><code>REPEATABLE READ</code>。</p>
<p>在客户端 A 中执行以下 SQL 代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> TRANSACTION ISOLATION LEVEL READ COMMITTED;</span><br><span class="line"></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>在客户端 B 中执行以下 SQL 代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> TRANSACTION ISOLATION LEVEL REPEATABLE READ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>由于隔离级别不同，客户端 A 和客户端 B 的事务执行结果也不同。在<br><code>READ COMMITTED</code> 隔离级别下，客户端 A<br>可以读取其他已提交事务的数据，因此在转账时可以正确地读取账户 2<br>的余额。而在 <code>REPEATABLE READ</code> 隔离级别下，客户端 B<br>无法读取其他已提交事务的数据，因此在转账时无法正确地读取账户 2<br>的余额，可能会导致余额不足的错误。</p>
<p>因此，在实际应用中，需要根据具体的业务需求和并发性能要求来选择合适的事务隔离级别。</p>
<h1 id="MySQL事务并发"><a href="#MySQL事务并发" class="headerlink" title="MySQL事务并发"></a>MySQL事务并发</h1><p>在 MySQL<br>中，事务并发执行是允许的，这意味着多个事务可以同时读取和写入数据库，但同时也会引入一些并发控制的问题。下面是一些关于<br>MySQL 事务并发的概念和相关问题：</p>
<ol>
<li>事务隔离级别：MySQL 支持四种事务隔离级别，包括 READ<br>UNCOMMITTED、READ COMMITTED、REPEATABLE READ 和<br>SERIALIZABLE，不同隔离级别的事务对并发控制的方式也不同。</li>
<li>锁定：在并发环境下，为了避免数据的不一致性，MySQL<br>会使用锁定机制来控制对数据的访问。MySQL<br>支持两种锁定方式：行级锁和表级锁，行级锁可以避免锁定整个表，提高并发性能。</li>
<li>死锁：如果两个或多个事务试图锁定对方持有的资源，就会发生死锁。MySQL<br>的 InnoDB 存储引擎提供了死锁检测和回滚机制，可以自动检测并回滚死锁。</li>
<li>并发问题：并发执行的事务可能会引起一些问题，例如丢失更新、脏读、不可重复读和幻象读。这些问题可以通过使用事务隔离级别和锁定机制来避免或减少发生。</li>
</ol>
<p>总之，在 MySQL<br>中，事务并发执行是一种常见的情况。为了确保数据的一致性和可靠性，我们需要了解并发控制的相关概念和技术，并根据具体的应用场景选择适当的事务隔离级别和锁定机制。</p>
<h2 id="实例-17"><a href="#实例-17" class="headerlink" title="实例"></a>实例</h2><p>假设有一个银行转账的场景，银行账户信息保存在 <code>account</code><br>表中，包括账户编号（<code>id</code>）和账户余额（<code>balance</code>）两个字段。现在有两个客户端<br>A 和 B，分别要从账户 1 向账户 2 转账 100 元和 200 元。</p>
<p>以下是一个示例的 SQL 代码，创建 <code>account</code> 表并插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> account (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  balance <span class="type">INT</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> account (id, balance) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="number">1000</span>), (<span class="number">2</span>, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>现在，我们在两个客户端中分别开启一个事务，并进行转账操作。在客户端 A<br>中，执行以下 SQL 代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>在客户端 B 中，执行以下 SQL 代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">+</span> <span class="number">200</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>由于两个事务并发执行，可能会出现一些并发问题。以下是一些常见的并发问题：</p>
<ol>
<li>脏读（Dirty<br>read）：一个事务读取到了另一个未提交事务的数据，如果另一个事务回滚了，则读取到的数据就是无效的。</li>
<li>不可重复读（Non-repeatable<br>read）：在同一个事务中，一个事务多次读取同一数据时，返回的结果不一致，因为另一个事务在这期间对数据进行了修改或删除。</li>
<li>幻象读（Phantom<br>read）：在同一个事务中，一个事务多次查询同一范围内的数据时，返回的结果不一致，因为另一个事务在这期间插入或删除了数据。</li>
</ol>
<p>针对这些并发问题，可以通过设置事务隔离级别和加锁等方式来解决。例如，可以将事务隔离级别设置为<br><code>SERIALIZABLE</code>，通过强制事务串行执行来避免并发问题，或者在转账操作中加锁，确保在修改数据时只有一个事务能够访问。</p>
<h1 id="MySQL视图"><a href="#MySQL视图" class="headerlink" title="MySQL视图"></a>MySQL视图</h1><p>MySQL<br>中的视图（View）是一种虚拟的表，它并不真实存在于数据库中，但可以像表一样被查询和操作。视图是基于查询语句创建的，它包含了查询语句中的<br>SELECT 语句的结果集，可以对这个结果集进行各种操作。</p>
<p>MySQL 中的视图有以下特点：</p>
<ol>
<li>视图是虚拟的，不占用数据库的物理存储空间。</li>
<li>视图是基于查询语句创建的，对查询语句进行了封装，简化了复杂的查询操作。</li>
<li>视图可以用来保护数据的安全性，可以限制用户只能看到特定的数据。</li>
<li>视图可以被当做普通表使用，可以进行查询、插入、更新和删除等操作，但是它们的数据是由基础表生成的，无法直接修改。</li>
</ol>
<p>以下是一个创建视图的示例 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> view_name <span class="keyword">AS</span> <span class="keyword">SELECT</span> column1, column2 <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure>

<p>其中，<code>view_name</code> 是视图的名称，<code>column1</code> 和 <code>column2</code><br>是要查询的列，<code>table_name</code> 是要查询的基础表，<code>condition</code> 是查询条件。</p>
<p>例如，以下是一个创建视图的示例 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> customer_info <span class="keyword">AS</span> <span class="keyword">SELECT</span> name, address, phone <span class="keyword">FROM</span> customer <span class="keyword">WHERE</span> status <span class="operator">=</span> <span class="string">&#x27;active&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>这个视图名为 <code>customer_info</code>，包含了 <code>customer</code> 表中 <code>status</code> 字段为<br><code>&#39;active&#39;</code> 的客户的姓名、地址和电话号码。</p>
<p>使用视图可以简化查询语句，例如，可以使用以下 SQL 查询语句查询<br><code>customer_info</code> 视图：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> customer_info;</span><br></pre></td></tr></table></figure>

<p>这个查询语句会返回 <code>customer</code> 表中 <code>status</code> 字段为 <code>&#39;active&#39;</code><br>的客户的姓名、地址和电话号码。可以看到，使用视图可以避免重复编写复杂的查询语句，提高了查询效率和代码的可维护性。</p>
<h2 id="视图实例"><a href="#视图实例" class="headerlink" title="视图实例"></a>视图实例</h2><p>假设有一个 <code>employees</code><br>表，其中包含了员工的姓名、部门、薪水等信息。我们可以创建一个视图，只显示部门为<br><code>Sales</code> 的员工的姓名和薪水信息。下面是创建视图的 SQL 语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> sales_employees <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> name, salary <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department <span class="operator">=</span> <span class="string">&#x27;Sales&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>上面的语句创建了一个名为 <code>sales_employees</code> 的视图，它只包含了部门为<br><code>Sales</code> 的员工的姓名和薪水信息。我们可以像查询表一样查询这个视图：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> sales_employees;</span><br></pre></td></tr></table></figure>

<p>这个查询语句会返回部门为 <code>Sales</code><br>的员工的姓名和薪水信息。注意，视图并不存储数据，它只是一个基于查询语句的虚拟表，所以我们不能向视图中插入、修改或删除数据。</p>
<p>当 <code>employees</code> 表中的数据发生改变时，<code>sales_employees</code><br>视图也会相应地发生改变。例如，如果我们修改了某个部门为 <code>Sales</code><br>的员工的薪水信息，那么查询 <code>sales_employees</code><br>视图会反映这个改变。因此，视图提供了一种方便的方式来查看经常需要查询的数据，同时也保证了数据的一致性。</p>
<h1 id="MySQL视图检查选项（限制写入）"><a href="#MySQL视图检查选项（限制写入）" class="headerlink" title="MySQL视图检查选项（限制写入）"></a>MySQL视图检查选项（限制写入）</h1><p>在 MySQL 中，可以使用 <code>CREATE VIEW</code> 语句的 <code>WITH CHECK OPTION</code><br>子句来限制通过视图写入表的数据。当使用 <code>WITH CHECK OPTION</code><br>选项创建视图时，MySQL<br>会检查写入视图的数据是否符合视图的定义，如果不符合则拒绝写入操作。</p>
<p>下面是一个使用 <code>WITH CHECK OPTION</code> 选项创建视图的示例。假设有一个<br><code>employees</code> 表，包含员工的姓名、部门和薪水信息。我们可以创建一个名为<br><code>sales_employees</code> 的视图，只包含部门为 <code>Sales</code><br>的员工的姓名和薪水信息，并限制通过视图写入的数据必须满足部门为 <code>Sales</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> sales_employees <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> name, salary <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department <span class="operator">=</span> <span class="string">&#x27;Sales&#x27;</span></span><br><span class="line"><span class="keyword">WITH</span> <span class="keyword">CHECK</span> OPTION;</span><br></pre></td></tr></table></figure>

<p>上面的语句创建了一个名为 <code>sales_employees</code> 的视图，只包含了部门为<br><code>Sales</code> 的员工的姓名和薪水信息。当我们通过视图写入数据时，MySQL<br>会检查写入的数据是否符合视图的定义，如果不符合则拒绝写入操作。</p>
<p>例如，如果我们尝试通过视图写入一个部门不为 <code>Sales</code><br>的员工的薪水信息，MySQL 将拒绝这个操作：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> sales_employees (name, salary, department) <span class="keyword">VALUES</span> (<span class="string">&#x27;John Smith&#x27;</span>, <span class="number">50000</span>, <span class="string">&#x27;Marketing&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>MySQL 会返回一个错误，指出写入操作被拒绝了：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ERROR <span class="number">1369</span> (HY000): <span class="keyword">CHECK</span> OPTION failed <span class="string">&#x27;test.sales_employees&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这样，我们就可以使用 <code>WITH CHECK OPTION</code><br>选项限制通过视图写入表的数据，保证数据的一致性。</p>
<h1 id="MySQL视图的删除修改和替换"><a href="#MySQL视图的删除修改和替换" class="headerlink" title="MySQL视图的删除修改和替换"></a>MySQL视图的删除修改和替换</h1><p>在 MySQL 中，可以使用 <code>ALTER VIEW</code> 语句来修改已有的视图。<code>ALTER VIEW</code><br>语句的语法与 <code>CREATE VIEW</code><br>语句类似，但只需要指定要修改的视图的名称和新的视图定义即可。例如，假设我们要修改名为<br><code>high_salary_employees</code> 的视图，只显示薪水高于 60000<br>的员工的姓名和薪水信息，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> high_salary_employees <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> name, salary <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="number">60000</span>;</span><br></pre></td></tr></table></figure>

<p>这个命令将原有的 <code>high_salary_employees</code> 视图修改为只显示薪水高于 60000<br>的员工的姓名和薪水信息。</p>
<p>要删除一个视图，可以使用 <code>DROP VIEW</code><br>语句，指定要删除的视图的名称即可。例如，要删除名为<br><code>high_salary_employees</code> 的视图，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> high_salary_employees;</span><br></pre></td></tr></table></figure>

<p>这个命令将删除名为 <code>high_salary_employees</code> 的视图。</p>
<p>在 MySQL 5.1 版本及以上，还可以使用 <code>CREATE OR REPLACE VIEW</code><br>语句来替换已有的视图。<code>CREATE OR REPLACE VIEW</code> 语句的语法与<br><code>CREATE VIEW</code><br>语句类似，但如果指定的视图名称已经存在，则会将原有的视图替换为新的视图定义。例如，要替换名为<br><code>high_salary_employees</code> 的视图为只显示薪水高于 70000<br>的员工的姓名和薪水信息，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> high_salary_employees <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> name, salary <span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="operator">&gt;</span> <span class="number">70000</span>;</span><br></pre></td></tr></table></figure>

<p>这个命令将替换原有的 <code>high_salary_employees</code> 视图为只显示薪水高于 70000<br>的员工的姓名和薪水信息。</p>
<h1 id="MySQL存储过程"><a href="#MySQL存储过程" class="headerlink" title="MySQL存储过程"></a>MySQL存储过程</h1><p>MySQL 存储过程是一种预先编译的代码块，可以接收参数、执行一系列的 SQL<br>语句、进行条件判断和循环操作等，并最终返回结果或修改数据库的状态。使用存储过程可以提高<br>SQL<br>的执行效率，减少网络通信的开销，还可以在数据库端进行一些复杂的计算和数据处理。</p>
<p>以下是一个简单的 MySQL 存储过程的示例，它接收一个参数 <code>emp_id</code>，查询名为<br><code>employees</code> 的表中 <code>emp_id</code><br>对应的员工的姓名和薪水信息，然后将这些信息输出到控制台：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_employee_info(<span class="keyword">IN</span> emp_id <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">  <span class="keyword">DECLARE</span> emp_salary <span class="type">DECIMAL</span>(<span class="number">8</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SELECT</span> name, salary <span class="keyword">INTO</span> emp_name, emp_salary</span><br><span class="line">  <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> id <span class="operator">=</span> emp_id;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Employee name: &#x27;</span>, emp_name) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Employee salary: &#x27;</span>, emp_salary) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<p>该存储过程的参数为 <code>emp_id</code>，在存储过程的主体中，声明了两个变量<br><code>emp_name</code> 和<br><code>emp_salary</code>，用于存储从表中查询到的员工姓名和薪水信息。然后使用<br><code>SELECT INTO</code> 语句将查询结果赋值给这两个变量。最后，使用 <code>SELECT</code><br>语句将员工姓名和薪水信息输出到控制台。</p>
<p>要调用该存储过程，可以使用 <code>CALL</code> 语句，并传递一个参数<br><code>emp_id</code>。例如，要查询员工 ID 为 100<br>的员工的姓名和薪水信息，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> get_employee_info(<span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<p>执行该命令后，MySQL 会调用 <code>get_employee_info</code><br>存储过程，并输出员工姓名和薪水信息。</p>
<p>除了 <code>IN</code> 类型的参数，MySQL 存储过程还支持 <code>OUT</code> 和 <code>INOUT</code><br>类型的参数，用于将存储过程内部计算得到的结果或状态返回给调用方。存储过程还支持条件语句、循环语句、异常处理等高级语言特性，可以实现更加复杂的逻辑。</p>
<h2 id="实例-18"><a href="#实例-18" class="headerlink" title="实例"></a>实例</h2><p>下面演示一个简单的 MySQL 存储过程，它接收一个参数 <code>dept_name</code>，查询名为<br><code>employees</code><br>的表中在该部门工作的员工的姓名和薪水信息，并将结果输出到控制台。</p>
<p>首先，我们需要创建一个名为 <code>employees</code> 的表，并插入一些数据，如下所示：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  emp_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  salary <span class="type">DECIMAL</span>(<span class="number">8</span>, <span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (emp_id, emp_name, dept_name, salary)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">5000.00</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">6000.00</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">7000.00</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">8000.00</span>);</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以创建一个名为 <code>get_dept_employees</code> 的存储过程，代码如下：</p>
<p>注：DELIMITER 命令在MySQL命令行客户端之外，是不支持的。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> get_dept_employees(<span class="keyword">IN</span> dept_name <span class="type">VARCHAR</span>(<span class="number">50</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> emp_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">  <span class="keyword">DECLARE</span> emp_salary <span class="type">DECIMAL</span>(<span class="number">8</span>, <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">DECLARE</span> cur <span class="keyword">CURSOR</span> <span class="keyword">FOR</span></span><br><span class="line">    <span class="keyword">SELECT</span> emp_name, salary <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> dept_name <span class="operator">=</span> dept_name;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">OPEN</span> cur;</span><br><span class="line">  REPEAT</span><br><span class="line">    <span class="keyword">FETCH</span> cur <span class="keyword">INTO</span> emp_name, emp_salary;</span><br><span class="line">    IF <span class="keyword">NOT</span> done <span class="keyword">THEN</span></span><br><span class="line">      <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Employee name: &#x27;</span>, emp_name) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line">      <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Employee salary: &#x27;</span>, emp_salary) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line">    <span class="keyword">END</span> IF;</span><br><span class="line">  UNTIL done <span class="keyword">END</span> REPEAT;</span><br><span class="line">  <span class="keyword">CLOSE</span> cur;</span><br><span class="line"><span class="keyword">END</span> <span class="operator">/</span><span class="operator">/</span></span><br><span class="line"></span><br><span class="line">DELIMITER ;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">这段代码是用于创建一个名为&quot;get_dept_employees&quot;的存储过程，它根据传入的部门名称（dept_name），获取该部门的员工信息。</span><br><span class="line"></span><br><span class="line">让我逐行解释这段代码：</span><br><span class="line"></span><br><span class="line">DELIMITER //</span><br><span class="line">这个语句将分隔符设置为&quot;//&quot;，因为存储过程中包含多个语句，需要使用不同于默认分隔符的分隔符。</span><br><span class="line"></span><br><span class="line">CREATE PROCEDURE get_dept_employees(IN dept_name VARCHAR(50))</span><br><span class="line">这是创建存储过程的语句。存储过程名为&quot;get_dept_employees&quot;，它接受一个输入参数dept_name，类型为VARCHAR，最大长度为50。</span><br><span class="line"></span><br><span class="line">BEGIN</span><br><span class="line">存储过程的开始标志，表示接下来是存储过程的主体部分。</span><br><span class="line"></span><br><span class="line">DECLARE emp_name VARCHAR(50);</span><br><span class="line">这是声明一个局部变量emp_name，用于存储员工姓名，类型为VARCHAR，最大长度为50。</span><br><span class="line"></span><br><span class="line">DECLARE emp_salary DECIMAL(8, 2);</span><br><span class="line">这是声明一个局部变量emp_salary，用于存储员工工资，类型为DECIMAL，总共8位数，其中2位为小数。</span><br><span class="line"></span><br><span class="line">DECLARE cur CURSOR FOR SELECT emp_name, salary FROM employees WHERE dept_name = dept_name;</span><br><span class="line">这是声明一个游标cur，用于查询符合条件的员工信息。游标是一种数据结构，用于逐行访问查询结果。</span><br><span class="line"></span><br><span class="line">OPEN cur;</span><br><span class="line">打开游标，准备开始遍历查询结果。</span><br><span class="line"></span><br><span class="line">REPEAT</span><br><span class="line">开始一个循环，用于遍历查询结果。</span><br><span class="line"></span><br><span class="line">FETCH cur INTO emp_name, emp_salary;</span><br><span class="line">从游标中获取一行数据，并将结果存储到emp_name和emp_salary变量中。</span><br><span class="line"></span><br><span class="line">IF NOT done THEN</span><br><span class="line">判断是否还有更多的数据行可获取。</span><br><span class="line"></span><br><span class="line">SELECT CONCAT(&#x27;Employee name: &#x27;, emp_name) AS result;</span><br><span class="line">如果还有数据行，输出员工姓名。</span><br><span class="line"></span><br><span class="line">SELECT CONCAT(&#x27;Employee salary: &#x27;, emp_salary) AS result;</span><br><span class="line">输出员工工资。</span><br><span class="line"></span><br><span class="line">END IF;</span><br><span class="line">结束条件判断。</span><br><span class="line"></span><br><span class="line">UNTIL done END REPEAT;</span><br><span class="line">继续循环，直到没有更多的数据行可获取。</span><br><span class="line"></span><br><span class="line">CLOSE cur;</span><br><span class="line">关闭游标。</span><br><span class="line"></span><br><span class="line">END //</span><br><span class="line">存储过程主体部分结束标志。</span><br></pre></td></tr></table></figure>

<p>可以尝试使用以下修正后的代码，它没有使用DELIMITER命令，并对存储过程的语法进行了适当调整：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE get_dept_employees(IN dept_name VARCHAR(50))</span><br><span class="line">BEGIN</span><br><span class="line">  DECLARE emp_name VARCHAR(50);</span><br><span class="line">  DECLARE emp_salary DECIMAL(8, 2);</span><br><span class="line"></span><br><span class="line">  DECLARE done INT DEFAULT FALSE;</span><br><span class="line"></span><br><span class="line">  DECLARE cur CURSOR FOR</span><br><span class="line">    SELECT emp_name, salary FROM employees WHERE dept_name = dept_name;</span><br><span class="line"></span><br><span class="line">  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;</span><br><span class="line"></span><br><span class="line">  OPEN cur;</span><br><span class="line">  FETCH cur INTO emp_name, emp_salary;</span><br><span class="line"></span><br><span class="line">  WHILE NOT done DO</span><br><span class="line">    SELECT CONCAT(&#x27;Employee name: &#x27;, emp_name) AS result;</span><br><span class="line">    SELECT CONCAT(&#x27;Employee salary: &#x27;, emp_salary) AS result;</span><br><span class="line"></span><br><span class="line">    FETCH cur INTO emp_name, emp_salary;</span><br><span class="line">  END WHILE;</span><br><span class="line"></span><br><span class="line">  CLOSE cur;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>该存储过程接收一个参数 <code>dept_name</code>，声明了两个变量 <code>emp_name</code> 和<br><code>emp_salary</code>，用于存储从表中查询到的员工姓名和薪水信息。然后使用<br><code>CURSOR</code> 语句创建一个游标<br><code>cur</code>，用于遍历在该部门工作的所有员工的信息。接下来，在一个循环中，使用<br><code>FETCH</code> 语句从游标中取出一条员工记录，并使用 <code>SELECT</code><br>语句将员工姓名和薪水信息输出到控制台。最后，使用 <code>CLOSE</code> 语句关闭游标。</p>
<p>要调用该存储过程，可以使用 <code>CALL</code> 语句，并传递一个参数<br><code>dept_name</code>。例如，要查询部门名为 <code>Sales</code><br>的员工的姓名和薪水信息，可以使用以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> get_dept_employees(<span class="string">&#x27;Sales&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>执行该命令后，MySQL 会调用 <code>get_dept_employees</code><br>存储过程，并输出员工姓名和薪水信息。</p>
<h1 id="MySQL-存储过程语法"><a href="#MySQL-存储过程语法" class="headerlink" title="MySQL 存储过程语法"></a>MySQL 存储过程语法</h1><p>MySQL 存储过程的语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE procedure_name ([IN | OUT | INOUT] parameter_name parameter_type [, ...])</span><br><span class="line">[characteristic ...] routine_body</span><br></pre></td></tr></table></figure>

<p>其中，<code>procedure_name</code> 是存储过程的名称，<code>parameter_name</code> 和<br><code>parameter_type</code> 是存储过程的参数，可以有多个参数，参数类型可以是 MySQL<br>数据类型或者用户定义的类型。</p>
<p>参数的类型可以是 <code>IN</code>、<code>OUT</code> 或者<br><code>INOUT</code>，分别表示输入参数、输出参数和输入输出参数。输入参数用于向存储过程传递值，输出参数用于从存储过程中返回值，输入输出参数可以在存储过程内部修改参数的值，并将修改后的值返回给调用者。</p>
<p><code>characteristic</code> 是一些存储过程的特性，包括<br><code>COMMENT</code>、<code>LANGUAGE</code>、<code>DETERMINISTIC</code>、<code>SQL SECURITY</code><br>等。这些特性可以用于指定存储过程的注释、语言、确定性等信息。</p>
<p><code>routine_body</code> 是存储过程的主体，包括一系列的 SQL<br>语句、控制流语句、游标语句等，用于执行特定的操作。存储过程可以包含条件语句、循环语句、游标语句、异常处理语句等，以实现复杂的业务逻辑。</p>
<p>存储过程创建完成后，可以使用 <code>CALL</code><br>语句来调用存储过程，并传递相应的参数。例如：</p>
<pre><code>CALL procedure_name(param1, param2, ...);
</code></pre>
<p>执行该命令后，MySQL<br>会调用指定的存储过程，并按照存储过程的定义执行相应的操作。</p>
<h2 id="实例-19"><a href="#实例-19" class="headerlink" title="实例"></a>实例</h2><p><strong>准备数据</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> students (</span><br><span class="line">    id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    gender ENUM(<span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>以下是一个初始化数据的例子，演示 MySQL 存储过程的语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建存储过程</span></span><br><span class="line">DELIMITER $$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> init_data(<span class="keyword">IN</span> n <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">        <span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">    WHILE i <span class="operator">&lt;=</span> n DO</span><br><span class="line">        <span class="keyword">INSERT</span> <span class="keyword">INTO</span> students (name, gender, age) <span class="keyword">VALUES</span> (CONCAT(<span class="string">&#x27;student&#x27;</span>, i), IF(i <span class="operator">%</span> <span class="number">2</span> <span class="operator">=</span> <span class="number">0</span>, <span class="string">&#x27;male&#x27;</span>, <span class="string">&#x27;female&#x27;</span>), <span class="number">18</span> <span class="operator">+</span> i);</span><br><span class="line">        <span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">END</span> WHILE;</span><br><span class="line"><span class="keyword">END</span>$$</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 调用存储过程</span></span><br><span class="line"><span class="keyword">CALL</span> init_data(<span class="number">10</span>);</span><br></pre></td></tr></table></figure>

<p>上面的例子创建了一个名为 <code>init_data</code> 的存储过程，用于向 <code>students</code><br>表中插入指定数量的数据。存储过程接受一个输入参数<br><code>n</code>，表示要插入的数据的数量。</p>
<p>存储过程的主体包含一个 <code>DECLARE</code> 语句，用于声明一个变量<br><code>i</code>，并将其初始化为 1。接着使用 <code>WHILE</code><br>循环语句，循环插入数据，直到插入的数据量达到 <code>n</code>。</p>
<p>循环体内部使用 <code>INSERT INTO</code> 语句向 <code>students</code> 表中插入数据，其中使用<br><code>CONCAT</code> 函数生成学生的名称，使用 <code>IF</code> 函数生成学生的性别，使用 <code>+</code><br>运算符生成学生的年龄。循环体内还使用 <code>SET</code> 语句将变量 <code>i</code> 的值加<br>1，实现循环计数。</p>
<p>存储过程定义完成后，使用 <code>CALL</code> 语句来调用存储过程，并传递一个参数<br>10。调用该存储过程后，MySQL 会自动向 <code>students</code> 表中插入 10<br>条数据，每条数据包含一个不同的学生名称、性别和年龄。</p>
<h1 id="MySQL存储过程声明变量"><a href="#MySQL存储过程声明变量" class="headerlink" title="MySQL存储过程声明变量"></a>MySQL存储过程声明变量</h1><p>在 MySQL 存储过程中，可以使用 <code>DECLARE</code> 语句声明变量，语法如下：</p>
<pre><code>DECLARE variable_name datatype [DEFAULT value];
</code></pre>
<p>其中，<code>variable_name</code> 是变量名，<code>datatype</code> 是变量的数据类型，<code>DEFAULT</code><br>可选，用于指定变量的默认值。</p>
<p>下面是一个简单的例子，展示如何在存储过程中声明变量：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_var()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> x <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> y <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SET</span> x <span class="operator">=</span> <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">SET</span> y <span class="operator">=</span> x <span class="operator">+</span> <span class="number">5</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SELECT</span> x, y;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>该存储过程声明了两个整型变量 <code>x</code> 和 <code>y</code>，默认值均为 0。然后，将 <code>x</code><br>设置为 10，将 <code>y</code> 设置为 <code>x</code> 加上 5，最后将 <code>x</code> 和 <code>y</code><br>的值作为结果返回。</p>
<p>在执行该存储过程时，可以通过以下语句调用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> test_var();</span><br></pre></td></tr></table></figure>

<p>执行结果为：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">x <span class="operator">|</span> y</span><br><span class="line"><span class="comment">--+--</span></span><br><span class="line"><span class="number">10</span><span class="operator">|</span><span class="number">15</span></span><br></pre></td></tr></table></figure>

<p>说明变量 <code>x</code> 和 <code>y</code> 的值被成功赋值，并且计算结果正确。</p>
<h1 id="MySQL存储过程流程控制"><a href="#MySQL存储过程流程控制" class="headerlink" title="MySQL存储过程流程控制"></a>MySQL存储过程流程控制</h1><p>在 MySQL<br>存储过程中，可以使用流程控制语句控制程序的流程，包括条件判断、循环和异常处理等。</p>
<p>以下是一些常用的流程控制语句：</p>
<ul>
<li><code>IF</code> 语句：用于执行条件判断，根据条件执行不同的操作。</li>
<li><code>CASE</code> 语句：类似于 <code>switch</code> 语句，根据不同的条件执行不同的操作。</li>
<li><code>WHILE</code> 循环：在满足条件的情况下，重复执行某个操作，直到条件不成立。</li>
<li><code>REPEAT</code><br>循环：先执行一次操作，然后在满足条件的情况下，重复执行该操作，直到条件不成立。</li>
<li><code>LOOP</code> 循环：无条件执行某个操作，直到遇到 <code>LEAVE</code> 语句或出现异常。</li>
<li><code>LEAVE</code> 语句：用于在循环中退出，配合 <code>LOOP</code> 或 <code>REPEAT</code> 循环使用。</li>
<li><code>ITERATE</code> 语句：用于跳过循环中的某一次迭代，配合 <code>WHILE</code> 或 <code>REPEAT</code><br>循环使用。</li>
<li><code>HANDLER</code> 语句：用于处理存储过程中的异常情况。</li>
</ul>
<p>下面是一个例子，展示了如何在存储过程中使用 <code>IF</code> 语句进行条件判断：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_if(x <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">  </span><br><span class="line">  IF x <span class="operator">&gt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;positive&#x27;</span>;</span><br><span class="line">  ELSEIF x <span class="operator">&lt;</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;negative&#x27;</span>;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> <span class="string">&#x27;zero&#x27;</span>;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SELECT</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>该存储过程接受一个整型参数 <code>x</code>，根据 <code>x</code> 的正负性返回不同的结果。如果<br><code>x</code> 大于 0，则返回字符串 <code>&#39;positive&#39;</code>；如果 <code>x</code> 小于 0，则返回字符串<br><code>&#39;negative&#39;</code>；如果 <code>x</code> 等于 0，则返回字符串<br><code>&#39;zero&#39;</code>。最后，将结果返回给调用者。</p>
<p>在执行该存储过程时，可以通过以下语句调用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> test_if(<span class="number">10</span>); <span class="comment">-- 返回 &#x27;positive&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> test_if(<span class="number">-5</span>); <span class="comment">-- 返回 &#x27;negative&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> test_if(<span class="number">0</span>); <span class="comment">-- 返回 &#x27;zero&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="case实例"><a href="#case实例" class="headerlink" title="case实例"></a>case实例</h2><p>下面是一个使用 <code>CASE</code> 语句的存储过程例子，该存储过程接收一个整数参数<br><code>score</code>，并根据分数的不同，返回对应的评级。如果分数大于 90，则返回评级<br><code>&#39;A&#39;</code>，如果分数在 80-89 之间，则返回评级 <code>&#39;B&#39;</code>，以此类推。如果分数小于<br>60，则返回评级 <code>&#39;F&#39;</code>。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> calculate_grade(<span class="keyword">IN</span> score <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> grade <span class="type">CHAR</span>(<span class="number">1</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SET</span> grade <span class="operator">=</span> </span><br><span class="line">    <span class="keyword">CASE</span> </span><br><span class="line">      <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">90</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line">      <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">80</span> <span class="keyword">AND</span> score <span class="operator">&lt;</span> <span class="number">90</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line">      <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">70</span> <span class="keyword">AND</span> score <span class="operator">&lt;</span> <span class="number">80</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">      <span class="keyword">WHEN</span> score <span class="operator">&gt;=</span> <span class="number">60</span> <span class="keyword">AND</span> score <span class="operator">&lt;</span> <span class="number">70</span> <span class="keyword">THEN</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line">      <span class="keyword">ELSE</span> <span class="string">&#x27;F&#x27;</span></span><br><span class="line">    <span class="keyword">END</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Score:&#x27;</span>, score, <span class="string">&#x27; Grade:&#x27;</span>, grade) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>在执行该存储过程时，可以通过以下语句调用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> calculate_grade(<span class="number">95</span>); <span class="comment">-- 返回 &#x27;Score: 95 Grade: A&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> calculate_grade(<span class="number">85</span>); <span class="comment">-- 返回 &#x27;Score: 85 Grade: B&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> calculate_grade(<span class="number">75</span>); <span class="comment">-- 返回 &#x27;Score: 75 Grade: C&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> calculate_grade(<span class="number">65</span>); <span class="comment">-- 返回 &#x27;Score: 65 Grade: D&#x27;</span></span><br><span class="line"><span class="keyword">CALL</span> calculate_grade(<span class="number">55</span>); <span class="comment">-- 返回 &#x27;Score: 55 Grade: F&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="while实例"><a href="#while实例" class="headerlink" title="while实例"></a>while实例</h2><p>下面是一个使用 <code>WHILE</code> 循环的存储过程例子，该存储过程接收一个整数参数<br><code>n</code>，并计算从 1 到 <code>n</code> 的所有整数的和。该存储过程使用一个变量 <code>i</code> 来迭代<br>1 到 <code>n</code> 的整数，并使用另一个变量 <code>sum</code> 来存储它们的和。在每次循环中，将<br><code>i</code> 的值添加到 <code>sum</code> 中，然后将 <code>i</code> 的值增加 1。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> calculate_sum(<span class="keyword">IN</span> n <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> sum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  WHILE i <span class="operator">&lt;=</span> n DO</span><br><span class="line">    <span class="keyword">SET</span> sum <span class="operator">=</span> sum <span class="operator">+</span> i;</span><br><span class="line">    <span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">END</span> WHILE;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Sum of integers from 1 to &#x27;</span>, n, <span class="string">&#x27;: &#x27;</span>, sum) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>在执行该存储过程时，可以通过以下语句调用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> calculate_sum(<span class="number">10</span>); <span class="comment">-- 返回 &#x27;Sum of integers from 1 to 10: 55&#x27;</span></span><br></pre></td></tr></table></figure>

<p>该存储过程将计算 1 到 10 的整数的和，结果为 55。</p>
<h2 id="repeat实例"><a href="#repeat实例" class="headerlink" title="repeat实例"></a>repeat实例</h2><p>下面是一个使用 <code>REPEAT</code> 循环的存储过程例子，该存储过程接收一个整数参数<br><code>n</code>，并计算从 1 到 <code>n</code> 的所有整数的和。该存储过程使用一个变量 <code>i</code> 来迭代<br>1 到 <code>n</code> 的整数，并使用另一个变量 <code>sum</code> 来存储它们的和。在每次循环中，将<br><code>i</code> 的值添加到 <code>sum</code> 中，然后将 <code>i</code> 的值增加 1。与 <code>WHILE</code><br>循环不同，<code>REPEAT</code> 循环保证循环体至少被执行一次。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> calculate_sum(<span class="keyword">IN</span> n <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> sum <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  REPEAT</span><br><span class="line">    <span class="keyword">SET</span> sum <span class="operator">=</span> sum <span class="operator">+</span> i;</span><br><span class="line">    <span class="keyword">SET</span> i <span class="operator">=</span> i <span class="operator">+</span> <span class="number">1</span>;</span><br><span class="line">  UNTIL i <span class="operator">&gt;</span> n <span class="keyword">END</span> REPEAT;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;Sum of integers from 1 to &#x27;</span>, n, <span class="string">&#x27;: &#x27;</span>, sum) <span class="keyword">AS</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>在执行该存储过程时，可以通过以下语句调用：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CALL</span> calculate_sum(<span class="number">10</span>); <span class="comment">-- 返回 &#x27;Sum of integers from 1 to 10: 55&#x27;</span></span><br></pre></td></tr></table></figure>

<p>该存储过程将计算 1 到 10 的整数的和，结果为 55。</p>
<h1 id="MySQL存储过程异常处理"><a href="#MySQL存储过程异常处理" class="headerlink" title="MySQL存储过程异常处理"></a>MySQL存储过程异常处理</h1><p>MySQL 存储过程提供了多种异常处理方式，可以使用 <code>DECLARE</code><br>语句声明异常，并使用 <code>SIGNAL</code> 或 <code>RESIGNAL</code> 语句抛出异常，也可以使用<br><code>HANDLER</code><br>语句捕获异常并进行处理。以下是一个示例存储过程，演示了如何在存储过程中使用异常处理：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> divide_numbers(</span><br><span class="line">  <span class="keyword">IN</span> a <span class="type">INT</span>,</span><br><span class="line">  <span class="keyword">IN</span> b <span class="type">INT</span>,</span><br><span class="line">  <span class="keyword">OUT</span> <span class="keyword">result</span> <span class="keyword">DOUBLE</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> divide_by_zero <span class="keyword">CONDITION</span> <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;22012&#x27;</span>;</span><br><span class="line">  <span class="keyword">DECLARE</span> message <span class="type">VARCHAR</span>(<span class="number">255</span>);</span><br><span class="line">  </span><br><span class="line">  IF b <span class="operator">=</span> <span class="number">0</span> <span class="keyword">THEN</span></span><br><span class="line">    <span class="keyword">SET</span> message <span class="operator">=</span> <span class="string">&#x27;Cannot divide by zero&#x27;</span>;</span><br><span class="line">    SIGNAL divide_by_zero <span class="keyword">SET</span> MESSAGE_TEXT <span class="operator">=</span> message;</span><br><span class="line">  <span class="keyword">ELSE</span></span><br><span class="line">    <span class="keyword">SET</span> <span class="keyword">result</span> <span class="operator">=</span> a <span class="operator">/</span> b;</span><br><span class="line">  <span class="keyword">END</span> IF;</span><br><span class="line"><span class="keyword">END</span>;</span><br></pre></td></tr></table></figure>

<p>在上面的存储过程中，如果参数 <code>b</code> 的值为 <code>0</code>，则将抛出一个自定义的异常<br><code>divide_by_zero</code>，异常的 SQLSTATE 值为 <code>22012</code>，异常消息为<br><code>&#39;Cannot divide by zero&#39;</code>。如果没有抛出异常，将计算 <code>a / b</code><br>的值，并将结果赋给参数<br><code>result</code>。可以通过以下代码调用该存储过程，并捕获可能的异常：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="keyword">DOUBLE</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> error_code <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> error_message <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">CALL</span> divide_numbers(<span class="number">10</span>, <span class="number">2</span>, <span class="keyword">result</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">  <span class="keyword">DECLARE</span> EXIT HANDLER <span class="keyword">FOR</span> <span class="keyword">SQLSTATE</span> <span class="string">&#x27;22012&#x27;</span></span><br><span class="line">  <span class="keyword">BEGIN</span></span><br><span class="line">    <span class="keyword">GET</span> DIAGNOSTICS <span class="keyword">CONDITION</span> <span class="number">1</span></span><br><span class="line">      error_code <span class="operator">=</span> RETURNED_SQLSTATE,</span><br><span class="line">      error_message <span class="operator">=</span> MESSAGE_TEXT;</span><br><span class="line">  <span class="keyword">END</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">CALL</span> divide_numbers(<span class="number">10</span>, <span class="number">0</span>, <span class="keyword">result</span>);</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> error_code, error_message;</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，首先调用了存储过程 <code>divide_numbers</code>，计算了 <code>10 / 2</code><br>的值，并将结果赋给变量 <code>result</code>。然后，使用 <code>BEGIN</code> 和 <code>END</code><br>包装了另一个调用存储过程 <code>divide_numbers</code> 的块，该块将参数 <code>b</code><br>的值设置为 <code>0</code>，从而触发了异常。在 <code>BEGIN</code> 和 <code>END</code> 中，使用<br><code>DECLARE HANDLER</code> 语句声明了一个异常处理程序，当抛出 SQLSTATE 为 <code>22012</code><br>的异常时，将获取异常的 SQLSTATE 和消息，分别赋给变量 <code>error_code</code> 和<br><code>error_message</code>。最后，使用 <code>SELECT</code> 语句输出异常的 SQLSTATE 值和消息。</p>
<h1 id="MySQL触发器简介"><a href="#MySQL触发器简介" class="headerlink" title="MySQL触发器简介"></a>MySQL触发器简介</h1><p>MySQL触发器（Trigger）是一种在特定条件下自动执行的数据库对象，可以在数据表上定义触发器，以便在插入、更新或删除数据时自动执行相应的操作，如修改其他表中的数据或向日志表中插入日志等。MySQL触发器可以帮助开发人员简化数据操作，并确保数据的完整性和一致性。</p>
<p>MySQL触发器包括两种类型：BEFORE触发器和AFTER触发器。BEFORE触发器在数据被插入、更新或删除前被触发执行，而AFTER触发器在数据被插入、更新或删除后被触发执行。触发器可以定义在一个表的INSERT、UPDATE或DELETE事件上，也可以同时定义多个事件。</p>
<p>MySQL触发器的语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">&#123;BEFORE <span class="operator">|</span> AFTER&#125; &#123;<span class="keyword">INSERT</span> <span class="operator">|</span> <span class="keyword">UPDATE</span> <span class="operator">|</span> <span class="keyword">DELETE</span>&#125;</span><br><span class="line"><span class="keyword">ON</span> table_name <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body</span><br></pre></td></tr></table></figure>

<p>其中，trigger_name是触发器的名称，table_name是被触发的数据表名，trigger_body是触发器的执行内容。在trigger_body中，可以使用NEW和OLD关键字来引用被插入、更新或删除的数据。</p>
<p>例如，以下是一个简单的MySQL触发器，当向orders表插入新数据时，自动向order_log表中插入一条日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> log_insert_trigger</span><br><span class="line">AFTER <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> orders <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> order_log(order_id, action, <span class="type">date</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (NEW.order_id, <span class="string">&#x27;insert&#x27;</span>, NOW());</span><br></pre></td></tr></table></figure>

<p>这段代码是用于创建一个触发器（trigger）的SQL语句。触发器是一种数据库对象，它可以在指定的事件发生时自动执行特定的操作。下面是对这段代码的解释：</p>
<ul>
<li><code>CREATE TRIGGER log_insert_trigger</code>:<br>这是创建触发器的语句，触发器的名称是 <code>log_insert_trigger</code>。</li>
<li><code>AFTER INSERT</code>: 这表示触发器在插入操作之后触发。</li>
<li><code>ON orders</code>: 这表示触发器应该应用于名为 <code>orders</code> 的表。</li>
<li><code>FOR EACH ROW</code>: 这表示触发器将针对每一行的插入操作执行一次。</li>
<li><code>INSERT INTO order_log(order_id, action, date) VALUES (NEW.order_id, &#39;insert&#39;, NOW())</code>:<br>这是在触发器中执行的操作。它插入一条新的记录到名为 <code>order_log</code><br>的表中。插入的值来自于 <code>NEW</code><br>伪行，它表示插入操作中的新行。插入的字段包括 <code>order_id</code>、<code>action</code> 和<br><code>date</code>，其中 <code>order_id</code> 的值来自于插入操作中的 <code>order_id</code><br>字段，<code>action</code> 值为 <code>&#39;insert&#39;</code>，<code>date</code> 值为当前的日期和时间（通过<br><code>NOW()</code> 函数获取）。</li>
</ul>
<p>综上所述，这段代码创建了一个名为 <code>log_insert_trigger</code> 的触发器，当在<br><code>orders</code> 表中进行插入操作时，它会在每一行插入后，将相应的数据插入到<br><code>order_log</code> 表中，记录了订单的插入操作、订单ID和插入时间。</p>
<blockquote>
<p>需要注意的是，MySQL触发器的使用应该谨慎，因为触发器会增加数据库的负担，可能会影响数据库的性能。因此，应该仅在必要时使用触发器，并且应该尽量避免使用复杂的触发器。</p>
</blockquote>
<h1 id="MySQL插入触发器"><a href="#MySQL插入触发器" class="headerlink" title="MySQL插入触发器"></a>MySQL插入触发器</h1><p>MySQL插入触发器（Insert<br>Trigger）是在MySQL数据库中，当向一个数据表插入新数据时触发执行的一种触发器。插入触发器可以让开发人员在数据插入之前或之后执行一些操作，例如插入到另一个数据表，修改插入数据的值等。</p>
<p>MySQL插入触发器的语法如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> trigger_name</span><br><span class="line">BEFORE <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> table_name</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line">trigger_body</span><br></pre></td></tr></table></figure>

<p>其中，trigger_name是触发器的名称，table_name是被触发的数据表名，trigger_body是触发器的执行内容。在trigger_body中，可以使用NEW关键字来引用被插入的数据。</p>
<p>例如，以下是一个简单的MySQL插入触发器，当向orders表插入新数据时，自动向order_log表中插入一条日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> log_insert_trigger</span><br><span class="line">BEFORE <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> orders <span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">SET</span> NEW.create_time <span class="operator">=</span> NOW();</span><br></pre></td></tr></table></figure>

<p>上面的例子中，当向orders表插入新数据时，触发器会将create_time字段的值设为当前时间。这个例子是一个BEFORE<br>INSERT触发器，它在数据插入之前执行，所以可以修改被插入的数据。</p>
<blockquote>
<p>需要注意的是，MySQL插入触发器的使用应该谨慎，因为触发器会增加数据库的负担，可能会影响数据库的性能。因此，应该仅在必要时使用触发器，并且应该尽量避免使用复杂的触发器。</p>
</blockquote>
<h2 id="实例-20"><a href="#实例-20" class="headerlink" title="实例"></a>实例</h2><p>以下是一个演示MySQL插入触发器的例子。</p>
<p>首先，我们创建一个示例数据表<code>users</code>，包含<code>id</code>、<code>name</code>和<code>age</code>字段：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  age <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>然后，我们创建一个<code>before insert</code>触发器，将<code>age</code>字段的默认值设置为<code>18</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> set_default_age</span><br><span class="line">BEFORE <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> users</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">SET</span> NEW.age <span class="operator">=</span> IFNULL(NEW.age, <span class="number">18</span>);</span><br></pre></td></tr></table></figure>

<p>上述触发器会在每次向<code>users</code>表中插入新数据之前执行，并检查是否提供了<code>age</code>字段的值，如果没有，则将其设置为默认值18。</p>
<p>接着，我们创建一个<code>after insert</code>触发器，向<code>user_log</code>表中插入新记录：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user_log (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  user_id <span class="type">INT</span>,</span><br><span class="line">  action <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="type">date</span> DATETIME</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> log_insert_trigger</span><br><span class="line">AFTER <span class="keyword">INSERT</span></span><br><span class="line"><span class="keyword">ON</span> users</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> user_log (user_id, action, <span class="type">date</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (NEW.id, <span class="string">&#x27;insert&#x27;</span>, NOW());</span><br></pre></td></tr></table></figure>

<p>上述触发器会在每次向<code>users</code>表中插入新数据之后执行，并将<code>user_id</code>、<code>action</code>和<code>date</code>插入到<code>user_log</code>表中。</p>
<p>现在，我们可以向<code>users</code>表中插入一些数据，观察触发器的执行情况：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name, age) <span class="keyword">VALUES</span> (<span class="string">&#x27;Alice&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name) <span class="keyword">VALUES</span> (<span class="string">&#x27;Bob&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users (name, age) <span class="keyword">VALUES</span> (<span class="string">&#x27;Charlie&#x27;</span>, <span class="number">25</span>);</span><br></pre></td></tr></table></figure>

<p>执行上述插入操作后，<code>users</code>表中的数据如下：</p>
<p>  id   name      age</p>
<hr>
<p>  1    Alice     20<br>  2    Bob       18<br>  3    Charlie   25</p>
<p>而<code>user_log</code>表中的数据如下：</p>
<p>  id   user_id   action   date</p>
<hr>
<p>  1    1         insert   2023-02-19 12:00:00<br>  2    2         insert   2023-02-19 12:00:01<br>  3    3         insert   2023-02-19 12:00:02</p>
<p>观察上述结果可以发现，第一条插入语句指定了<code>age</code>字段的值，所以触发器不会对其进行修改；第二条插入语句没有指定<code>age</code>字段的值，所以触发器会将其默认设置为18；第三条插入语句指定了<code>age</code>字段的值，所以触发器不会对其进行修改。同时，每次插入数据后，<code>user_log</code>表中都会插入一条日志记录。</p>
<p>这就是一个简单的MySQL插入触发器的演示。</p>
<blockquote>
<p>需要注意的是，触发器的执行顺序是由触发器类型和事件类型决定的。在本例中，<code>set_default_age</code>触发器是<code>before insert</code>类型的，所以它会在插入新数据之前执行；而<code>log_insert_trigger</code>触发器是<code>after insert</code>类型的，所以它会在插入新数据之后执行。</p>
</blockquote>
<blockquote>
<p>此外，需要注意<code>set_default_age</code>触发器使用了<code>IFNULL()</code>函数来判断<code>age</code>字段的值是否为<code>NULL</code>。如果不使用<code>IFNULL()</code>函数，则会遇到一个问题：当插入一条<code>age</code>字段值为0的记录时，触发器会将其修改为默认值18。这是因为MySQL将0视为<code>NULL</code>的一种特殊情况，所以在使用触发器时需要特别注意。</p>
</blockquote>
<h1 id="MySQL删除触发器"><a href="#MySQL删除触发器" class="headerlink" title="MySQL删除触发器"></a>MySQL删除触发器</h1><p>在MySQL中，<code>DELETE</code>触发器用于在删除表中的数据之前或之后执行一些操作。与<code>INSERT</code>和<code>UPDATE</code>触发器类似，<code>DELETE</code>触发器也可以分为<code>BEFORE</code>和<code>AFTER</code>两种类型。</p>
<p>以下是一个简单的例子，演示了如何使用<code>BEFORE DELETE</code>触发器：</p>
<p>首先，我们创建一个示例表<code>employees</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  department <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  salary <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>然后，我们创建一个<code>BEFORE DELETE</code>触发器，在删除员工记录时将其记录到<code>employee_log</code>表中：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee_log (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  employee_id <span class="type">INT</span>,</span><br><span class="line">  action <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="type">date</span> DATETIME</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> log_delete_trigger</span><br><span class="line">BEFORE <span class="keyword">DELETE</span></span><br><span class="line"><span class="keyword">ON</span> employees</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee_log (employee_id, action, <span class="type">date</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (OLD.id, <span class="string">&#x27;delete&#x27;</span>, NOW());</span><br></pre></td></tr></table></figure>

<p>上述触发器会在每次删除<code>employees</code>表中的一条记录之前执行，并将被删除记录的<code>id</code>、操作类型和日期插入到<code>employee_log</code>表中。</p>
<p>接下来，我们可以向<code>employees</code>表中插入一些数据，并删除其中一些记录，观察触发器的执行情况：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">6000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Engineering&#x27;</span>, <span class="number">7000</span>);</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>执行上述操作后，<code>employees</code>表中的数据如下：</p>
<p>  id   name      department    salary</p>
<hr>
<p>  1    Alice     Sales         5000<br>  3    Charlie   Engineering   7000</p>
<p>而<code>employee_log</code>表中的数据如下：</p>
<p>  id   employee_id   action   date</p>
<hr>
<p>  1    2             delete   2023-02-19 12:00:00</p>
<p>观察上述结果可以发现，在执行<code>DELETE</code>操作时，<code>log_delete_trigger</code>触发器先于<code>DELETE</code>语句执行，将要删除的员工记录的信息插入到<code>employee_log</code>表中，然后才执行<code>DELETE</code>语句删除记录。</p>
<p>需要注意的是，<code>DELETE</code>触发器的执行顺序是由触发器类型和事件类型决定的。在本例中，<code>log_delete_trigger</code>触发器是<code>BEFORE DELETE</code>类型的，所以它会在执行<code>DELETE</code>语句之前执行。</p>
<h1 id="MySQL更新触发器"><a href="#MySQL更新触发器" class="headerlink" title="MySQL更新触发器"></a>MySQL更新触发器</h1><p>在MySQL中，<code>UPDATE</code>触发器用于在更新表中的数据之前或之后执行一些操作。与<code>INSERT</code>和<code>DELETE</code>触发器类似，<code>UPDATE</code>触发器也可以分为<code>BEFORE</code>和<code>AFTER</code>两种类型。</p>
<p>以下是一个简单的例子，演示了如何使用<code>BEFORE UPDATE</code>触发器：</p>
<p>首先，我们创建一个示例表<code>employees</code>：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  department <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  salary <span class="type">INT</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>然后，我们创建一个<code>BEFORE UPDATE</code>触发器，在更新员工记录时将其记录到<code>employee_log</code>表中：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employee_log (</span><br><span class="line">  id <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  employee_id <span class="type">INT</span>,</span><br><span class="line">  action <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">  <span class="type">date</span> DATETIME</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TRIGGER</span> log_update_trigger</span><br><span class="line">BEFORE <span class="keyword">UPDATE</span></span><br><span class="line"><span class="keyword">ON</span> employees</span><br><span class="line"><span class="keyword">FOR</span> <span class="keyword">EACH</span> <span class="type">ROW</span></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employee_log (employee_id, action, <span class="type">date</span>)</span><br><span class="line"><span class="keyword">VALUES</span> (OLD.id, <span class="string">&#x27;update&#x27;</span>, NOW());</span><br></pre></td></tr></table></figure>

<p>上述触发器会在每次更新<code>employees</code>表中的一条记录之前执行，并将被更新记录的<code>id</code>、操作类型和日期插入到<code>employee_log</code>表中。</p>
<p>接下来，我们可以向<code>employees</code>表中插入一些数据，并更新其中一些记录，观察触发器的执行情况：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Sales&#x27;</span>, <span class="number">5000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Marketing&#x27;</span>, <span class="number">6000</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> employees (name, department, salary) <span class="keyword">VALUES</span> (<span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;Engineering&#x27;</span>, <span class="number">7000</span>);</span><br><span class="line"><span class="keyword">UPDATE</span> employees <span class="keyword">SET</span> salary<span class="operator">=</span><span class="number">8000</span> <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<p>执行上述操作后，<code>employees</code>表中的数据如下：</p>
<p>  id   name      department    salary</p>
<hr>
<p>  1    Alice     Sales         5000<br>  2    Bob       Marketing     8000<br>  3    Charlie   Engineering   7000</p>
<p>而<code>employee_log</code>表中的数据如下：</p>
<p>  id   employee_id   action   date</p>
<hr>
<p>  1    2             update   2023-02-19 12:00:00</p>
<p>观察上述结果可以发现，在执行<code>UPDATE</code>操作时，<code>log_update_trigger</code>触发器先于<code>UPDATE</code>语句执行，将要更新的员工记录的信息插入到<code>employee_log</code>表中，然后才执行<code>UPDATE</code>语句更新记录。</p>
<blockquote>
<p>需要注意的是，<code>UPDATE</code>触发器的执行顺序是由触发器类型和事件类型决定的。在本例中，<code>log_update_trigger</code>触发器是<code>BEFORE UPDATE</code>类型的，所以它会在执行<code>UPDATE</code>语句之前执行。</p>
</blockquote>
<h1 id="MySQL索引简介"><a href="#MySQL索引简介" class="headerlink" title="MySQL索引简介"></a>MySQL索引简介</h1><p>在 MySQL 中，索引是用于提高数据库查询效率的一种数据结构。索引可以帮助<br>MySQL 快速地查找匹配某个条件的记录，从而大大缩短查询的时间。</p>
<p>MySQL 中常用的索引类型包括：</p>
<ol>
<li>B-Tree 索引：默认情况下，MySQL 使用 B-Tree 索引。B-Tree<br>索引对于全值匹配和前缀匹配非常高效，但对于范围查询的效率会有所下降。</li>
<li>Hash 索引：Hash 索引适合用于等值查询，但不适合用于范围查询，因为<br>Hash 索引无法排序。</li>
<li>Full-Text 索引：Full-Text<br>索引适用于全文搜索，可以对文本字段进行全文搜索匹配。</li>
</ol>
<p>在创建索引时，需要注意以下几点：</p>
<ol>
<li>对于经常查询的列，应该尽可能地为其创建索引，以提高查询效率。</li>
<li>索引并不是越多越好，创建过多的索引会导致查询效率降低，同时也会占用更多的存储空间。</li>
<li>对于频繁进行插入、更新或删除操作的表，不宜创建过多的索引，因为这些操作会对索引的维护产生额外的开销。</li>
</ol>
<p>以下是创建索引的示例代码：</p>
<pre><code>-- 为表中的单个列创建索引
CREATE INDEX idx_name ON employee (name);

-- 为表中的多个列创建联合索引
CREATE INDEX idx_name_dept ON employee (name, department);

-- 删除索引
DROP INDEX idx_name ON employee;
</code></pre>
<blockquote>
<p>需要注意的是，在创建索引时应该根据实际情况选择适当的索引类型和索引列，以提高查询效率并减少额外开销。同时，对于大表中的索引创建和删除操作需要谨慎，避免对数据库性能造成负面影响。</p>
</blockquote>
<h2 id="索引对于查询效率的影响"><a href="#索引对于查询效率的影响" class="headerlink" title="索引对于查询效率的影响"></a>索引对于查询效率的影响</h2><p>为了演示索引对于查询效率的影响，我们可以创建一个包含大量数据的表，并对其进行查询。首先，我们需要创建一个包含<br>1,000,000 条记录的 <code>user</code> 表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    username <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    password <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 向表中插入 1,000,000 条记录</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (id, username, email, password)</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    n,</span><br><span class="line">    CONCAT(<span class="string">&#x27;user&#x27;</span>, n),</span><br><span class="line">    CONCAT(<span class="string">&#x27;user&#x27;</span>, n, <span class="string">&#x27;@example.com&#x27;</span>),</span><br><span class="line">    MD5(RAND())</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">    (<span class="keyword">SELECT</span> <span class="variable">@n</span> :<span class="operator">=</span> <span class="variable">@n</span> <span class="operator">+</span> <span class="number">1</span> <span class="keyword">AS</span> n </span><br><span class="line">     <span class="keyword">FROM</span> </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t1, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t2, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t3, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t4, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t5, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t6, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t7, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t8, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">3</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">4</span>) t9, </span><br><span class="line">        (<span class="keyword">SELECT</span> <span class="variable">@n</span> :<span class="operator">=</span> <span class="number">0</span>) t10</span><br><span class="line">    ) t11;</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以对 <code>user</code> 表的 <code>username</code> 列创建一个索引：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> INDEX idx_username <span class="keyword">ON</span> <span class="keyword">user</span> (username);</span><br></pre></td></tr></table></figure>

<p>现在，我们可以对 <code>user</code><br>表进行两次查询，分别测试有无索引对查询效率的影响：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 查询 username 为 &#x27;user50000&#x27; 的记录（有索引）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> username <span class="operator">=</span> <span class="string">&#x27;user50000&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 查询 username 为 &#x27;user50000&#x27; 的记录（无索引）</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> email <span class="operator">=</span> <span class="string">&#x27;user50000@example.com&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>在测试结果中，第一次查询使用了 <code>idx_username</code><br>索引，查询时间很短；而第二次查询没有使用索引，查询时间相对较长。这表明，索引可以显著提高查询效率，特别是对于大表中的查询操作。但同时需要注意的是，对表的更新操作会对索引的维护产生额外的开销，因此需要谨慎地为表创建索引。</p>
<h1 id="MySQL-B-Tree-索引"><a href="#MySQL-B-Tree-索引" class="headerlink" title="MySQL B-Tree 索引"></a>MySQL B-Tree 索引</h1><p>MySQL B-Tree 索引是一种常见的索引类型，用于加速对表的查询操作。B-Tree<br>是一种平衡的多路搜索树，可以快速查找到指定值所对应的记录。</p>
<p>在 MySQL 中，B-Tree<br>索引可以用于加速对表的等值查询、范围查询和排序操作。当对表进行查询操作时，MySQL<br>可以利用 B-Tree 索引快速定位到符合条件的记录，从而提高查询效率。</p>
<p>B-Tree<br>索引的基本结构是一棵平衡的多路搜索树，其中每个节点可以包含多个关键字和指向子节点的指针。树的每个节点都可以包含多个数据记录，而数据记录的存储位置则由指向下一个节点的指针来指定。B-Tree<br>索引的叶子节点包含了表中的实际数据记录。</p>
<p>B-Tree<br>索引的优点在于可以快速查找到指定值所对应的记录，并且对于范围查询和排序操作也具有很好的支持。此外，B-Tree<br>索引可以自动维护索引的有序性，因此在进行排序操作时可以直接使用索引而不需要进行额外的排序操作。</p>
<p>然而，B-Tree<br>索引也存在一些缺点。例如，在对表进行插入、更新和删除操作时，需要对索引进行更新，这可能会对系统的性能产生影响。此外，B-Tree<br>索引在进行模糊查询等操作时可能会失去部分优势，因为它只能精确匹配给定的值。</p>
<p>综上所述，B-Tree<br>索引是一种常用的索引类型，可以用于加速对表的查询操作。但同时也需要注意，为了最大程度地发挥<br>B-Tree 索引的优势，需要根据具体的业务场景和查询需求进行优化。</p>
<h2 id="实例-21"><a href="#实例-21" class="headerlink" title="实例"></a>实例</h2><p>假设我们有一个名为 <code>employees</code> 的表，该表包含了员工的基本信息，其中 <code>id</code><br>为主键，为了提高查询效率，我们希望在 <code>employees</code> 表中添加一个 B-Tree<br>索引来加速对员工姓名的查询操作。</p>
<p>以下是在 MySQL 中创建 B-Tree 索引的示例代码：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建 employees 表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 添加 B-Tree 索引</span></span><br><span class="line"><span class="keyword">CREATE</span> INDEX idx_name <span class="keyword">ON</span> employees (name);</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，我们首先创建了一个名为 <code>employees</code> 的表，并将 <code>id</code><br>设置为主键。接着，我们使用 <code>CREATE INDEX</code> 语句创建了一个名为 <code>idx_name</code><br>的 B-Tree 索引，该索引包含了 <code>employees</code><br>表中的所有姓名字段，并且用于加速对员工姓名的查询操作。</p>
<p>一旦创建了 B-Tree<br>索引，我们就可以使用它来加速对表的查询操作。例如，我们可以使用如下代码来查询名为<br>“Tom” 的员工：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Tom&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>MySQL 将会使用 B-Tree 索引来定位名为 “Tom”<br>的员工，并返回其基本信息。由于 B-Tree<br>索引可以自动维护索引的有序性，因此即使 <code>employees</code><br>表包含了大量数据，MySQL 也可以在很短的时间内完成查询操作。</p>
<blockquote>
<p>总之，B-Tree<br>索引是一种常见的索引类型，可以用于加速对表的查询操作。在实际应用中，我们需要根据具体的业务场景和查询需求进行优化，以达到最好的查询效果。</p>
</blockquote>
<h1 id="MySQL-Hash-索引"><a href="#MySQL-Hash-索引" class="headerlink" title="MySQL Hash 索引"></a>MySQL Hash 索引</h1><p>MySQL 中的 Hash 索引是一种散列索引，可以用于加速对表的查询操作。与<br>B-Tree 索引不同的是，Hash<br>索引并不维护索引数据的有序性，而是将索引数据散列到一个固定长度的哈希表中，并使用哈希算法对数据进行定位。当我们需要查询一个记录时，MySQL<br>将使用相同的哈希算法在哈希表中定位记录所在的位置，以获得相应的查询结果。</p>
<p>在 MySQL 中，我们可以使用 <code>CREATE TABLE</code> 语句的 <code>HASH</code> 子句来为表添加<br>Hash 索引，例如：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建表，并添加 Hash 索引</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">    INDEX idx_name (name) <span class="keyword">USING</span> HASH</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>在上面的代码中，我们首先创建了一个名为 <code>employees</code> 的表，并将 <code>id</code><br>设置为主键。接着，我们使用 <code>INDEX</code> 子句和 <code>USING HASH</code> 子句来为<br><code>employees</code> 表的 <code>name</code> 列添加了一个 Hash 索引。</p>
<p>需要注意的是，Hash 索引适用于等值查询操作，例如<br><code>WHERE name = &#39;Tom&#39;</code>，但不适用于范围查询操作，例如<br><code>WHERE name &gt; &#39;Tom&#39;</code>，因为 Hash 索引无法保证索引数据的有序性。此外，由于<br>Hash 索引需要在内存中维护哈希表，因此 Hash<br>索引的可用内存受到限制，如果哈希表过大，可能会导致内存溢出或性能下降等问题。</p>
<p>综上所述，Hash<br>索引是一种用于加速表查询操作的散列索引，适用于等值查询操作。在实际应用中，我们需要根据具体的业务场景和查询需求进行优化，以达到最好的查询效果。</p>
<h1 id="MySQL-Full-Text-索引"><a href="#MySQL-Full-Text-索引" class="headerlink" title="MySQL Full-Text 索引"></a>MySQL Full-Text 索引</h1><p>MySQL<br>Full-Text索引是一种全文索引技术，它支持更灵活的文本搜索。Full-Text索引可以帮助用户查找包含特定单词或短语的文本，而不仅仅是查找包含特定值的列。</p>
<p>以下是一个使用Full-Text索引的MySQL表的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> mytable (</span><br><span class="line">  id <span class="type">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  title <span class="type">VARCHAR</span>(<span class="number">255</span>),</span><br><span class="line">  body TEXT,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">  FULLTEXT index_title_body (title, body)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure>

<p>在上面的示例中，我们创建了一个名为”mytable”的表，其中包含一个名为”title”的列和一个名为”body”的TEXT类型列。我们为这两列创建了一个Full-Text索引，这意味着MySQL将可以使用该索引进行全文搜索。</p>
<p>现在，我们可以向这个表中插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable (id, title, body) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;First article&#x27;</span>, <span class="string">&#x27;This is the body of the first article.&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable (id, title, body) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Second article&#x27;</span>, <span class="string">&#x27;This is the body of the second article.&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable (id, title, body) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Third article&#x27;</span>, <span class="string">&#x27;This is the body of the third article.&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable (id, title, body) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;Fourth article&#x27;</span>, <span class="string">&#x27;This is the body of the fourth article.&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>现在，我们可以使用以下查询来查找包含特定单词的文本：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mytable <span class="keyword">WHERE</span> <span class="keyword">MATCH</span>(title, body) AGAINST(<span class="string">&#x27;article&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>此查询将使用我们创建的Full-Text索引来查找包含”article”单词的行。Full-Text索引的优点是它支持对文本进行复杂的搜索，包括支持通配符和布尔运算符等高级搜索功能，这些功能在普通的索引中不可用。但是需要注意的是，Full-Text索引在处理大量文本时可能会比较慢，因此应该根据实际情况进行权衡和优化。</p>
<h1 id="MySQL索引性能分析"><a href="#MySQL索引性能分析" class="headerlink" title="MySQL索引性能分析"></a>MySQL索引性能分析</h1><p>MySQL索引的性能分析是优化查询性能的关键部分，以下是一些用于分析MySQL索引性能的技术：</p>
<ol>
<li>Explain命令：Explain命令可以解释查询语句的执行计划，包括哪些索引被使用、查询的优化方式等。通过分析Explain输出，可以找出查询性能瓶颈并进行优化。</li>
<li>Slow Query Log：启用Slow Query<br>Log可以记录查询执行时间超过指定阈值的查询，从而帮助识别哪些查询需要进行优化。Slow<br>Query Log记录的查询还包括执行计划，可以用于进一步分析查询性能问题。</li>
<li>MySQL Performance Schema：Performance Schema是MySQL<br>5.5及以上版本中的一个特性，它提供了对MySQL数据库的性能监控和分析功能。通过Performance<br>Schema，可以监控索引使用情况、查询执行时间、锁竞争等信息，以便更好地优化查询性能。</li>
<li>使用索引分析工具：除了MySQL自带的工具，还可以使用一些第三方工具来分析索引性能。例如，pt-index-usage工具可以分析索引使用情况，pt-duplicate-key-checker工具可以分析重复索引，pt-online-schema-change工具可以在线修改表结构等。</li>
</ol>
<blockquote>
<p>需要注意的是，索引性能分析需要综合考虑多个因素，包括数据分布、查询复杂度、索引类型等。因此，对于复杂的查询和数据场景，需要进行多方面的分析和测试，才能找到最优的索引策略。</p>
</blockquote>
<h1 id="MySQL索引性能分析-Explain命令的用法"><a href="#MySQL索引性能分析-Explain命令的用法" class="headerlink" title="MySQL索引性能分析 Explain命令的用法"></a>MySQL索引性能分析 Explain命令的用法</h1><p>Explain命令是MySQL中用于解释查询执行计划的命令，它可以帮助我们分析查询的性能瓶颈和优化查询。以下是Explain命令的用法：</p>
<p>Explain语法：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">table</span> <span class="keyword">WHERE</span> <span class="keyword">condition</span>;</span><br></pre></td></tr></table></figure>

<p>通过Explain命令，我们可以获取查询语句的执行计划，包括哪些索引被使用、查询的优化方式等。执行Explain命令后，MySQL会返回一个包含以下列的结果集：</p>
<ul>
<li>id：查询序列号，用于标识每个查询的序列号。如果查询语句是复合查询（如使用UNION或子查询），则每个查询语句都会有一个唯一的序列号。</li>
<li>select_type：查询类型，表示查询的类型，如SIMPLE（简单查询）、SUBQUERY（子查询）、UNION（多个查询合并）等。</li>
<li>table：被访问的表名。</li>
<li>partitions：表分区。</li>
<li>type：访问类型，表示MySQL如何访问表，如ALL（全表扫描）、index（索引扫描）、range（范围扫描）、ref（基于索引引用的行）、const（常量）等。</li>
<li>possible_keys：可能使用的索引，表示MySQL可以使用哪些索引来处理查询。</li>
<li>key：实际使用的索引，表示MySQL实际上使用了哪些索引来处理查询。</li>
<li>key_len：索引长度。</li>
<li>ref：列或常量与索引的匹配方式。</li>
<li>rows：估计的结果集行数。</li>
<li>filtered：结果集的过滤率。</li>
<li>Extra：附加信息，包括使用的索引类型、使用的临时表等。</li>
</ul>
<p>通过分析Explain输出，我们可以找出查询性能瓶颈并进行优化，例如：</p>
<ol>
<li>索引优化：通过查看possible_keys和key列，我们可以看到查询中使用了哪些索引，如果key列的值为NULL，说明查询没有使用索引。可以通过优化查询语句或增加适当的索引来提高查询性能。</li>
<li>表优化：通过查看type列，我们可以看到MySQL如何访问表。如果type列的值为ALL，说明查询使用了全表扫描，可能导致查询性能问题。可以通过优化查询语句或增加索引来改善查询性能。</li>
<li>优化查询语句：通过查看Extra列，我们可以看到一些额外的信息，如是否使用了临时表、是否使用了文件排序等。如果Extra列的值为Using<br>filesort或Using<br>temporary，说明查询使用了文件排序或临时表，可能导致查询性能问题。可以通过优化查询语句来避免这些问题。</li>
</ol>
<blockquote>
<p>需要注意的是，Explain输出的结果只是查询执行计划的估算值，实际执行结果可能会因为多种因素而有所不同。因此，在进行优化之前，应该进行多次测试和分析，以确保优化的准确性。</p>
</blockquote>
<h2 id="实例-22"><a href="#实例-22" class="headerlink" title="实例"></a>实例</h2><p>假设我们有一张名为<code>user</code>的表，包含如下字段：<code>id</code>、<code>name</code>、<code>age</code>、<code>gender</code>、<code>salary</code>、<code>address</code>，其中<code>id</code>为主键。现在我们想要查询年龄在25岁及以下、工资在5000元及以上的男性用户信息，查询语句如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> id, name, age, gender, salary, address <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">25</span> <span class="keyword">AND</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span> <span class="keyword">AND</span> salary <span class="operator">&gt;=</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以使用Explain命令来分析这个查询语句的执行计划，具体步骤如下：</p>
<ol>
<li>创建user表并插入数据：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    age <span class="type">INT</span>,</span><br><span class="line">    gender <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">    salary <span class="type">INT</span>,</span><br><span class="line">    address <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> <span class="keyword">user</span> (id, name, age, gender, salary, address)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Tom&#x27;</span>, <span class="number">25</span>, <span class="string">&#x27;male&#x27;</span>, <span class="number">6000</span>, <span class="string">&#x27;Beijing&#x27;</span>),</span><br><span class="line">       (<span class="number">2</span>, <span class="string">&#x27;Jerry&#x27;</span>, <span class="number">23</span>, <span class="string">&#x27;male&#x27;</span>, <span class="number">5500</span>, <span class="string">&#x27;Shanghai&#x27;</span>),</span><br><span class="line">       (<span class="number">3</span>, <span class="string">&#x27;Mary&#x27;</span>, <span class="number">28</span>, <span class="string">&#x27;female&#x27;</span>, <span class="number">7000</span>, <span class="string">&#x27;Guangzhou&#x27;</span>),</span><br><span class="line">       (<span class="number">4</span>, <span class="string">&#x27;John&#x27;</span>, <span class="number">22</span>, <span class="string">&#x27;male&#x27;</span>, <span class="number">4800</span>, <span class="string">&#x27;Hangzhou&#x27;</span>),</span><br><span class="line">       (<span class="number">5</span>, <span class="string">&#x27;Lisa&#x27;</span>, <span class="number">24</span>, <span class="string">&#x27;female&#x27;</span>, <span class="number">5200</span>, <span class="string">&#x27;Chengdu&#x27;</span>);</span><br></pre></td></tr></table></figure>

<ol>
<li>使用Explain命令分析查询语句：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXPLAIN <span class="keyword">SELECT</span> id, name, age, gender, salary, address <span class="keyword">FROM</span> <span class="keyword">user</span> <span class="keyword">WHERE</span> age <span class="operator">&lt;=</span> <span class="number">25</span> <span class="keyword">AND</span> gender <span class="operator">=</span> <span class="string">&#x27;male&#x27;</span> <span class="keyword">AND</span> salary <span class="operator">&gt;=</span> <span class="number">5000</span>;</span><br></pre></td></tr></table></figure>

<p>执行结果如下：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id  select_type <span class="keyword">table</span>   partitions  type    possible_keys   key key_len <span class="keyword">ref</span> <span class="keyword">rows</span>    filtered    Extra</span><br><span class="line"><span class="number">1</span>   SIMPLE  <span class="keyword">user</span>    <span class="keyword">NULL</span>    <span class="keyword">ref</span> idx_age_gender_salary   idx_age_gender_salary   <span class="number">34</span>  const,const    <span class="number">2</span>   <span class="number">100.00</span>  <span class="keyword">Using</span> index <span class="keyword">condition</span></span><br></pre></td></tr></table></figure>

<p>从上面的结果可以看出，该查询使用了<code>idx_age_gender_salary</code>索引，并且使用了索引条件过滤。也就是说，查询首先使用<code>age</code>和<code>gender</code>字段进行索引扫描，然后再使用<code>salary</code>字段进行筛选，最后返回满足条件的数据。可以看到，Explain命令输出的结果对我们分析查询性能有很大的帮助。</p>
<h1 id="MySQL慢查询日志的配置和管理"><a href="#MySQL慢查询日志的配置和管理" class="headerlink" title="MySQL慢查询日志的配置和管理"></a>MySQL慢查询日志的配置和管理</h1><p>MySQL慢查询日志记录了执行时间超过指定阈值的SQL语句，可以用于优化查询和发现潜在的性能问题。在本次回答中，我们将介绍如何配置和管理MySQL慢查询日志。</p>
<h3 id="配置慢查询日志"><a href="#配置慢查询日志" class="headerlink" title="配置慢查询日志"></a>配置慢查询日志</h3><ol>
<li><p>打开MySQL配置文件<code>my.cnf</code>，通常在<code>/etc/mysql</code>目录下。如果不存在该文件，可以创建一个。</p>
</li>
<li><p>找到<code>[mysqld]</code>节点，在其中添加如下配置项：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">slow_query_log <span class="operator">=</span> <span class="number">1</span>    # 开启慢查询日志</span><br><span class="line">slow_query_log_file <span class="operator">=</span> <span class="operator">/</span>var<span class="operator">/</span>log<span class="operator">/</span>mysql<span class="operator">/</span>mysql<span class="operator">-</span>slow.log  # 慢查询日志文件路径</span><br><span class="line">long_query_time <span class="operator">=</span> <span class="number">2</span>   # 定义慢查询阈值，单位为秒</span><br></pre></td></tr></table></figure>

<p>上述配置的含义如下：</p>
<ul>
<li><code>slow_query_log</code>：设置是否开启慢查询日志，0表示关闭，1表示开启，默认为0。</li>
<li><code>slow_query_log_file</code>：指定慢查询日志文件路径和文件名。</li>
<li><code>long_query_time</code>：定义慢查询阈值，超过该阈值的SQL语句将被记录到慢查询日志中。默认为10秒。</li>
</ul>
</li>
<li><p>保存修改后的配置文件并重启MySQL服务。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service mysql restart</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="查看慢查询日志"><a href="#查看慢查询日志" class="headerlink" title="查看慢查询日志"></a>查看慢查询日志</h3><ol>
<li><p>登录MySQL命令行客户端。</p>
</li>
<li><p>执行以下命令，打开慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行一些查询语句，让MySQL记录慢查询日志。</p>
</li>
<li><p>执行以下命令，查看最近一次慢查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.slow_log <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time <span class="keyword">DESC</span> LIMIT <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将显示最近一次慢查询的详细信息，包括查询语句、执行时间、扫描行数等。</p>
</li>
</ol>
<h3 id="管理慢查询日志"><a href="#管理慢查询日志" class="headerlink" title="管理慢查询日志"></a>管理慢查询日志</h3><ol>
<li><p>关闭慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log <span class="operator">=</span> <span class="string">&#x27;OFF&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>清空慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log_file <span class="operator">=</span> <span class="string">&#x27;/dev/null&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>注意：将慢查询日志文件路径设置为<code>/dev/null</code>将日志输出到系统黑洞中，实际上并不会清空日志文件，需要手动删除。</p>
</li>
<li><p>修改慢查询阈值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> long_query_time <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将慢查询阈值修改为5秒。</p>
</li>
<li><p>查看慢查询日志路径：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;slow_query_log_file&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将显示慢查询日志文件路径。</p>
</li>
</ol>
<p>总之，MySQL慢查询日志对于排查性能问题和优化查询语句非常有用。配置和管理慢查询日志需要一些经验和技巧。</p>
<h1 id="MySQL-Performance-Schema"><a href="#MySQL-Performance-Schema" class="headerlink" title="MySQL Performance Schema"></a>MySQL Performance Schema</h1><p>MySQL Performance Schema是MySQL<br>5.5版本引入的一个新特性，它提供了一系列工具和接口来监控MySQL服务器的性能。Performance<br>Schema会在MySQL服务器内存中维护一些系统变量和状态信息，这些信息包括线程、锁、IO、查询等方面的数据，可以帮助我们了解MySQL服务器的性能瓶颈所在，从而进行针对性的优化。</p>
<p>下面简单介绍一下Performance Schema中与索引性能分析相关的内容：</p>
<ol>
<li><code>table_io_waits_summary_by_index_usage</code>表：该表记录了每个索引被使用的次数、等待的时间和锁定时间等信息。可以通过查询该表来了解每个索引的使用情况，从而判断哪些索引使用频率低、哪些索引需要优化。</li>
<li><code>table_lock_waits_summary_by_table</code>表：该表记录了每张表的锁定情况，包括锁定次数、等待时间、等待次数等。可以通过查询该表来了解哪些表被频繁锁定，从而判断哪些查询需要优化。</li>
<li><code>events_statements_summary_by_digest</code>表：该表记录了每个SQL语句的执行情况，包括执行次数、执行时间、等待时间等。可以通过查询该表来了解每个SQL语句的性能瓶颈所在，从而进行针对性的优化。</li>
<li><code>events_statements_summary_by_index_usage</code>表：该表记录了每个索引被使用的情况，包括使用次数、等待时间、扫描行数等。可以通过查询该表来了解每个索引的使用情况，从而判断哪些索引使用频率低、哪些索引需要优化。</li>
</ol>
<p>在使用Performance Schema进行索引性能分析时，需要先启用Performance<br>Schema并配置相关参数，例如设置<code>performance_schema=on</code>启用Performance<br>Schema、设置<code>performance_schema_max_table_instances</code>限制Performance<br>Schema最多能记录的表数等。然后可以通过查询Performance<br>Schema中的各个表来获取性能信息。需要注意的是，Performance<br>Schema会占用一定的系统资源，因此需要根据系统资源情况来配置相关参数。</p>
<h2 id="实例-23"><a href="#实例-23" class="headerlink" title="实例"></a>实例</h2><p>以下是一个使用Performance Schema进行索引性能分析的例子：</p>
<ol>
<li>确认是否启用了Performance Schema</li>
</ol>
<p>在MySQL命令行界面中输入以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%performance_schema%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>如果输出结果中<code>performance_schema</code>的值为<code>ON</code>，则表示已经启用了Performance<br>Schema。</p>
<ol>
<li>创建一个测试表并插入数据</li>
</ol>
<p>在MySQL命令行界面中输入以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> test_table (</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  name <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  age <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id),</span><br><span class="line">  INDEX name_age_idx (name, age)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;Alice&#x27;</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="number">25</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="number">30</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;David&#x27;</span>, <span class="number">35</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> test_table (id, name, age) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;Eve&#x27;</span>, <span class="number">40</span>);</span><br></pre></td></tr></table></figure>

<p>这里创建了一个名为<code>test_table</code>的表，包含3个字段：<code>id</code>、<code>name</code>、<code>age</code>。其中<code>id</code>字段为主键，<code>name</code>和<code>age</code>字段组合成一个索引。插入了5条测试数据。</p>
<ol>
<li>查询<code>table_io_waits_summary_by_index_usage</code>表</li>
</ol>
<p>在MySQL命令行界面中输入以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> performance_schema.table_io_waits_summary_by_index_usage;</span><br></pre></td></tr></table></figure>

<p>这条命令将查询<code>table_io_waits_summary_by_index_usage</code>表，该表记录了每个索引被使用的次数、等待的时间和锁定时间等信息。执行该命令后，会输出类似如下的结果：</p>
<pre><code>+-------------+--------------+-----------+----------------------+-----------+-----------+----------+-------------+-------------+
| OBJECT_TYPE | OBJECT_SCHEMA| OBJECT_NAME| INDEX_NAME           | COUNT_READ| COUNT_WRITE|SUM_TIMER_READ| SUM_TIMER_WRITE| SUM_TIMER_WAIT|
+-------------+--------------+-----------+----------------------+-----------+-----------+----------+-------------+-------------+
| TABLE       | test         | test_table| PRIMARY              | 5        | 0         | 0            | 0             | 0             |
| TABLE       | test         | test_table| name_age_idx         | 0        | 1         | 0            | 122           | 11            |
+-------------+--------------+-----------+----------------------+-----------+-----------+----------+-------------+-------------+
</code></pre>
<p>可以看到，<code>name_age_idx</code>索引被使用了1次，读取了0行数据，写入了1行数据，总等待时间为11微秒。</p>
<ol>
<li>查询<code>events_statements_summary_by_digest</code>表</li>
</ol>
<p>在MySQL命令行界面中输入以下命令：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> performance_schema.events_statements_summary_by_digest <span class="keyword">WHERE</span> DIGEST_TEXT <span class="keyword">LIKE</span> <span class="string">&#x27;%test_table%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>这条命令将查询<code>events_statements_summary_by_digest</code>表，该表记录了每个SQL语句的执行情况，包括执行次数、执行时间、等待时间等。执行该命令后，会输出类似如下的结果：</p>
<pre><code>| DIGEST                      | SCHEMA_NAME | DIGEST_TEXT                                                                  | COUNT_STAR | SUM_TIMER_WAIT | SUM_LOCK_TIME | SUM_ROWS_SENT | SUM_ROWS_EXAMINED | SUM_CREATED_TMP_DISK_TABLES | SUM_CREATED_TMP_TABLES | SUM_SELECT_FULL_JOIN | SUM_SELECT_FULL_RANGE_JOIN | SUM_SELECT_RANGE | SUM_SELECT_RANGE_CHECK | SUM_SELECT_SCAN | SUM_SORT_MERGE_PASSES | SUM_SORT_RANGE | SUM_SORT_ROWS | SUM_SORT_SCAN | SUM_NO_INDEX_USED | SUM_NO_GOOD_INDEX_USED |
+-----------------------------+-------------+------------------------------------------------------------------------------+------------+----------------+---------------+---------------+------------------+-----------------------------+------------------------+----------------------+-----------------------------+------------------+------------------------+-----------------+-----------------------+----------------+---------------+----------------+------------------+------------------------+
| b48e881a1b6148d390faea5ecf75 | test        | SELECT * FROM test_table WHERE name = &#39;Alice&#39; AND age = 20 ORDER BY id DESC |          1 |      465912100 |     361376201 |             1 |                1 |                           0 |                      0 |                    0 |                           0 |                1 |                      0 |               0 |                     0 |              0 |             0 |              0 |                1 |                      0 |
+-----------------------------+-------------+------------------------------------------------------------------------------+------------+----------------+---------------+---------------+------------------+-----------------------------+------------------------+----------------------+-----------------------------+------------------+------------------------+-----------------+-----------------------+----------------+---------------+----------------+------------------+------------------------+
</code></pre>
<p>可以看到，执行了一条SELECT语句，扫描了1行数据，等待时间为465912100微秒，锁定时间为361376201微秒，未使用索引，未使用优化的索引。</p>
<p>通过以上的查询结果，我们可以了解到当前系统中索引的使用情况和SQL语句的执行情况，以便进行性能优化。</p>
<h1 id="使用pt-index-usage工具分析索引"><a href="#使用pt-index-usage工具分析索引" class="headerlink" title="使用pt-index-usage工具分析索引"></a>使用pt-index-usage工具分析索引</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p><code>pt-index-usage</code> 工具是 Percona Toolkit 中的一个工具，可以在 Percona<br>Toolkit<br>的官方网站（<a target="_blank" rel="noopener" href="https://www.percona.com/downloads/percona-toolkit/%EF%BC%89%E4%B8%8A%E8%BF%9B%E8%A1%8C%E4%B8%8B%E8%BD%BD%E5%92%8C%E5%AE%89%E8%A3%85%E3%80%82%E4%BB%A5%E4%B8%8B%E6%98%AF%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4%EF%BC%9A">https://www.percona.com/downloads/percona-toolkit/）上进行下载和安装。以下是安装步骤：</a></p>
<ol>
<li>下载 Percona Toolkit。</li>
</ol>
<p>在 Percona Toolkit 的官方网站上，可以下载到最新版本的 Percona Toolkit<br>的二进制安装包。选择适合自己系统的二进制包进行下载。常用的包括<br>rpm、deb、tar.gz 和 zip 等格式。</p>
<ol>
<li>安装 Percona Toolkit。</li>
</ol>
<p>如果下载的是 rpm 或 deb 包，可以使用系统自带的包管理器进行安装。以<br>Debian 或 Ubuntu 系统为例，可以使用以下命令进行安装：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get update</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt-get install percona-toolkit</span></span><br></pre></td></tr></table></figure>

<p>如果下载的是 tar.gz 或 zip<br>包，则需要先解压缩，并将解压缩后的二进制文件添加到系统的环境变量中。以在<br>Linux 系统下解压缩为例：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">tar -xzf percona-toolkit-3.3.0.tar.gz</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cd</span> percona-toolkit-3.3.0</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo <span class="built_in">cp</span> bin/* /usr/local/bin/</span></span><br></pre></td></tr></table></figure>

<ol>
<li>使用 <code>pt-index-usage</code> 工具。</li>
</ol>
<p>安装完成后，可以在命令行终端中使用 <code>pt-index-usage</code><br>命令进行索引使用分析。具体用法可以参考前面的回答。</p>
<h2 id="分析索引"><a href="#分析索引" class="headerlink" title="分析索引"></a>分析索引</h2><p><code>pt-index-usage</code> 是 Percona Toolkit 中的一个工具，用于分析 MySQL<br>数据库中索引的使用情况。</p>
<p>该工具的使用方法如下：</p>
<pre><code>pt-index-usage [OPTION...] [DSN]
</code></pre>
<p>其中，<code>DSN</code> 是要分析的 MySQL 数据库连接字符串，可以指定 MySQL<br>主机名、端口号、用户名和密码等信息。</p>
<p>以下是一些常用的选项：</p>
<ul>
<li><code>--ask-pass</code>：提示输入 MySQL 数据库密码。</li>
<li><code>--user</code>：指定 MySQL 数据库用户名。</li>
<li><code>--password</code>：指定 MySQL 数据库密码。</li>
<li><code>--port</code>：指定 MySQL 数据库端口号。</li>
<li><code>--socket</code>：指定 MySQL 数据库 socket 文件路径。</li>
<li><code>--ignore-databases</code>：指定不需要分析的数据库列表，多个数据库之间用逗号分隔。</li>
<li><code>--ignore-tables</code>：指定不需要分析的表名列表，多个表名之间用逗号分隔。</li>
</ul>
<p>以下是 <code>pt-index-usage</code> 工具的一些示例用法：</p>
<ol>
<li>分析默认 MySQL 实例中的索引使用情况：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
<pre><code>pt-index-usage
</code></pre>
<ol>
<li>分析指定 MySQL 实例中的索引使用情况：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
<pre><code>pt-index-usage --user=username --password=password --port=3306 --ask-pass localhost
</code></pre>
<ol>
<li>分析指定 MySQL 实例中的索引使用情况，忽略指定的数据库和表：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- --&gt;</span><br></pre></td></tr></table></figure>
<pre><code>pt-index-usage --ignore-databases=db1,db2 --ignore-tables=db3.table1,db3.table2 localhost
</code></pre>
<p>在执行完 <code>pt-index-usage</code> 命令后，将会输出类似下面的信息：</p>
<pre><code>tsv-or-csv
# 2018-08-31T08:46:19 mysql_localhost_query_digests
# Time range: 2018-08-29T00:00:00 to 2018-08-30T23:59:59
# Query sample size: 7386 out of 14772
# Rank Query ID           Response time Calls R/Call V/M   Item
# ==== ================== ============= ===== ===== ===== ==========
#    1 0x8C73E09B64815F22 1451.2412  11 131.9319  0.00 SELECT ...
#    2 0xC79245D1AB4E274B  256.3333 1019   0.2518  0.00 SELECT ...
#    3 0x57E16F5F0D91F9AB  178.4078  77   2.3166  0.00 UPDATE ...
</code></pre>
<p>其中，包含以下列：</p>
<ul>
<li>Query ID：查询语句的哈希值。</li>
<li>Response time：查询语句的平均响应时间。</li>
<li>Calls：查询语句的调用次数。</li>
<li>R&#x2F;Call：查询语句的平均响应时间。</li>
<li>V&#x2F;M：查询语句的方差&#x2F;平均值。</li>
<li>Item：查询语句的 SQL 语句。</li>
</ul>
<h1 id="MySQL索引使用规则"><a href="#MySQL索引使用规则" class="headerlink" title="MySQL索引使用规则"></a>MySQL索引使用规则</h1><p>在 MySQL 中，使用索引可以提高查询效率，但索引的使用需要遵循一些规则：</p>
<ol>
<li>在表中使用索引列，列的选择应该具有很好的选择性，即该列的值尽可能地不同，这样可以减少扫描行数，提高查询效率。</li>
<li>对于频繁的查询条件，建议创建索引，但索引也不能过多，否则会增加数据的写入时间，并可能降低性能。</li>
<li>在对表中的某个列进行查询时，应该尽可能地使用该列的索引，避免全表扫描。</li>
<li>多个列的联合索引适用于经常使用这些列的所有前缀或完整的组合进行查询，而不是单个列。</li>
<li>在 WHERE、JOIN、GROUP BY 和 ORDER BY<br>等子句中，应该使用与最终结果集匹配的索引，以便 MySQL<br>可以使用覆盖索引。</li>
<li>在使用 LIKE 进行查询时，索引只能用于以 % 或 _<br>结尾的查询，以及在不使用通配符的情况下，用 &#x3D; 或 &lt;&gt;<br>进行匹配的查询。</li>
<li>在更新表中的数据时，如果列被索引，则需要更新索引，这将导致写入操作的成本增加。</li>
</ol>
<p>总的来说，索引的使用应该遵循”适度原则”，即尽可能使用索引，但不应过度使用，以避免索引维护的成本超过查询效率的提高。</p>
<h2 id="实例-24"><a href="#实例-24" class="headerlink" title="实例"></a>实例</h2><p>假设有一个包含以下字段的表：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `student` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `age` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `score` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  KEY `idx_name` (`name`),</span><br><span class="line">  KEY `idx_age` (`age`),</span><br><span class="line">  KEY `idx_name_age` (`name`,`age`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br></pre></td></tr></table></figure>

<p>现在考虑以下两种 SQL 查询语句：</p>
<ol>
<li>查询年龄为 20 的学生：</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM student WHERE age = 20;</span><br></pre></td></tr></table></figure>

<ol>
<li>查询名字为 Alice，年龄为 20 的学生：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> student <span class="keyword">WHERE</span> name <span class="operator">=</span> <span class="string">&#x27;Alice&#x27;</span> <span class="keyword">AND</span> age <span class="operator">=</span> <span class="number">20</span>;</span><br></pre></td></tr></table></figure>

<p>针对这两种查询，应该如何选择索引呢？</p>
<p>对于第一种查询，由于只对 age 列进行查询，因此应该使用 idx_age 索引，因为<br>idx_age 索引只包含 age 列，因此查找时只需要扫描 idx_age<br>索引的叶子节点，而不需要扫描整张表，这将大大提高查询效率。</p>
<p>对于第二种查询，既有对 name 列的查询，又有对 age 列的查询，因此可以使用<br>idx_name_age 索引，idx_name_age 索引以 name 列为前缀，因此也可以支持对<br>name 列的查询，同时又可以通过 name、age 组合作为索引，支持对 name、age<br>列的组合查询，因此使用 idx_name_age 索引可以避免全表扫描，提高查询效率。</p>
<p>需要注意的是，如果在使用 idx_name_age 索引的同时，查询语句中使用的只有<br>name 列，那么 idx_name 索引可能会更快，因为 idx_name 索引只包含 name<br>列，比 idx_name_age 索引更小，因此扫描 idx_name<br>索引的代价更小。因此，在选择索引时，需要根据实际情况来选择，不能盲目使用。</p>
<p>MySQL 的 SQL 语句优化是提高数据库性能的重要手段之一。以下是一些常用的<br>SQL 语句优化技巧：</p>
<ol>
<li>选择合适的数据类型</li>
</ol>
<p>在创建表时，应该选择合适的数据类型。通常情况下，越小的数据类型会占用更少的存储空间和更少的计算资源。例如，应该尽可能使用<br><code>INT</code> 类型来存储整数，而不是使用 <code>BIGINT</code> 或 <code>FLOAT</code> 等类型。</p>
<ol>
<li>使用索引</li>
</ol>
<p>使用索引可以加快查询的速度。应该根据具体的查询语句和表结构来选择适合的索引。一般来说，对于经常被查询的字段应该创建索引。</p>
<ol>
<li>避免使用通配符查询</li>
</ol>
<p>通配符查询（如<br><code>%value%</code>）通常会导致全表扫描，对性能影响较大。如果必须使用通配符查询，可以考虑使用全文搜索等技术来优化。</p>
<ol>
<li>限制返回的数据量</li>
</ol>
<p>返回大量数据会占用过多的网络带宽和系统资源，影响数据库的性能。应该尽可能限制返回的数据量，可以使用<br><code>LIMIT</code>、<code>OFFSET</code> 等语句来限制查询结果。</p>
<ol>
<li>避免使用子查询</li>
</ol>
<p>子查询可能会影响查询的性能。如果可以使用连接查询来替代子查询，则应该优先考虑使用连接查询。</p>
<ol>
<li>使用批量插入</li>
</ol>
<p>使用批量插入可以提高数据插入的速度。例如，可以使用<br><code>INSERT INTO ... VALUES (), (), ()</code> 语句来一次性插入多行数据。</p>
<ol>
<li>缓存查询结果</li>
</ol>
<p>如果某个查询的结果在短时间内不会发生变化，可以考虑使用缓存来避免重复查询。例如，可以使用<br>Memcached 等工具来缓存查询结果。</p>
<p>总之，SQL<br>语句优化是一个复杂的过程，需要根据具体的业务需求和数据库结构来选择合适的优化方法。在优化<br>SQL 语句时，可以使用 Explain<br>命令、慢查询日志等工具来分析查询性能，帮助优化 SQL 语句。</p>
<h1 id="MySQL锁简介"><a href="#MySQL锁简介" class="headerlink" title="MySQL锁简介"></a>MySQL锁简介</h1><p>MySQL是一种流行的关系型数据库管理系统，它支持多个并发用户同时访问同一个数据库。在并发访问中，为了保证数据的完整性和一致性，MySQL使用锁来协调访问数据库的不同用户之间的竞争。</p>
<p>MySQL中有两种类型的锁：共享锁和排它锁。共享锁允许多个用户同时读取数据，但是不允许写入数据，而排它锁则只允许一个用户同时读取或写入数据。</p>
<p>在MySQL中，锁可以在多个级别上应用，包括整个数据库、表、行以及页。在使用锁时，需要注意以下几点：</p>
<ol>
<li>锁的粒度越小，越容易避免锁冲突，但是也会增加锁的开销和并发控制的复杂性。</li>
<li>锁的等待时间越长，会增加锁冲突的可能性，同时也会影响系统的响应时间。</li>
<li>为了避免死锁，需要按照一定的顺序获取锁。例如，如果两个用户同时请求资源A和B，那么他们必须按照相同的顺序获取锁，比如先获取A再获取B或者先获取B再获取A。</li>
</ol>
<p>在MySQL中，使用锁需要慎重考虑，并根据具体情况选择适当的锁策略和粒度。同时，还需要注意锁的并发性和性能影响，以确保系统的稳定性和可扩展性。</p>
<h1 id="MySQL锁-共享锁"><a href="#MySQL锁-共享锁" class="headerlink" title="MySQL锁-共享锁"></a>MySQL锁-共享锁</h1><p>在 MySQL 中，共享锁（Shared<br>Lock）是一种保护读取操作的锁机制，它允许多个事务同时持有同一个资源的共享锁，以实现并发读取操作。共享锁的基本特点如下：</p>
<ol>
<li>多个事务可以同时持有共享锁，以访问被锁定的资源，比如一张表或者一行记录。</li>
<li>共享锁允许其他事务获取相同的共享锁，但是不允许其他事务获取排它锁。</li>
<li>共享锁不会阻塞其他事务的读取操作，但会阻塞其他事务的写入操作。</li>
</ol>
<p>在 MySQL 中，可以使用 <code>SELECT ... LOCK IN SHARE MODE</code><br>语句获取共享锁。比如，下面的示例代码获取一个共享锁，并读取 <code>orders</code><br>表中的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span> LOCK <span class="keyword">IN</span> SHARE MODE;</span><br></pre></td></tr></table></figure>

<p>这个语句会锁定满足条件的行，并在事务提交或回滚之前一直持有共享锁。其他事务可以读取该行的数据，但是不能修改它，直到共享锁被释放。</p>
<p>需要注意的是，共享锁只能保护读取操作，不能保护写入操作。如果需要修改数据，需要先释放共享锁，然后再获取排它锁。</p>
<h2 id="实例-25"><a href="#实例-25" class="headerlink" title="实例"></a>实例</h2><p>以下是一个使用共享锁的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">  order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  customer_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  amount <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>假设有一个 <code>orders</code> 表，包含订单信息，其中包含字段<br><code>order_id</code>、<code>customer_id</code> 和 <code>amount</code>。现在需要查询订单号为 1001<br>的订单信息，并获取共享锁。首先，我们需要向 <code>orders</code> 表中插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, amount) <span class="keyword">VALUES</span> (<span class="number">1001</span>, <span class="number">2001</span>, <span class="number">100</span>), (<span class="number">1002</span>, <span class="number">2002</span>, <span class="number">200</span>), (<span class="number">1003</span>, <span class="number">2003</span>, <span class="number">300</span>);</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以使用以下语句获取订单号为 1001 的订单信息，并获取共享锁：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span> LOCK <span class="keyword">IN</span> SHARE MODE;</span><br></pre></td></tr></table></figure>

<p>这个语句会锁定 <code>orders</code> 表中订单号为 1001<br>的行，并在事务提交或回滚之前一直持有共享锁。其他事务可以读取该行的数据，但是不能修改它，直到共享锁被释放。</p>
<blockquote>
<p>需要注意的是，在使用共享锁时需要注意死锁的问题。如果多个事务同时获取共享锁并且相互等待，可能会导致死锁的发生。因此，在使用共享锁时需要注意并发控制的问题，避免死锁的发生。</p>
</blockquote>
<h1 id="MySQL锁-独占锁"><a href="#MySQL锁-独占锁" class="headerlink" title="MySQL锁-独占锁"></a>MySQL锁-独占锁</h1><p>在 MySQL 中，排它锁（Exclusive<br>Lock）是一种保护写入操作的锁机制，它允许事务独占资源，以实现独占性的写入操作。排它锁的基本特点如下：</p>
<ol>
<li>排它锁只能被一个事务持有，其他事务不能同时持有排它锁。</li>
<li>排它锁不允许其他事务获取相同的共享锁或排它锁，直到当前事务释放锁。</li>
<li>排它锁会阻塞其他事务的读取和写入操作。</li>
</ol>
<p>在 MySQL 中，可以使用 <code>SELECT ... FOR UPDATE</code> 或 <code>UPDATE</code><br>语句获取排它锁。比如，下面的示例代码获取一个排它锁，并修改 <code>orders</code><br>表中的数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> orders <span class="keyword">SET</span> amount <span class="operator">=</span> <span class="number">200</span> <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>这个语句会锁定满足条件的行，并在事务提交或回滚之前一直持有排它锁。其他事务不能读取或修改该行的数据，直到排它锁被释放。</p>
<blockquote>
<p>需要注意的是，排它锁只能保护写入操作，不能保护读取操作。如果需要读取数据，可以先获取共享锁，然后再获取排它锁。另外，需要避免死锁的发生，在使用排它锁时需要注意并发控制的问题。</p>
</blockquote>
<h2 id="实例-26"><a href="#实例-26" class="headerlink" title="实例"></a>实例</h2><p>以下是一个使用排它锁的示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">  order_id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">  customer_id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  amount <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>假设有一个 <code>orders</code> 表，包含订单信息，其中包含字段<br><code>order_id</code>、<code>customer_id</code> 和 <code>amount</code>。现在需要将订单号为 1001<br>的订单金额加 100 并获取排它锁。首先，我们需要向 <code>orders</code><br>表中插入一些数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (order_id, customer_id, amount) <span class="keyword">VALUES</span> (<span class="number">1001</span>, <span class="number">2001</span>, <span class="number">100</span>), (<span class="number">1002</span>, <span class="number">2002</span>, <span class="number">200</span>), (<span class="number">1003</span>, <span class="number">2003</span>, <span class="number">300</span>);</span><br></pre></td></tr></table></figure>

<p>接下来，我们可以使用以下语句获取订单号为 1001 的订单信息，并获取排它锁：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> orders <span class="keyword">SET</span> amount <span class="operator">=</span> amount <span class="operator">+</span> <span class="number">100</span> <span class="keyword">WHERE</span> order_id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>这个语句会锁定 <code>orders</code> 表中订单号为 1001<br>的行，并在事务提交或回滚之前一直持有排它锁。其他事务不能读取或修改该行的数据，直到排它锁被释放。在事务内部，可以对该行的数据进行修改操作。</p>
<p>需要注意的是，在使用排它锁时需要注意并发控制的问题，避免死锁的发生。如果多个事务同时获取排它锁并且相互等待，可能会导致死锁的发生。因此，在使用排它锁时需要注意死锁的问题，并实现合理的并发控制。</p>
<h1 id="MySQL锁-表级锁"><a href="#MySQL锁-表级锁" class="headerlink" title="MySQL锁-表级锁"></a>MySQL锁-表级锁</h1><p>MySQL<br>表级锁是最简单的锁类型，它可以锁定整张表。当一个事务对表进行更新操作时，MySQL<br>会自动给表加上排它锁，防止其他事务修改表中的数据。其他事务也可以对该表加上共享锁，防止该表被删除。表级锁适用于大批量数据的批处理操作，但它的缺点是会导致大量的锁冲突，降低系统的并发能力。</p>
<p>在 MySQL 中，可以使用以下语句对表加锁：</p>
<ul>
<li><code>LOCK TABLES table_name [AS alias] lock_type</code>: 对指定的表加锁，其中<br><code>table_name</code> 是要加锁的表名，<code>lock_type</code> 是锁的类型，可以是<br><code>READ</code>（共享锁）或 <code>WRITE</code>（排它锁）。</li>
<li><code>UNLOCK TABLES</code>: 解除对表的锁定。</li>
</ul>
<p>需要注意的是，对表加锁会影响整个表的读写操作，会导致其他事务的读写操作受到阻塞。因此，在使用表级锁时需要注意锁的粒度和并发控制的问题，避免锁冲突和死锁的发生。</p>
<p>以下是一个使用表级锁的示例：</p>
<p>假设有一个 <code>accounts</code> 表，包含用户账户信息，其中包含字段 <code>id</code>、<code>name</code> 和<br><code>balance</code>。现在需要将 <code>accounts</code> 表加上排它锁，并更新用户编号为 1001<br>的账户余额，完成之后再解除表的锁定。可以使用以下语句：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LOCK TABLES accounts WRITE;</span><br><span class="line"><span class="keyword">UPDATE</span> accounts <span class="keyword">SET</span> balance <span class="operator">=</span> balance <span class="operator">-</span> <span class="number">100</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1001</span>;</span><br><span class="line">UNLOCK TABLES;</span><br></pre></td></tr></table></figure>

<p>这个语句会对 <code>accounts</code><br>表加上排它锁，其他事务无法对该表进行读写操作，直到解除表的锁定。在事务内部，可以对该表的数据进行修改操作。需要注意的是，在使用表级锁时需要注意并发控制的问题，避免锁冲突和死锁的发生。</p>
<h2 id="实例-27"><a href="#实例-27" class="headerlink" title="实例"></a>实例</h2><p>下面是一个演示表级锁的例子，包括建表和插入数据：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    total_amount <span class="type">decimal</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    created_at datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    updated_at datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> <span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="built_in">CURRENT_TIMESTAMP</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (name, total_amount) <span class="keyword">VALUES</span> (<span class="string">&#x27;Order 1&#x27;</span>, <span class="number">100.00</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (name, total_amount) <span class="keyword">VALUES</span> (<span class="string">&#x27;Order 2&#x27;</span>, <span class="number">200.00</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> orders (name, total_amount) <span class="keyword">VALUES</span> (<span class="string">&#x27;Order 3&#x27;</span>, <span class="number">300.00</span>);</span><br></pre></td></tr></table></figure>

<p>在这个例子中，我们创建了一个 <code>orders</code> 表，并向其中插入了三条数据。</p>
<p>接下来，我们可以使用 <code>SELECT</code> 语句来查询这个表，并加上 <code>FOR UPDATE</code><br>关键字来获取表级排它锁：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 在一个终端窗口中执行以下语句获取锁</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br><span class="line"><span class="comment">-- 此时可以在另一个终端窗口中尝试执行类似的语句，但会被阻塞等待当前锁的释放</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 在另一个终端窗口中执行以下语句，会被阻塞等待锁的释放</span></span><br><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">2</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure>

<p>这里我们在一个终端窗口中获取了 <code>id</code> 为 1<br>的订单记录的排它锁，然后在另一个终端窗口中尝试获取 <code>id</code> 为 2<br>的订单记录的排它锁，此时该语句会被阻塞等待第一个终端窗口中的锁释放。</p>
<h1 id="MySQL锁-页面级锁"><a href="#MySQL锁-页面级锁" class="headerlink" title="MySQL锁-页面级锁"></a>MySQL锁-页面级锁</h1><p>MySQL的页级锁是一种介于行级锁和表级锁之间的锁机制。页级锁是指对表中的某一页进行加锁，MySQL中每一页的大小是固定的，一般为4KB。</p>
<p>在MySQL中，使用InnoDB存储引擎时，如果开启了事务，则在执行语句时会自动加上行级锁，以保证数据的一致性。但是如果表的并发性非常高，行级锁的争用会非常激烈，导致系统性能下降，此时可以考虑使用页级锁。</p>
<p>使用页级锁的情况下，当多个事务同时访问同一个页时，MySQL会将页进行加锁，以保证多个事务的操作不会相互干扰。而其他页仍然可以被其他事务访问，这就保证了整个表的并发性能。</p>
<p>需要注意的是，页级锁虽然可以提高并发性能，但是也有一些缺点。例如，当某个事务需要更新或者插入数据时，它会占用整个页，这会导致其他事务无法访问该页，从而降低了并发性能。此外，页级锁还可能导致死锁问题，因此在使用页级锁时需要谨慎处理。</p>
<h2 id="实例-28"><a href="#实例-28" class="headerlink" title="实例"></a>实例</h2><p>为了演示页面级锁，请按照以下步骤操作：</p>
<ol>
<li>创建一个包含多个页面的表，例如包含100个页面的表：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_table (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    some_data <span class="type">VARCHAR</span>(<span class="number">100</span>)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB ROW_FORMAT<span class="operator">=</span>COMPRESSED;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_table (id, some_data)</span><br><span class="line"><span class="keyword">SELECT</span> x, CONCAT(<span class="string">&#x27;Some data for id=&#x27;</span>, x)</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">AS</span> x</span><br><span class="line">    <span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line">    <span class="keyword">SELECT</span> x <span class="operator">+</span> <span class="number">1</span> <span class="keyword">FROM</span> my_table LIMIT <span class="number">99</span></span><br><span class="line">) t;</span><br></pre></td></tr></table></figure>

<ol>
<li>在一个事务中锁定表的一部分页面，例如，锁定前10个页面：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> id <span class="operator">&gt;=</span> <span class="number">1</span> <span class="keyword">AND</span> id <span class="operator">&lt;=</span> <span class="number">100</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>在另一个事务中尝试锁定同一部分页面：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BEGIN</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_table <span class="keyword">WHERE</span> id <span class="operator">&gt;=</span> <span class="number">1</span> <span class="keyword">AND</span> id <span class="operator">&lt;=</span> <span class="number">100</span> <span class="keyword">FOR</span> <span class="keyword">UPDATE</span>;</span><br></pre></td></tr></table></figure>

<p>这将导致第二个事务被阻塞，直到第一个事务释放锁定。</p>
<ol>
<li>在第一个事务中释放锁定：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>在第二个事务中继续操作：</li>
</ol>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- do something</span></span><br><span class="line"><span class="keyword">COMMIT</span>;</span><br></pre></td></tr></table></figure>

<p>这样就演示了页面级锁。</p>
<h1 id="MySQL日志简介"><a href="#MySQL日志简介" class="headerlink" title="MySQL日志简介"></a>MySQL日志简介</h1><p>MySQL的日志主要有以下几种：</p>
<ol>
<li>错误日志（Error<br>Log）：记录MySQL服务启动、运行、停止等过程中出现的错误信息，如MySQL无法启动、停止异常等。错误日志非常重要，可以帮助管理员快速排查问题。</li>
<li>慢查询日志（Slow Query<br>Log）：记录MySQL中执行时间超过指定阈值的查询语句，可以用来定位查询慢的原因，优化查询语句。</li>
<li>查询日志（General Query<br>Log）：记录所有连接到MySQL服务器的用户发出的查询语句，包括查询内容、执行时间、执行结果等信息。查询日志非常耗费系统资源，不应该一直开启，可以在需要排查问题的时候打开。</li>
<li>二进制日志（Binary<br>Log）：记录MySQL的所有数据修改操作，包括增、删、改等操作，以二进制格式保存。二进制日志是MySQL实现数据复制和数据恢复的重要基础，它可以用来做主从复制、故障恢复、数据备份等。</li>
<li>中继日志（Relay<br>Log）：用于MySQL主从复制，记录从服务器从主服务器复制二进制日志的过程。</li>
<li>事务日志（Transaction<br>Log）：记录MySQL中的事务操作，用于实现事务的ACID特性，包括Undo<br>Log和Redo Log。</li>
</ol>
<p>管理员可以根据需要配置各种日志，并在需要排查问题时查看相应的日志文件，以帮助快速定位和解决问题。</p>
<h1 id="MySQL错误日志的配置和管理"><a href="#MySQL错误日志的配置和管理" class="headerlink" title="MySQL错误日志的配置和管理"></a>MySQL错误日志的配置和管理</h1><p>MySQL 的错误日志（Error Log）是用来记录 MySQL<br>在运行过程中发生错误的详细信息的日志文件。在排查 MySQL<br>运行过程中的错误时，错误日志是非常有用的。本回答将介绍 MySQL<br>错误日志的配置和管理。</p>
<h3 id="配置-MySQL-错误日志"><a href="#配置-MySQL-错误日志" class="headerlink" title="配置 MySQL 错误日志"></a>配置 MySQL 错误日志</h3><p>MySQL 错误日志的配置参数为 <code>log_error</code>，该参数可以通过 MySQL 配置文件<br><code>my.cnf</code> 或 <code>my.ini</code> 进行配置。可以通过以下步骤进行配置：</p>
<ol>
<li><p>打开 MySQL 的配置文件，可以通过以下命令打开：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br></pre></td></tr></table></figure>
</li>
<li><p>找到 <code>[mysqld]</code> 段，在该段下添加以下配置：</p>
<pre><code>log_error=/var/log/mysql/mysql_error.log
</code></pre>
<p>其中 <code>/var/log/mysql/mysql_error.log</code><br>为错误日志文件的路径，可以根据需要修改。</p>
</li>
<li><p>保存配置文件，并重启 MySQL 使配置生效。</p>
</li>
</ol>
<h3 id="查看-MySQL-错误日志"><a href="#查看-MySQL-错误日志" class="headerlink" title="查看 MySQL 错误日志"></a>查看 MySQL 错误日志</h3><p>MySQL 错误日志默认情况下会记录到 <code>datadir</code> 目录下的 <code>hostname.err</code><br>文件中，其中 <code>datadir</code> 是 MySQL 数据文件的存放目录，<code>hostname</code> 是运行<br>MySQL 的主机名。</p>
<p>可以通过以下命令查看 MySQL 错误日志：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo tail -f /var/log/mysql/mysql_error.log</span><br></pre></td></tr></table></figure>

<p>其中 <code>-f</code> 参数表示实时查看日志文件的内容。</p>
<h3 id="管理-MySQL-错误日志"><a href="#管理-MySQL-错误日志" class="headerlink" title="管理 MySQL 错误日志"></a>管理 MySQL 错误日志</h3><p>MySQL<br>错误日志是一个文本文件，可以使用常规的文件操作命令对其进行管理，例如：</p>
<ul>
<li>查看错误日志的内容：<code>cat /var/log/mysql/mysql_error.log</code></li>
<li>清空错误日志：<code>echo &quot;&quot; &gt; /var/log/mysql/mysql_error.log</code></li>
<li>压缩错误日志：<code>gzip /var/log/mysql/mysql_error.log</code></li>
</ul>
<p>需要注意的是，清空错误日志文件并不会停止 MySQL<br>继续往该文件中写入错误日志。如果需要停止 MySQL<br>写入错误日志，可以通过以下步骤：</p>
<ol>
<li><p>打开 MySQL 的配置文件，可以通过以下命令打开：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/my.cnf</span><br></pre></td></tr></table></figure>
</li>
<li><p>找到 <code>[mysqld]</code> 段，在该段下添加以下配置：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">log_error_verbosity=2</span><br><span class="line">silent=1</span><br></pre></td></tr></table></figure>

<p>其中 <code>log_error_verbosity</code> 参数指定错误日志的详细程度，<code>silent</code><br>参数用来关闭所有日志输出，包括错误日志、一般日志等。</p>
</li>
<li><p>保存配置文件，并重启 MySQL 使配置生效。</p>
</li>
</ol>
<h1 id="MySQL慢查询日志的配置和管理-1"><a href="#MySQL慢查询日志的配置和管理-1" class="headerlink" title="MySQL慢查询日志的配置和管理"></a>MySQL慢查询日志的配置和管理</h1><p>MySQL慢查询日志记录了执行时间超过指定阈值的SQL语句，可以用于优化查询和发现潜在的性能问题。在本次回答中，我们将介绍如何配置和管理MySQL慢查询日志。</p>
<h3 id="配置慢查询日志-1"><a href="#配置慢查询日志-1" class="headerlink" title="配置慢查询日志"></a>配置慢查询日志</h3><ol>
<li><p>打开MySQL配置文件<code>my.cnf</code>，通常在<code>/etc/mysql</code>目录下。如果不存在该文件，可以创建一个。</p>
</li>
<li><p>找到<code>[mysqld]</code>节点，在其中添加如下配置项：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">slow_query_log <span class="operator">=</span> <span class="number">1</span>    # 开启慢查询日志</span><br><span class="line">slow_query_log_file <span class="operator">=</span> <span class="operator">/</span>var<span class="operator">/</span>log<span class="operator">/</span>mysql<span class="operator">/</span>mysql<span class="operator">-</span>slow.log  # 慢查询日志文件路径</span><br><span class="line">long_query_time <span class="operator">=</span> <span class="number">2</span>   # 定义慢查询阈值，单位为秒</span><br></pre></td></tr></table></figure>

<p>上述配置的含义如下：</p>
<ul>
<li><code>slow_query_log</code>：设置是否开启慢查询日志，0表示关闭，1表示开启，默认为0。</li>
<li><code>slow_query_log_file</code>：指定慢查询日志文件路径和文件名。</li>
<li><code>long_query_time</code>：定义慢查询阈值，超过该阈值的SQL语句将被记录到慢查询日志中。默认为10秒。</li>
</ul>
</li>
<li><p>保存修改后的配置文件并重启MySQL服务。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo service mysql restart</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="查看慢查询日志-1"><a href="#查看慢查询日志-1" class="headerlink" title="查看慢查询日志"></a>查看慢查询日志</h3><ol>
<li><p>登录MySQL命令行客户端。</p>
</li>
<li><p>执行以下命令，打开慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行一些查询语句，让MySQL记录慢查询日志。</p>
</li>
<li><p>执行以下命令，查看最近一次慢查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mysql.slow_log <span class="keyword">ORDER</span> <span class="keyword">BY</span> start_time <span class="keyword">DESC</span> LIMIT <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将显示最近一次慢查询的详细信息，包括查询语句、执行时间、扫描行数等。</p>
</li>
</ol>
<h3 id="管理慢查询日志-1"><a href="#管理慢查询日志-1" class="headerlink" title="管理慢查询日志"></a>管理慢查询日志</h3><ol>
<li><p>关闭慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log <span class="operator">=</span> <span class="string">&#x27;OFF&#x27;</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>清空慢查询日志：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> slow_query_log_file <span class="operator">=</span> <span class="string">&#x27;/dev/null&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>注意：将慢查询日志文件路径设置为<code>/dev/null</code>将日志输出到系统黑洞中，实际上并不会清空日志文件，需要手动删除。</p>
</li>
<li><p>修改慢查询阈值：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SET</span> <span class="keyword">GLOBAL</span> long_query_time <span class="operator">=</span> <span class="number">5</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将慢查询阈值修改为5秒。</p>
</li>
<li><p>查看慢查询日志路径：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;slow_query_log_file&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>该命令将显示慢查询日志文件路径。</p>
</li>
</ol>
<p>总之，MySQL慢查询日志对于排查性能问题和优化查询语句非常有用。配置和管理慢查询日志需要一些经验和技巧。</p>
<h1 id="MySQL二进制日志的配置和管理"><a href="#MySQL二进制日志的配置和管理" class="headerlink" title="MySQL二进制日志的配置和管理"></a>MySQL二进制日志的配置和管理</h1><p>MySQL二进制日志是一种记录数据库所有修改操作的日志文件。它可以用于数据恢复、复制和数据审计等方面。在MySQL中，二进制日志是开启和关闭的，可以根据需要进行配置。</p>
<p>以下是配置和管理MySQL二进制日志的步骤：</p>
<ol>
<li>开启二进制日志</li>
</ol>
<p>要开启MySQL二进制日志，需要在MySQL配置文件中添加以下内容：</p>
<pre><code>log-bin=mysql-bin
</code></pre>
<p>这会将二进制日志文件写入名为mysql-bin的文件中。此外，还可以设置以下参数：</p>
<pre><code>expire_logs_days=N
</code></pre>
<p>这将设置二进制日志文件的保留时间（以天为单位）。默认值为0，表示不删除任何日志文件。</p>
<ol>
<li>查询二进制日志</li>
</ol>
<p>可以使用以下命令查询当前的二进制日志文件名：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW MASTER STATUS;</span><br></pre></td></tr></table></figure>

<p>这将返回一个结果集，包含当前的二进制日志文件名和位置。</p>
<ol>
<li>关闭二进制日志</li>
</ol>
<p>可以使用以下命令关闭二进制日志：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET sql_log_bin=0;</span><br></pre></td></tr></table></figure>

<p>这将关闭二进制日志功能。如果需要重新开启二进制日志，可以使用以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET sql_log_bin=1;</span><br></pre></td></tr></table></figure>

<ol>
<li>清理二进制日志</li>
</ol>
<p>可以使用以下命令手动清理二进制日志文件：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PURGE BINARY LOGS TO &#x27;mysql-bin.XXXXXX&#x27;;</span><br></pre></td></tr></table></figure>

<p>其中，XXXXXX是二进制日志文件名的一部分。这将删除该文件以及其之前的所有文件。</p>
<ol>
<li>备份和恢复</li>
</ol>
<p>要备份和恢复MySQL二进制日志，可以使用以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">备份</span></span><br><span class="line">mysqlbinlog mysql-bin.00000X &gt; binlog.sql</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">恢复</span></span><br><span class="line">mysqlbinlog binlog.sql | mysql -u root -p</span><br></pre></td></tr></table></figure>

<p>这将将二进制日志文件转换为SQL语句，可以用于备份和恢复数据。</p>
<p>总之，MySQL二进制日志是一个非常有用的功能，可用于许多方面，包括数据恢复、复制和审计。熟练掌握配置和管理MySQL二进制日志的技巧，对于MySQL运维管理员来说非常重要。</p>
<h1 id="MySQL中继日志（Relay-Log）的配置和管理"><a href="#MySQL中继日志（Relay-Log）的配置和管理" class="headerlink" title="MySQL中继日志（Relay Log）的配置和管理"></a>MySQL中继日志（Relay Log）的配置和管理</h1><p>MySQL中继日志（Relay<br>Log）是一种特殊的二进制日志文件，用于存储复制从服务器接收的二进制日志事件。中继日志在主从复制过程中发挥了关键作用，它记录了从主服务器复制到从服务器的二进制日志，这样从服务器可以在本地重放二进制日志事件，以便实现主从同步。</p>
<p>中继日志的配置和管理包括以下几个方面：</p>
<ol>
<li>配置中继日志文件的存储路径和文件名：可以在从服务器的my.cnf配置文件中配置，通过设置relay_log和relay_log_index参数来指定中继日志文件的存储路径和文件名。</li>
<li>监控中继日志文件的增长和使用情况：可以使用MySQL自带的工具或者第三方工具，如pt-heartbeat，来监控中继日志文件的增长和使用情况。</li>
<li>定期清理中继日志文件：中继日志文件会不断增长，占用磁盘空间。为避免磁盘空间耗尽，需要定期清理中继日志文件。可以通过设置max_relay_log_size参数来限制中继日志文件的大小，或者通过使用PURGE<br>BINARY LOGS命令手动清理中继日志文件。</li>
<li>处理中继日志文件异常情况：如果中继日志文件出现损坏或者丢失，从服务器将无法重放二进制日志事件，导致主从复制中断。此时需要及时处理中继日志文件异常情况，可以通过清空中继日志文件或者重新启动从服务器来解决问题。同时，需要排查原因，避免类似问题再次发生。</li>
</ol>
<p>综上所述，中继日志的配置和管理是MySQL主从复制过程中非常重要的一部分，需要管理员仔细设置和监控，以确保主从同步的可靠性和稳定性。</p>
<h1 id="MySQL事务日志的配置和管理"><a href="#MySQL事务日志的配置和管理" class="headerlink" title="MySQL事务日志的配置和管理"></a>MySQL事务日志的配置和管理</h1><p>MySQL的事务日志（Transaction Log），也称为redo<br>log，记录了MySQL在执行事务期间所做的修改，用于在MySQL崩溃后重放事务修改。事务日志是MySQL的关键组件之一，对于数据库的性能和可靠性都有着重要的影响。</p>
<p>下面是MySQL事务日志的配置和管理：</p>
<ol>
<li>配置事务日志文件的数量和大小</li>
</ol>
<p>MySQL事务日志被存储在多个文件中，可以通过以下配置参数指定事务日志文件的数量和大小：</p>
<ul>
<li><code>innodb_log_files_in_group</code>:<br>指定事务日志文件组中文件的数量，默认值为2，最小值为2。</li>
<li><code>innodb_log_file_size</code>:<br>指定每个事务日志文件的大小，默认值为48MB，最小值为1MB，最大值为4GB。</li>
</ul>
<p>当需要修改这些参数时，需要在MySQL配置文件中修改后重启MySQL服务才能生效。</p>
<ol>
<li>查看事务日志文件的状态</li>
</ol>
<p>可以使用以下命令查看当前事务日志文件的状态：</p>
<pre><code>SHOW VARIABLES LIKE &#39;innodb_log%&#39;;
</code></pre>
<p>该命令将输出事务日志文件的当前状态，包括文件数量、文件大小、已用空间和剩余空间等信息。</p>
<ol>
<li>删除过期的事务日志文件</li>
</ol>
<p>为避免事务日志文件占用过多磁盘空间，可以定期删除过期的事务日志文件。过期的事务日志文件是指已经被MySQL使用并且不再需要的文件。可以使用以下命令手动删除过期的事务日志文件：</p>
<pre><code>PURGE BINARY LOGS BEFORE &#39;yyyy-mm-dd hh:mm:ss&#39;;
</code></pre>
<p>该命令将删除指定日期之前的所有事务日志文件。当然，也可以使用计划任务等工具定期自动删除过期的事务日志文件。</p>
<ol>
<li>使用GTID实现事务日志复制</li>
</ol>
<p>GTID（Global Transaction Identifier）是MySQL<br>5.6及以上版本中引入的一种用于跟踪复制事务的机制。在使用GTID时，MySQL会为每个事务分配一个唯一的全局事务ID，从而使得复制过程更加可靠和简单。在启用GTID后，可以使用以下命令查看GTID的状态：</p>
<pre><code>SHOW MASTER STATUS;
SHOW SLAVE STATUS;
</code></pre>
<p>以上命令将输出主服务器和从服务器的GTID状态信息。需要注意的是，在使用GTID时，无法手动删除过期的事务日志文件，因为从服务器需要保留所有的事务日志文件以便复制所有的事务。</p>
<h1 id="MySQL集群"><a href="#MySQL集群" class="headerlink" title="MySQL集群"></a>MySQL集群</h1><p>MySQL<br>集群主要是为了提高系统的可用性和性能，以及容错性，可以通过多种技术实现，比如主从复制、MHA、Galera<br>Cluster、MySQL Cluster 等。</p>
<p>下面简要介绍一下使用 MySQL 主从复制实现集群的基本步骤：</p>
<ol>
<li>配置主服务器：在 my.cnf<br>配置文件中，开启二进制日志（binlog），并配置唯一的服务器 ID。</li>
<li>配置从服务器：在 my.cnf 配置文件中，配置服务器<br>ID，设置复制用的账户和密码，指定主服务器的 IP<br>地址和端口号，以及设置中继日志（relay log）的存放路径。</li>
<li>启动主服务器：启动主服务器并开启二进制日志。</li>
<li>启动从服务器：启动从服务器并配置复制。</li>
<li>验证主从同步：在主服务器上插入一条数据，然后在从服务器上查询是否能够查询到这条数据。</li>
<li>处理主从同步错误：如果出现同步错误，需要检查错误信息，然后对症下药解决问题。</li>
<li>监控和管理：定期检查主从同步状态，处理同步错误，管理备份和恢复，以及优化集群性能。</li>
</ol>
<p>需要注意的是，MySQL<br>主从复制有一些限制，比如主服务器和从服务器的数据不能完全实时同步，而且当主服务器发生故障时，需要手动切换到从服务器。因此，为了进一步提高可用性和性能，可以考虑使用其他的技术实现<br>MySQL 集群。</p>
<h1 id="MySQL集群实现主从复制"><a href="#MySQL集群实现主从复制" class="headerlink" title="MySQL集群实现主从复制"></a>MySQL集群实现主从复制</h1><p>在 CentOS 操作系统上安装 MySQL 并实现主从复制集群的基本步骤如下：</p>
<ol>
<li>在主节点和从节点上安装 MySQL。</li>
</ol>
<p>在 CentOS 操作系统上安装 MySQL 可以使用 yum 包管理器进行安装：</p>
<pre><code>sudo yum update
sudo yum install mysql-server
</code></pre>
<ol>
<li>配置主节点和从节点的 MySQL 配置文件。</li>
</ol>
<p>主节点和从节点的 MySQL 配置文件需要配置以下几个参数：</p>
<pre><code>server-id          = 1  # 主节点设置为1，从节点需要设置为不同的值
log_bin            = /var/log/mysql/mysql-bin.log  # 启用二进制日志
binlog_do_db       = mydb  # 指定需要复制的数据库
expire_logs_days   = 10  # 保存的二进制日志文件的最长时间
max_binlog_size    = 100M  # 每个二进制日志文件的最大大小
</code></pre>
<p>在主节点上还需要配置一个名为 <code>replication</code> 的 MySQL<br>用户，用于从节点连接主节点进行复制。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;replication&#x27;</span>@<span class="string">&#x27;%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;password&#x27;</span>;</span><br><span class="line"><span class="keyword">GRANT</span> REPLICATION SLAVE <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;replication&#x27;</span>@<span class="string">&#x27;%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>在主节点上创建一个数据备份。</li>
</ol>
<p>使用 <code>mysqldump</code><br>工具创建一个数据备份文件，并将其复制到从节点上，用于从节点的初始化。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u root -p mydb &gt; /root/mydb.sql</span><br></pre></td></tr></table></figure>

<ol>
<li>在从节点上导入数据备份文件。</li>
</ol>
<p>将主节点的数据备份文件复制到从节点上，并导入数据。</p>
<pre><code>mysql -u root -p mydb &lt; /root/mydb.sql
</code></pre>
<ol>
<li>在从节点上配置从节点连接主节点的信息。</li>
</ol>
<p>从节点需要配置以下几个参数：</p>
<pre><code>server-id          = 2  # 从节点设置为不同于主节点的值
relay_log          = /var/log/mysql/mysql-relay-bin.log  # 启用中继日志
read_only          = 1  # 设置只读模式
log_slave_updates  = 1  # 启用从节点对其它从节点的日志复制
</code></pre>
<p>在从节点上使用 <code>CHANGE MASTER TO</code> 命令连接主节点进行复制。</p>
<pre><code>CHANGE MASTER TO
MASTER_HOST=&#39;192.168.1.101&#39;,
MASTER_USER=&#39;replication&#39;,
MASTER_PASSWORD=&#39;password&#39;,
MASTER_LOG_FILE=&#39;mysql-bin.000001&#39;,  # 主节点当前正在写入的二进制日志文件
MASTER_LOG_POS=107  # 主节点当前正在写入的二进制日志文件的偏移量
</code></pre>
<ol>
<li>在从节点上启动从节点复制进程。</li>
</ol>
<p>在从节点上执行 <code>START SLAVE</code> 命令启动从节点复制进程。</p>
<pre><code>START SLAVE;
</code></pre>
<ol>
<li>测试主从复制集群。</li>
</ol>
<p>在主节点上插入一些数据，然后在从节点上查询是否复制成功。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> mytable (col1, col2) <span class="keyword">VALUES</span> (<span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> mytable;</span><br></pre></td></tr></table></figure>

<p>以上是在 CentOS 操作系统上安装 MySQL 并实现主从复制。</p>

        </article>
        <div class="post-tools" id="post-tools">
            <div class="post-tools-left">
                
                <div class="share-link mobile">
    <div class="share-qrcode">
        <div class="share-button" title="使用手机访问这篇文章">
            <i class="fas fa-qrcode"></i>
        </div>
        <div class="share-main">
            <div class="share-main-all">
                <div id="qrcode" title="https://ryanchou612.github.io/posts/817da579.html">
                </div>
                <div class="reward-dec">使用手机访问这篇文章</div>
            </div>
        </div>
        <script type="text/javascript">
            new QRCode(document.getElementById("qrcode"), "https://ryanchou612.github.io/posts/817da579.html");
        </script>
    </div>
</div>
                <div class="share-link weibo"><a class="share-button" target="_blank"
    href="https://service.weibo.com/share/share.php?title=学习笔记｜MySQL&amp;url=https://ryanchou612.github.io/posts/817da579.html&amp;pic=/img/hello.jpg"
    title="分享到微博" rel="noopener external nofollow noreferrer noopener">
    <i class="fab fa-weibo" style="font-size:22px"></i>
</a>
</div>
<div class="share-link copyurl">
<div class="share-button" id="post-share-url" title="复制链接" onclick="acrylic.copyPageUrl()">
    <i class="fas fa-link"></i>
</div>
</div>
            </div>
            <div class="post-tools-right">
                <div class="tag_share">
                    <div class="post-meta__tag-list">
                        
                            <a href="/tags/MySQL/" class="post-meta__tags">
                                <span class="tags-punctuation">#</span>
                                MySQL
                                <span class="tagsPageCount">1</span>
                            </a>
                        
                    </div>
                </div>
            </div>
        </div>
        <div class="post-copyright">
    <div class="post-copyright__author">
        <a class="post-copyright__original" title="该文章为文章，注意版权协议"></a>
        <a class="post-copyright-title" href="#">
            <span>学习笔记｜MySQL</span>
        </a>
    </div>
    <div class="post-copyright__type">
        <span class="post-copyright-info" id="post-copyright-url">
            <a href="/posts/817da579.html">https://ryanchou612.github.io/posts/817da579.html</a>
        </span>
        <button class="post-copyright-copybtn" onclick="acrylic.copyPageUrl()">
            <i class="fas fa-paste copy-btn"></i>
        </button>
    </div>
    <div class="post-copyright__notice"><span class="post-copyright-info">本文是文章，采用 <a
                href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a> 协议，完整转载请注明来自 <a
                href="/">RyanChouBlog</a>
            </span>
        </div>
</div>
        <nav class="pagination-post" id="pagination">
    
        <div class="prev-post pull-left">
            <a href="/posts/b7d9b0d0.html">
                <div class="pagination-info">
                    <div class="label">上一篇</div>
                    <div class="prev_info">学习笔记｜Gin框架</div>
                </div>
            </a>
        </div>
        <div class="next-post pull-right">
            <a href="/posts/10ebb886.html">
                <div class="pagination-info">
                    <div class="label">下一篇</div>
                    <div class="next_info">学习笔记｜Linux</div>
                </div>
            </a>
        </div>
    
</nav>
            
    </div>
    <div class="aside-content" id="aside-content">
    
    
        
        <div class="card-widget card-info">
    <div class="card-content">
        <div class="card-info-avatar is-center">
            <div class="author-info__sayhi" id="author-info__sayhi">
            </div>
            <div class="author-info__name">
                RyanChou
            </div>
            <div class="author-info__description">这里记录关于<b>开发</b>、<b>技术</b>、<b>学习</b>相关的问题。<br/><br/><b>道阻且长 行则将至</b><br><br>博客正在完善...</div>
        </div>
    </div>
    <div class="banner-button-group">
        <a class="banner-button" href="/about/">
            <i class="fas fa-circle-chevron-right"></i>
            <span class="banner-button-text">个人主页</span>
        </a>
    </div>
    <div class="card-info-social-icons is-center">
        
    </div>
</div>
     
    
    <div class="sticky_layout">
        
            <div class="card-widget" id="card-toc">
    <div class="item-headline">
        <i class="fas fa-bars"></i>
        <span>文章目录</span>
    </div>
    <div class="toc-content" id="toc-content">
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%80%E4%BB%8B"><span class="toc-text">数据库简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="toc-text">数据库管理系统</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFSQL"><span class="toc-text">什么是SQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A8%A1%E5%9E%8B"><span class="toc-text">数据库模型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A6%82%E4%BD%95%E8%AE%BE%E8%AE%A1%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">如何设计一个数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-text">数据库性能优化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D"><span class="toc-text">数据库的备份和恢复</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">数据库的基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8"><span class="toc-text">数据库表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%B0%E5%BD%95%EF%BC%88%E8%A1%8C%EF%BC%89"><span class="toc-text">数据库记录（行）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%97"><span class="toc-text">数据库列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%BB%E9%94%AE"><span class="toc-text">数据库主键</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%96%E9%94%AE"><span class="toc-text">数据库外键</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E7%B4%A2%E5%BC%95"><span class="toc-text">数据库索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A7%86%E5%9B%BE"><span class="toc-text">数据库视图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="toc-text">MySQL的历史</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MariaDB"><span class="toc-text">MariaDB</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%95%B0%E6%8D%AE%E5%BA%93%E5%BC%95%E6%93%8E-mysql%E5%BC%95%E6%93%8E%E6%9C%89%E5%93%AA%E4%BA%9B"><span class="toc-text">什么是数据库引擎 mysql引擎有哪些</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E6%9E%B6%E6%9E%84"><span class="toc-text">MySQL的架构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mysql%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">mysql客户端和服务器</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#windows%E4%B8%8B%E5%AE%89%E8%A3%85MySQL"><span class="toc-text">windows下安装MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E7%9A%84%E4%B8%A4%E4%B8%AA%E7%89%88%E6%9C%AC"><span class="toc-text">MySQL的两个版本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#windows%E4%B8%8B%E9%9D%A2%E5%AE%89%E8%A3%85MySQL"><span class="toc-text">windows下面安装MySQL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%9B%AE%E5%BD%95%E5%88%86%E6%9E%90"><span class="toc-text">安装目录分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Linux%E4%B8%8B%E5%AE%89%E8%A3%85MySQL"><span class="toc-text">Linux下安装MySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9C%A8MacOS%E4%B8%8B%E9%9D%A2%E5%AE%89%E8%A3%85MySQL"><span class="toc-text">在MacOS下面安装MySQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%88%86%E6%9E%90"><span class="toc-text">MySQL配置文件分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MySQL%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">MySQL配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Centos%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-text">Centos文件路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#windows%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-text">windows文件路径</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E9%80%89%E9%A1%B9%E5%88%86%E6%9E%90"><span class="toc-text">重要选项分析</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-text">MySQL数据库的基本操作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="toc-text">MySQL创建表</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-text">MySQL插入数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-1"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-1"><span class="toc-text">实例</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%8D%95%E6%9D%A1"><span class="toc-text">插入单条</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E5%A4%9A%E6%9D%A1%E8%AE%B0%E5%BD%95"><span class="toc-text">插入多条记录</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="toc-text">MySQL删除数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-2"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-2"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BF%AE%E6%94%B9%E6%95%B0%E6%8D%AE"><span class="toc-text">MySQL修改数据</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-3"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-3"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%9F%BA%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="toc-text">MySQL基本查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95-4"><span class="toc-text">语法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-4"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%8F%AF%E8%A7%86%E5%8C%96%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="toc-text">MySQL可视化客户端</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B-1"><span class="toc-text">简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DBeaver%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">DBeaver客户端的使用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SQLyog%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-text">SQLyog客户端的使用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL%E8%AF%AD%E5%8F%A5%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">SQL语句的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E7%AE%80%E4%BB%8B"><span class="toc-text">SQL简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-text">分类</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%9A%84DDL"><span class="toc-text">MySQL的DDL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">MySQL的数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-5"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-DML"><span class="toc-text">MySQL DML</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-DQL"><span class="toc-text">MySQL DQL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2where%E5%AD%90%E5%8F%A5"><span class="toc-text">MySQL条件查询where子句</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%9F%A5%E8%AF%A2like"><span class="toc-text">MySQL查询like</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-6"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0"><span class="toc-text">MySQL聚合函数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-text">MySQL分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-7"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-text">MySQL子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-8"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-text">MySQL联合查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-9"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-%E5%B7%A6%E8%BF%9E%E6%8E%A5"><span class="toc-text">MySQL连接查询-左连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">连接查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A6%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-text">左连接查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-10"><span class="toc-text">实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-Bob-x62-x6f-x62-x2e-x6a-111-104-110-115-111-110-x40-101-x78-x61-109-x70-x6c-101-46-x63-x6f-109-Johnson"><span class="toc-text">  3             Bob       bob.johnson@example.com                Johnson   </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-%E5%8F%B3%E8%BF%9E%E6%8E%A5"><span class="toc-text">MySQL连接查询-右连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-11"><span class="toc-text">实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Mike-x6d-x69-107-101-46-x6a-x6f-x68-x6e-115-x6f-x6e-64-101-x78-x61-109-x70-x6c-x65-46-x63-x6f-109-Johnson"><span class="toc-text">  4             Mike       mike.johnson@example.com                Johnson    </span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-%E5%85%A8%E8%BF%9E%E6%8E%A5"><span class="toc-text">MySQL连接查询-全连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-12"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2-%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-text">MySQL连接查询-内连接</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-13"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%87%BD%E6%95%B0"><span class="toc-text">MySQL函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B"><span class="toc-text">聚合函数实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B"><span class="toc-text">字符串函数实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B"><span class="toc-text">日期时间函数实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B"><span class="toc-text">逻辑函数实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E5%87%BD%E6%95%B0%E5%AE%9E%E4%BE%8B"><span class="toc-text">条件函数实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-DCL"><span class="toc-text">MySQL DCL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-14"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL用户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%92%E8%89%B2%E3%80%81%E7%94%A8%E6%88%B7%E3%80%81%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-text">角色、用户、权限管理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA"><span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%BA%A6%E6%9D%9F"><span class="toc-text">MySQL约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-15"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-NULL-%E5%92%8C-NOT-NULL-%E7%BA%A6%E6%9D%9F"><span class="toc-text">MySQL NULL 和 NOT NULL 约束</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-Default%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-text">MySQL Default关键字</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">MySQL数据库设计</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1"><span class="toc-text">数据库设计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E5%B7%A5%E5%85%B7"><span class="toc-text">设计工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ER%E5%9B%BE"><span class="toc-text">ER图</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-text">MySQL数据库三范式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-16"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL事务简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA-1"><span class="toc-text">实例演示</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E4%BA%A4%E4%BA%8B%E5%8A%A1"><span class="toc-text">提交事务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E6%BB%9A%E4%BA%8B%E5%8A%A1"><span class="toc-text">回滚事务</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-text">MySQL事务的特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%8B%E5%8A%A1%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-text">数据库事务的特性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA-2"><span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-text">MySQL事务的隔离级别</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E6%BC%94%E7%A4%BA-3"><span class="toc-text">实例演示</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E5%B9%B6%E5%8F%91"><span class="toc-text">MySQL事务并发</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-17"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%A7%86%E5%9B%BE"><span class="toc-text">MySQL视图</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%86%E5%9B%BE%E5%AE%9E%E4%BE%8B"><span class="toc-text">视图实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%A7%86%E5%9B%BE%E6%A3%80%E6%9F%A5%E9%80%89%E9%A1%B9%EF%BC%88%E9%99%90%E5%88%B6%E5%86%99%E5%85%A5%EF%BC%89"><span class="toc-text">MySQL视图检查选项（限制写入）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%A7%86%E5%9B%BE%E7%9A%84%E5%88%A0%E9%99%A4%E4%BF%AE%E6%94%B9%E5%92%8C%E6%9B%BF%E6%8D%A2"><span class="toc-text">MySQL视图的删除修改和替换</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-text">MySQL存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-18"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E8%AF%AD%E6%B3%95"><span class="toc-text">MySQL 存储过程语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-19"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F"><span class="toc-text">MySQL存储过程声明变量</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6"><span class="toc-text">MySQL存储过程流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#case%E5%AE%9E%E4%BE%8B"><span class="toc-text">case实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#while%E5%AE%9E%E4%BE%8B"><span class="toc-text">while实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#repeat%E5%AE%9E%E4%BE%8B"><span class="toc-text">repeat实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-text">MySQL存储过程异常处理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E8%A7%A6%E5%8F%91%E5%99%A8%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL触发器简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%8F%92%E5%85%A5%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">MySQL插入触发器</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-20"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">MySQL删除触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%9B%B4%E6%96%B0%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="toc-text">MySQL更新触发器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%B4%A2%E5%BC%95%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL索引简介</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%AF%B9%E4%BA%8E%E6%9F%A5%E8%AF%A2%E6%95%88%E7%8E%87%E7%9A%84%E5%BD%B1%E5%93%8D"><span class="toc-text">索引对于查询效率的影响</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-B-Tree-%E7%B4%A2%E5%BC%95"><span class="toc-text">MySQL B-Tree 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-21"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-Hash-%E7%B4%A2%E5%BC%95"><span class="toc-text">MySQL Hash 索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-Full-Text-%E7%B4%A2%E5%BC%95"><span class="toc-text">MySQL Full-Text 索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%B4%A2%E5%BC%95%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-text">MySQL索引性能分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%B4%A2%E5%BC%95%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90-Explain%E5%91%BD%E4%BB%A4%E7%9A%84%E7%94%A8%E6%B3%95"><span class="toc-text">MySQL索引性能分析 Explain命令的用法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-22"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL慢查询日志的配置和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text">配置慢查询日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text">查看慢查询日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-text">管理慢查询日志</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL-Performance-Schema"><span class="toc-text">MySQL Performance Schema</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-23"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8pt-index-usage%E5%B7%A5%E5%85%B7%E5%88%86%E6%9E%90%E7%B4%A2%E5%BC%95"><span class="toc-text">使用pt-index-usage工具分析索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-text">安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90%E7%B4%A2%E5%BC%95"><span class="toc-text">分析索引</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99"><span class="toc-text">MySQL索引使用规则</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-24"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%81%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL锁简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%81-%E5%85%B1%E4%BA%AB%E9%94%81"><span class="toc-text">MySQL锁-共享锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-25"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%81-%E7%8B%AC%E5%8D%A0%E9%94%81"><span class="toc-text">MySQL锁-独占锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-26"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%81-%E8%A1%A8%E7%BA%A7%E9%94%81"><span class="toc-text">MySQL锁-表级锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-27"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%81-%E9%A1%B5%E9%9D%A2%E7%BA%A7%E9%94%81"><span class="toc-text">MySQL锁-页面级锁</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B-28"><span class="toc-text">实例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%97%A5%E5%BF%97%E7%AE%80%E4%BB%8B"><span class="toc-text">MySQL日志简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL错误日志的配置和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE-MySQL-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text">配置 MySQL 错误日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B-MySQL-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text">查看 MySQL 错误日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86-MySQL-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97"><span class="toc-text">管理 MySQL 错误日志</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86-1"><span class="toc-text">MySQL慢查询日志的配置和管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-1"><span class="toc-text">配置慢查询日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E7%9C%8B%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-1"><span class="toc-text">查看慢查询日志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%A1%E7%90%86%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97-1"><span class="toc-text">管理慢查询日志</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL二进制日志的配置和管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%B8%AD%E7%BB%A7%E6%97%A5%E5%BF%97%EF%BC%88Relay-Log%EF%BC%89%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL中继日志（Relay Log）的配置和管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E4%BA%8B%E5%8A%A1%E6%97%A5%E5%BF%97%E7%9A%84%E9%85%8D%E7%BD%AE%E5%92%8C%E7%AE%A1%E7%90%86"><span class="toc-text">MySQL事务日志的配置和管理</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%9B%86%E7%BE%A4"><span class="toc-text">MySQL集群</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL%E9%9B%86%E7%BE%A4%E5%AE%9E%E7%8E%B0%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-text">MySQL集群实现主从复制</span></a></li></ol>
    </div>
</div>
            
        
            
        <div class="card-widget card-recent-post">
    <div class="item-headline">
        <i class="fas fa-list-ol"></i>
        <span>最近发布</span>
    </div>
    <div class="aside-list">
        
        
            <div class="aside-list-item">
                <a class="thumbnail" href="/posts/106f7f46.html" title="学习笔记｜Docker">
                    <img
                        alt="学习笔记｜Docker"
                        src="/img/hello.jpg">
                </a>
                <div class="content">
                    
                    <a class="title" href="/posts/106f7f46.html" title="学习笔记｜Docker">
                        学习笔记｜Docker
                    </a>
                </div>
            </div>
                
        
            <div class="aside-list-item">
                <a class="thumbnail" href="/posts/b7d9b0d0.html" title="学习笔记｜Gin框架">
                    <img
                        alt="学习笔记｜Gin框架"
                        src="/img/hello.jpg">
                </a>
                <div class="content">
                    
                    <a class="title" href="/posts/b7d9b0d0.html" title="学习笔记｜Gin框架">
                        学习笔记｜Gin框架
                    </a>
                </div>
            </div>
                
        
            <div class="aside-list-item">
                <a class="thumbnail" href="/posts/817da579.html" title="学习笔记｜MySQL">
                    <img
                        alt="学习笔记｜MySQL"
                        src="/img/hello.jpg">
                </a>
                <div class="content">
                    
                    <a class="title" href="/posts/817da579.html" title="学习笔记｜MySQL">
                        学习笔记｜MySQL
                    </a>
                </div>
            </div>
                
        
            <div class="aside-list-item">
                <a class="thumbnail" href="/posts/10ebb886.html" title="学习笔记｜Linux">
                    <img
                        alt="学习笔记｜Linux"
                        src="/img/hello.jpg">
                </a>
                <div class="content">
                    
                    <a class="title" href="/posts/10ebb886.html" title="学习笔记｜Linux">
                        学习笔记｜Linux
                    </a>
                </div>
            </div>
                
        
            <div class="aside-list-item">
                <a class="thumbnail" href="/posts/f95eb837.html" title="学习笔记｜Gorm框架">
                    <img
                        alt="学习笔记｜Gorm框架"
                        src="/img/hello.jpg">
                </a>
                <div class="content">
                    
                    <a class="title" href="/posts/f95eb837.html" title="学习笔记｜Gorm框架">
                        学习笔记｜Gorm框架
                    </a>
                </div>
            </div>
            
    </div>
</div>
     
        
    </div>
</div> 
</main>
                <footer id="footer">
                    <div id="footer_deal">
    
        <a class="deal_link" target="_blank" href="https://github.com/ryanchou612/ryanchou612.github.io" rel="external nofollow noopener" title="Github">
            <i class="fa-brands fa-github"></i>
        </a>
    
    <img class="footer_mini_logo" src="/img/avatar.webp"
        title="返回顶部" onclick="acrylic.toTop()">
    
</div>    
<div id="heo-footer">
    
    
</div>
<div id="footer-section">
    <div class="footer-section-links">
        <div class="footer-section-left">
            <div id="footer-section-tips">
                <div class="copyright">©2023 - 2023 By 
                    <a class="footer-section-link" href="/" rel="external nofollow">RyanChou</a>
                    <a class="footer-section-link" href="https://github.com/hexo-theme-Acrylic/Hexo-Theme-Acrylic-Next" rel="external nofollow" target="_blank"> Theme By Acrylic-Next</a>
                </div>
            </div>
        </div>
        <div class="footer-section-right">
            <a class="footer-section-link" href="/rss/">订阅</a>
            
            <a class="footer-section-link cc" target="_blank" href="https://creativecommons.org/licenses/by/4.0/" title="cc协议">
                <i class="fa-solid fa-closed-captioning"></i>
            </a>
        </div>
    </div>
</div>
                </footer>
            </div>
         
        <div>
    <script type="text/javascript" src="/js/utils.js"></script>
    <script type="text/javascript" src="/js/main.js"></script>
    

<script src="/lib/pjax.min.js"></script>



<script src="/lib/snackbar.min.js"></script>


    
<script src="/lib/view-image.min.js"></script>



<div id="js-pjax">
    
     
</div>


    
<script src="/js/extend/covercolor/web.js"></script>

        


    <script>
  let pjaxSelectors = [
    'title',
    '#body-wrap',
    '#site-config',
    'meta[name="description"]',
    '#js-pjax'
  ]
  
  const pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
  })

  document.addEventListener('pjax:error', (e) => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
</script>
    
</div>
        
     
        <div class="needEndHide" id="nav-music" onclick="acrylic.musicToggle()">
    <div id="nav-music-hoverTips">音乐已暂停</div>
    <meting-js id="1708664797" server="tencent" type="playlist" mutex="true"
        preload="none" data-lrctype="0" order="random" theme="var(--heo-main)"></meting-js>
</div>
    
    </body>
</html>
<script>const posts=["posts/106f7f46.html","posts/b7d9b0d0.html","posts/817da579.html","posts/10ebb886.html","posts/f95eb837.html","posts/69c3279c.html","posts/b1efffe8.html","posts/eae62c98.html","posts/3e97faf3.html"];function toRandomPost(){ window.pjax ? pjax.loadUrl('/'+posts[Math.floor(Math.random()*posts.length)]) : window.open('/'+posts[Math.floor(Math.random()*posts.length)], "_self"); };</script>